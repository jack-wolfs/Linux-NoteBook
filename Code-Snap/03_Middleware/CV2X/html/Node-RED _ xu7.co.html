<!DOCTYPE html>
<!-- saved from url=(0040)http://xu7.co:8003/#flow/3bf62ee6.30e682 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style id="ace-tomorrow">.ace-tomorrow .ace_gutter {background: #f6f6f6;color: #4D4D4C}.ace-tomorrow .ace_print-margin {width: 1px;background: #f6f6f6}.ace-tomorrow {background-color: #FFFFFF;color: #4D4D4C}.ace-tomorrow .ace_cursor {color: #AEAFAD}.ace-tomorrow .ace_marker-layer .ace_selection {background: #D6D6D6}.ace-tomorrow.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px #FFFFFF;}.ace-tomorrow .ace_marker-layer .ace_step {background: rgb(255, 255, 0)}.ace-tomorrow .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid #D1D1D1}.ace-tomorrow .ace_marker-layer .ace_active-line {background: #EFEFEF}.ace-tomorrow .ace_gutter-active-line {background-color : #dcdcdc}.ace-tomorrow .ace_marker-layer .ace_selected-word {border: 1px solid #D6D6D6}.ace-tomorrow .ace_invisible {color: #D1D1D1}.ace-tomorrow .ace_keyword,.ace-tomorrow .ace_meta,.ace-tomorrow .ace_storage,.ace-tomorrow .ace_storage.ace_type,.ace-tomorrow .ace_support.ace_type {color: #8959A8}.ace-tomorrow .ace_keyword.ace_operator {color: #3E999F}.ace-tomorrow .ace_constant.ace_character,.ace-tomorrow .ace_constant.ace_language,.ace-tomorrow .ace_constant.ace_numeric,.ace-tomorrow .ace_keyword.ace_other.ace_unit,.ace-tomorrow .ace_support.ace_constant,.ace-tomorrow .ace_variable.ace_parameter {color: #F5871F}.ace-tomorrow .ace_constant.ace_other {color: #666969}.ace-tomorrow .ace_invalid {color: #FFFFFF;background-color: #C82829}.ace-tomorrow .ace_invalid.ace_deprecated {color: #FFFFFF;background-color: #8959A8}.ace-tomorrow .ace_fold {background-color: #4271AE;border-color: #4D4D4C}.ace-tomorrow .ace_entity.ace_name.ace_function,.ace-tomorrow .ace_support.ace_function,.ace-tomorrow .ace_variable {color: #4271AE}.ace-tomorrow .ace_support.ace_class,.ace-tomorrow .ace_support.ace_type {color: #C99E00}.ace-tomorrow .ace_heading,.ace-tomorrow .ace_markup.ace_heading,.ace-tomorrow .ace_string {color: #718C00}.ace-tomorrow .ace_entity.ace_name.ace_tag,.ace-tomorrow .ace_entity.ace_other.ace_attribute-name,.ace-tomorrow .ace_meta.ace_tag,.ace-tomorrow .ace_string.ace_regexp,.ace-tomorrow .ace_variable {color: #C82829}.ace-tomorrow .ace_comment {color: #8E908C}.ace-tomorrow .ace_indent-guide {background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bdu3f/BwAlfgctduB85QAAAABJRU5ErkJggg==) right repeat-y}
/*# sourceURL=ace/css/ace-tomorrow */</style><style id="autocompletion.css">.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {    background-color: #CAD6FA;    z-index: 1;}.ace_dark.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {    background-color: #3a674e;}.ace_editor.ace_autocomplete .ace_line-hover {    border: 1px solid #abbffe;    margin-top: -1px;    background: rgba(233,233,253,0.4);    position: absolute;    z-index: 2;}.ace_dark.ace_editor.ace_autocomplete .ace_line-hover {    border: 1px solid rgba(109, 150, 13, 0.8);    background: rgba(58, 103, 78, 0.62);}.ace_completion-meta {    opacity: 0.5;    margin: 0.9em;}.ace_editor.ace_autocomplete .ace_completion-highlight{    color: #2d69c7;}.ace_dark.ace_editor.ace_autocomplete .ace_completion-highlight{    color: #93ca12;}.ace_editor.ace_autocomplete {    width: 300px;    z-index: 200000;    border: 1px lightgray solid;    position: fixed;    box-shadow: 2px 3px 5px rgba(0,0,0,.2);    line-height: 1.4;    background: #fefefe;    color: #111;}.ace_dark.ace_editor.ace_autocomplete {    border: 1px #484747 solid;    box-shadow: 2px 3px 5px rgba(0, 0, 0, 0.51);    line-height: 1.4;    background: #25282c;    color: #c1c1c1;}
/*# sourceURL=ace/css/autocompletion.css */</style><style>.ace_snippet-marker {    -moz-box-sizing: border-box;    box-sizing: border-box;    background: rgba(194, 193, 208, 0.09);    border: 1px dotted rgba(211, 208, 235, 0.62);    position: absolute;}</style><style>    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }</style><style id="ace-tm">.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}
/*# sourceURL=ace/css/ace-tm */</style><style id="ace_editor.css">.ace_br1 {border-top-left-radius    : 3px;}.ace_br2 {border-top-right-radius   : 3px;}.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}.ace_br4 {border-bottom-right-radius: 3px;}.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}.ace_br8 {border-bottom-left-radius : 3px;}.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}.ace_editor {position: relative;overflow: hidden;font: 12px/normal 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;direction: ltr;text-align: left;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;box-sizing: border-box;min-width: 100%;contain: style size layout;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: '';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;contain: style size layout;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {position: absolute;top: 0;left: 0;right: 0;padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {contain: strict;position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;contain: strict;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;white-space: pre!important;}.ace_text-input.ace_composition {background: transparent;color: inherit;z-index: 1000;opacity: 1;}.ace_composition_placeholder { color: transparent }.ace_composition_marker { border-bottom: 1px solid;position: absolute;border-radius: 0;margin-top: 1px;}[ace_nocontext=true] {transform: none!important;filter: none!important;perspective: none!important;clip-path: none!important;mask : none!important;contain: none!important;perspective: none!important;mix-blend-mode: initial!important;z-index: auto;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;word-wrap: normal;white-space: pre;height: 100%;width: 100%;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;height: 1000000px;contain: style size layout;}.ace_text-layer {font: inherit !important;position: absolute;height: 1000000px;width: 1000000px;contain: style size layout;}.ace_text-layer > .ace_line, .ace_text-layer > .ace_line_group {contain: style size layout;position: absolute;top: 0;left: 0;right: 0;}.ace_hidpi .ace_text-layer,.ace_hidpi .ace_gutter-layer,.ace_hidpi .ace_content,.ace_hidpi .ace_gutter {contain: strict;will-change: transform;}.ace_hidpi .ace_text-layer > .ace_line, .ace_hidpi .ace_text-layer > .ace_line_group {contain: strict;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;box-sizing: border-box;border-left: 2px solid;transform: translatez(0);}.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_smooth-blinking .ace_cursor {transition: opacity 0.18s;}.ace_animate-blinking .ace_cursor {animation-duration: 1000ms;animation-timing-function: step-end;animation-name: blink-ace-animate;animation-iteration-count: infinite;}.ace_animate-blinking.ace_smooth-blinking .ace_cursor {animation-duration: 1000ms;animation-timing-function: ease-in-out;animation-name: blink-ace-animate-smooth;}@keyframes blink-ace-animate {from, to { opacity: 1; }60% { opacity: 0; }}@keyframes blink-ace-animate-smooth {from, to { opacity: 1; }45% { opacity: 1; }60% { opacity: 0; }85% { opacity: 0; }}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;box-sizing: border-box;}.ace_line .ace_fold {box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_inline_button {border: 1px solid lightgray;display: inline-block;margin: -1px 8px;padding: 0 5px;pointer-events: auto;cursor: pointer;}.ace_inline_button:hover {border-color: gray;background: rgba(200,200,200,0.2);display: inline-block;pointer-events: auto;}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}
/*# sourceURL=ace/css/ace_editor.css */</style>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<title>Node-RED : xu7.co</title>
<link rel="icon" type="image/png" href="http://xu7.co:8003/favicon.ico">
<link rel="mask-icon" href="http://xu7.co:8003/red/images/node-red-icon-black.svg" color="#8f0000">
<link href="./Node-RED _ xu7.co_files/bootstrap.min.css" rel="stylesheet" media="screen">
<link href="./Node-RED _ xu7.co_files/jquery-ui-1.10.3.custom.min.css" rel="stylesheet" media="screen">
<link rel="stylesheet" href="./Node-RED _ xu7.co_files/font-awesome.min.css">
<link rel="stylesheet" href="./Node-RED _ xu7.co_files/vendor.css">
<link rel="stylesheet" href="./Node-RED _ xu7.co_files/style.min.css">

<script src="./Node-RED _ xu7.co_files/theme-tomorrow.js"></script><script src="./Node-RED _ xu7.co_files/mode-markdown.js"></script><script src="./Node-RED _ xu7.co_files/text.js"></script><script src="./Node-RED _ xu7.co_files/mode-html.js"></script><script src="./Node-RED _ xu7.co_files/html.js"></script><script src="./Node-RED _ xu7.co_files/markdown.js"></script><script src="./Node-RED _ xu7.co_files/mode-nrjavascript.js"></script><script src="./Node-RED _ xu7.co_files/nrjavascript.js"></script></head>
<body spellcheck="false">
<div id="header">
    <span class="logo"><img src="./Node-RED _ xu7.co_files/node-red.png"> <span>Node-RED</span></span>
    <ul class="header-toolbar hide" style="display: block;"><li style="display: none;"><a id="btn-notifications" class="button" href="http://xu7.co:8003/#"><i class="fa fa-warning"></i></a></li><li><span class="deploy-button-group button-group"><a id="btn-deploy" class="deploy-button disabled" href="http://xu7.co:8003/#"><span class="deploy-button-content" style="opacity: 1;"><img id="btn-deploy-icon" src="./Node-RED _ xu7.co_files/deploy-full-o.png"> <span>部署</span></span><span class="deploy-button-spinner hide" style="display: none;"><img src="./Node-RED _ xu7.co_files/spin.svg"></span></a><a id="btn-deploy-options" data-toggle="dropdown" class="deploy-button" href="http://xu7.co:8003/#"><i class="fa fa-caret-down"></i></a><ul class="dropdown-menu pull-right" id="btn-deploy-options-submenu"><li><a id="deploymenu-item-full" tabindex="-1" href="http://xu7.co:8003/#" class="active"><i class="fa fa-square pull-left"></i><i class="fa fa-check-square pull-left"></i><img src="./Node-RED _ xu7.co_files/deploy-full.png"> <span class="menu-label-container"><span class="menu-label">全面</span><span class="menu-sublabel">在工作区中部署所有内容</span></span></a></li><li><a id="deploymenu-item-flow" tabindex="-1" href="http://xu7.co:8003/#"><i class="fa fa-square pull-left"></i><i class="fa fa-check-square pull-left"></i><img src="./Node-RED _ xu7.co_files/deploy-flows.png"> <span class="menu-label-container"><span class="menu-label">已修改的流程</span><span class="menu-sublabel">只部署包含已更改节点的流</span></span></a></li><li><a id="deploymenu-item-node" tabindex="-1" href="http://xu7.co:8003/#"><i class="fa fa-square pull-left"></i><i class="fa fa-check-square pull-left"></i><img src="./Node-RED _ xu7.co_files/deploy-nodes.png"> <span class="menu-label-container"><span class="menu-label">已更改的节点</span><span class="menu-sublabel">只部署已经更改的节点</span></span></a></li><li class="divider"></li><li><a id="deploymenu-item-reload" tabindex="-1" href="http://xu7.co:8003/#"><img src="./Node-RED _ xu7.co_files/deploy-reload.png"> <span class="menu-label-container"><span class="menu-label">Restart Flows</span><span class="menu-sublabel">Restarts the current deployed flows</span></span></a></li></ul></span></li>
        <li><a id="btn-sidemenu" class="button" data-toggle="dropdown" href="http://xu7.co:8003/#"><i class="fa fa-bars"></i></a><ul class="dropdown-menu pull-right" id="btn-sidemenu-submenu"><li class="dropdown-submenu pull-left"><a id="menu-item-view-menu" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">显示</span></a><ul id="menu-item-view-menu-submenu" class="dropdown-menu"><li><a id="menu-item-palette" tabindex="-1" href="http://xu7.co:8003/#" class="active"><i class="fa fa-square pull-left"></i><i class="fa fa-check-square pull-left"></i><span class="menu-label">Show palette</span></a></li><li><a id="menu-item-sidebar" tabindex="-1" href="http://xu7.co:8003/#" class="active"><i class="fa fa-square pull-left"></i><i class="fa fa-check-square pull-left"></i><span class="menu-label">显示侧边栏</span></a></li><li><a id="menu-item-event-log" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">Event log</span></a></li><li class="divider"></li><li class="menu-group-sidebar-tabs"><a id="menu-item-view-menu-debug" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">名称</span></a></li></ul></li><li class="divider"></li><li class="dropdown-submenu pull-left"><a id="menu-item-import" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">导入</span></a><ul id="menu-item-import-submenu" class="dropdown-menu"><li><a id="menu-item-import-clipboard" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">剪贴板</span></a></li><li class="dropdown-submenu pull-left"><a id="menu-item-import-library" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">库</span></a><ul id="menu-item-import-library-submenu" class="dropdown-menu"></ul></li></ul></li><li class="dropdown-submenu pull-left"><a id="menu-item-export" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">导出</span></a><ul id="menu-item-export-submenu" class="dropdown-menu"><li><a id="menu-item-export-clipboard" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">剪贴板</span></a></li><li class=""><a id="menu-item-export-library" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">库</span></a></li></ul></li><li class="divider"></li><li><a id="menu-item-search" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">查找流程</span></a></li><li class="divider"></li><li><a id="menu-item-config-nodes" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">修改节点配置</span></a></li><li class="dropdown-submenu pull-left"><a id="menu-item-workspace" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">流程</span></a><ul id="menu-item-workspace-submenu" class="dropdown-menu"><li><a id="menu-item-workspace-add" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">增加</span></a></li><li><a id="menu-item-workspace-edit" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">重命名</span></a></li><li class=""><a id="menu-item-workspace-delete" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">删除</span></a></li></ul></li><li class="dropdown-submenu pull-left"><a id="menu-item-subflow" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">子流程</span></a><ul id="menu-item-subflow-submenu" class="dropdown-menu"><li><a id="menu-item-subflow-create" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">新建子流程</span></a></li><li class=""><a id="menu-item-subflow-convert" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">将选择部分更改为子流程</span></a></li></ul></li><li class="divider"></li><li><a id="menu-item-edit-palette" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">节点管理</span></a></li><li class="divider"></li><li><a id="menu-item-user-settings" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">设置</span></a></li><li class="divider"></li><li><a id="menu-item-keyboard-shortcuts" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">键盘快捷方式</span></a></li><li><a id="menu-item-help" tabindex="-1" href="http://nodered.org/docs" target="_blank"><span class="menu-label">Node-RED website</span></a></li><li><a id="menu-item-node-red-version" tabindex="-1" href="http://xu7.co:8003/#"><span class="menu-label">v0.20.7</span></a></li></ul></li>
    </ul>
    <div id="header-shade" class="hide" style="display: block;"></div>
</div>
<div id="main-container" class="hide" style="display: block;">
    <div id="workspace">
        <div class="red-ui-tabs red-ui-tabs-add red-ui-tabs-search red-ui-tabs-scrollable" style="display: block;"><div class="red-ui-tabs-scroll-container"><ul id="workspace-tabs" style="width: 821px;" class=""><li class="red-ui-tab ui-draggable" id="red-ui-tab-8beb964b-c21ac8" style="width: 398.5px;"><a href="http://xu7.co:8003/#8beb964b.c21ac8" class="red-ui-tab-label" title="流程1"><span class="workspace-disabled-icon"><i class="fa fa-ban"></i> </span><span class="bidiAware" dir="">流程1</span></a><span class="red-ui-tabs-badges"><i class="red-ui-tabs-badge-changed fa fa-circle"></i><i class="red-ui-tabs-badge-selected fa fa-check-circle"></i></span></li><li class="red-ui-tab ui-draggable active" id="red-ui-tab-3bf62ee6-30e682" style="width: 398.5px;"><a href="http://xu7.co:8003/#3bf62ee6.30e682" class="red-ui-tab-label" title="v2x"><span class="workspace-disabled-icon"><i class="fa fa-ban"></i> </span><span class="bidiAware" dir="">v2x</span></a><span class="red-ui-tabs-badges"><i class="red-ui-tabs-badge-changed fa fa-circle"></i><i class="red-ui-tabs-badge-selected fa fa-check-circle"></i></span></li></ul></div><div class="red-ui-tab-button red-ui-tabs-add"><a href="http://xu7.co:8003/#"><i class="fa fa-plus"></i></a></div><div class="red-ui-tab-button red-ui-tabs-search"><a href="http://xu7.co:8003/#"><i class="fa fa-list-ul"></i></a></div><div class="red-ui-tab-button red-ui-tab-scroll red-ui-tab-scroll-left"><a href="http://xu7.co:8003/#" style="display:none;"><i class="fa fa-caret-left"></i></a></div><div class="red-ui-tab-button red-ui-tab-scroll red-ui-tab-scroll-right"><a href="http://xu7.co:8003/#" style="display:none;"><i class="fa fa-caret-right"></i></a></div></div>
        <div id="chart" tabindex="1" class="ui-droppable" style="display: block; margin-top: 0px;"><svg width="5000" height="5000" pointer-events="all" style="cursor: crosshair;"><g><g class="innerCanvas" transform="scale(1)"><rect width="5000" height="5000" fill="#fff"></rect><g style="visibility: visible;"><line class="horizontal" x1="0" x2="5000" y1="0" y2="0" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="20" y2="20" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="40" y2="40" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="60" y2="60" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="80" y2="80" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="100" y2="100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="120" y2="120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="140" y2="140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="160" y2="160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="180" y2="180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="200" y2="200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="220" y2="220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="240" y2="240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="260" y2="260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="280" y2="280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="300" y2="300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="320" y2="320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="340" y2="340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="360" y2="360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="380" y2="380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="400" y2="400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="420" y2="420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="440" y2="440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="460" y2="460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="480" y2="480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="500" y2="500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="520" y2="520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="540" y2="540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="560" y2="560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="580" y2="580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="600" y2="600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="620" y2="620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="640" y2="640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="660" y2="660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="680" y2="680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="700" y2="700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="720" y2="720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="740" y2="740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="760" y2="760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="780" y2="780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="800" y2="800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="820" y2="820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="840" y2="840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="860" y2="860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="880" y2="880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="900" y2="900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="920" y2="920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="940" y2="940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="960" y2="960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="980" y2="980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1000" y2="1000" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1020" y2="1020" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1040" y2="1040" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1060" y2="1060" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1080" y2="1080" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1100" y2="1100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1120" y2="1120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1140" y2="1140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1160" y2="1160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1180" y2="1180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1200" y2="1200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1220" y2="1220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1240" y2="1240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1260" y2="1260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1280" y2="1280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1300" y2="1300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1320" y2="1320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1340" y2="1340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1360" y2="1360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1380" y2="1380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1400" y2="1400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1420" y2="1420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1440" y2="1440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1460" y2="1460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1480" y2="1480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1500" y2="1500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1520" y2="1520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1540" y2="1540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1560" y2="1560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1580" y2="1580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1600" y2="1600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1620" y2="1620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1640" y2="1640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1660" y2="1660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1680" y2="1680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1700" y2="1700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1720" y2="1720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1740" y2="1740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1760" y2="1760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1780" y2="1780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1800" y2="1800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1820" y2="1820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1840" y2="1840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1860" y2="1860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1880" y2="1880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1900" y2="1900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1920" y2="1920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1940" y2="1940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1960" y2="1960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1980" y2="1980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2000" y2="2000" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2020" y2="2020" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2040" y2="2040" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2060" y2="2060" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2080" y2="2080" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2100" y2="2100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2120" y2="2120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2140" y2="2140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2160" y2="2160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2180" y2="2180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2200" y2="2200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2220" y2="2220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2240" y2="2240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2260" y2="2260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2280" y2="2280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2300" y2="2300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2320" y2="2320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2340" y2="2340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2360" y2="2360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2380" y2="2380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2400" y2="2400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2420" y2="2420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2440" y2="2440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2460" y2="2460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2480" y2="2480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2500" y2="2500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2520" y2="2520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2540" y2="2540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2560" y2="2560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2580" y2="2580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2600" y2="2600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2620" y2="2620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2640" y2="2640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2660" y2="2660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2680" y2="2680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2700" y2="2700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2720" y2="2720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2740" y2="2740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2760" y2="2760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2780" y2="2780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2800" y2="2800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2820" y2="2820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2840" y2="2840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2860" y2="2860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2880" y2="2880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2900" y2="2900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2920" y2="2920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2940" y2="2940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2960" y2="2960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2980" y2="2980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3000" y2="3000" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3020" y2="3020" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3040" y2="3040" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3060" y2="3060" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3080" y2="3080" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3100" y2="3100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3120" y2="3120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3140" y2="3140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3160" y2="3160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3180" y2="3180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3200" y2="3200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3220" y2="3220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3240" y2="3240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3260" y2="3260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3280" y2="3280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3300" y2="3300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3320" y2="3320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3340" y2="3340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3360" y2="3360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3380" y2="3380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3400" y2="3400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3420" y2="3420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3440" y2="3440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3460" y2="3460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3480" y2="3480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3500" y2="3500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3520" y2="3520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3540" y2="3540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3560" y2="3560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3580" y2="3580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3600" y2="3600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3620" y2="3620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3640" y2="3640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3660" y2="3660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3680" y2="3680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3700" y2="3700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3720" y2="3720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3740" y2="3740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3760" y2="3760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3780" y2="3780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3800" y2="3800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3820" y2="3820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3840" y2="3840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3860" y2="3860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3880" y2="3880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3900" y2="3900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3920" y2="3920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3940" y2="3940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3960" y2="3960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3980" y2="3980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4000" y2="4000" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4020" y2="4020" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4040" y2="4040" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4060" y2="4060" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4080" y2="4080" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4100" y2="4100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4120" y2="4120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4140" y2="4140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4160" y2="4160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4180" y2="4180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4200" y2="4200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4220" y2="4220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4240" y2="4240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4260" y2="4260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4280" y2="4280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4300" y2="4300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4320" y2="4320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4340" y2="4340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4360" y2="4360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4380" y2="4380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4400" y2="4400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4420" y2="4420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4440" y2="4440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4460" y2="4460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4480" y2="4480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4500" y2="4500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4520" y2="4520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4540" y2="4540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4560" y2="4560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4580" y2="4580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4600" y2="4600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4620" y2="4620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4640" y2="4640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4660" y2="4660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4680" y2="4680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4700" y2="4700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4720" y2="4720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4740" y2="4740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4760" y2="4760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4780" y2="4780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4800" y2="4800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4820" y2="4820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4840" y2="4840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4860" y2="4860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4880" y2="4880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4900" y2="4900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4920" y2="4920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4940" y2="4940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4960" y2="4960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4980" y2="4980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="0" x2="0" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="20" x2="20" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="40" x2="40" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="60" x2="60" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="80" x2="80" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="100" x2="100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="120" x2="120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="140" x2="140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="160" x2="160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="180" x2="180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="200" x2="200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="220" x2="220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="240" x2="240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="260" x2="260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="280" x2="280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="300" x2="300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="320" x2="320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="340" x2="340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="360" x2="360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="380" x2="380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="400" x2="400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="420" x2="420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="440" x2="440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="460" x2="460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="480" x2="480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="500" x2="500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="520" x2="520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="540" x2="540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="560" x2="560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="580" x2="580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="600" x2="600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="620" x2="620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="640" x2="640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="660" x2="660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="680" x2="680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="700" x2="700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="720" x2="720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="740" x2="740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="760" x2="760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="780" x2="780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="800" x2="800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="820" x2="820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="840" x2="840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="860" x2="860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="880" x2="880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="900" x2="900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="920" x2="920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="940" x2="940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="960" x2="960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="980" x2="980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1000" x2="1000" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1020" x2="1020" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1040" x2="1040" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1060" x2="1060" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1080" x2="1080" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1100" x2="1100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1120" x2="1120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1140" x2="1140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1160" x2="1160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1180" x2="1180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1200" x2="1200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1220" x2="1220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1240" x2="1240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1260" x2="1260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1280" x2="1280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1300" x2="1300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1320" x2="1320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1340" x2="1340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1360" x2="1360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1380" x2="1380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1400" x2="1400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1420" x2="1420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1440" x2="1440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1460" x2="1460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1480" x2="1480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1500" x2="1500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1520" x2="1520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1540" x2="1540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1560" x2="1560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1580" x2="1580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1600" x2="1600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1620" x2="1620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1640" x2="1640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1660" x2="1660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1680" x2="1680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1700" x2="1700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1720" x2="1720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1740" x2="1740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1760" x2="1760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1780" x2="1780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1800" x2="1800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1820" x2="1820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1840" x2="1840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1860" x2="1860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1880" x2="1880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1900" x2="1900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1920" x2="1920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1940" x2="1940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1960" x2="1960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1980" x2="1980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2000" x2="2000" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2020" x2="2020" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2040" x2="2040" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2060" x2="2060" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2080" x2="2080" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2100" x2="2100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2120" x2="2120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2140" x2="2140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2160" x2="2160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2180" x2="2180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2200" x2="2200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2220" x2="2220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2240" x2="2240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2260" x2="2260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2280" x2="2280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2300" x2="2300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2320" x2="2320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2340" x2="2340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2360" x2="2360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2380" x2="2380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2400" x2="2400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2420" x2="2420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2440" x2="2440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2460" x2="2460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2480" x2="2480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2500" x2="2500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2520" x2="2520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2540" x2="2540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2560" x2="2560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2580" x2="2580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2600" x2="2600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2620" x2="2620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2640" x2="2640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2660" x2="2660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2680" x2="2680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2700" x2="2700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2720" x2="2720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2740" x2="2740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2760" x2="2760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2780" x2="2780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2800" x2="2800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2820" x2="2820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2840" x2="2840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2860" x2="2860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2880" x2="2880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2900" x2="2900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2920" x2="2920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2940" x2="2940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2960" x2="2960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2980" x2="2980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3000" x2="3000" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3020" x2="3020" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3040" x2="3040" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3060" x2="3060" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3080" x2="3080" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3100" x2="3100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3120" x2="3120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3140" x2="3140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3160" x2="3160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3180" x2="3180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3200" x2="3200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3220" x2="3220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3240" x2="3240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3260" x2="3260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3280" x2="3280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3300" x2="3300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3320" x2="3320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3340" x2="3340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3360" x2="3360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3380" x2="3380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3400" x2="3400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3420" x2="3420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3440" x2="3440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3460" x2="3460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3480" x2="3480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3500" x2="3500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3520" x2="3520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3540" x2="3540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3560" x2="3560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3580" x2="3580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3600" x2="3600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3620" x2="3620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3640" x2="3640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3660" x2="3660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3680" x2="3680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3700" x2="3700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3720" x2="3720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3740" x2="3740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3760" x2="3760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3780" x2="3780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3800" x2="3800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3820" x2="3820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3840" x2="3840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3860" x2="3860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3880" x2="3880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3900" x2="3900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3920" x2="3920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3940" x2="3940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3960" x2="3960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3980" x2="3980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4000" x2="4000" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4020" x2="4020" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4040" x2="4040" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4060" x2="4060" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4080" x2="4080" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4100" x2="4100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4120" x2="4120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4140" x2="4140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4160" x2="4160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4180" x2="4180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4200" x2="4200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4220" x2="4220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4240" x2="4240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4260" x2="4260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4280" x2="4280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4300" x2="4300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4320" x2="4320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4340" x2="4340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4360" x2="4360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4380" x2="4380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4400" x2="4400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4420" x2="4420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4440" x2="4440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4460" x2="4460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4480" x2="4480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4500" x2="4500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4520" x2="4520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4540" x2="4540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4560" x2="4560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4580" x2="4580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4600" x2="4600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4620" x2="4620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4640" x2="4640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4660" x2="4660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4680" x2="4680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4700" x2="4700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4720" x2="4720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4740" x2="4740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4760" x2="4760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4780" x2="4780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4800" x2="4800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4820" x2="4820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4840" x2="4840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4860" x2="4860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4880" x2="4880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4900" x2="4900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4920" x2="4920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4940" x2="4940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4960" x2="4960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4980" x2="4980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line></g><g><g class="link"><path class="link_background link_path" d="M 200 80 C 275 80 233 80 308 80"></path><path class="link_outline link_path" d="M 200 80 C 275 80 233 80 308 80"></path><path class="link_line link_path" d="M 200 80 C 275 80 233 80 308 80"></path></g><g class="link"><path class="link_background link_path" d="M 408 80 C 483 80 445 80 520 80"></path><path class="link_outline link_path" d="M 408 80 C 483 80 445 80 520 80"></path><path class="link_line link_path" d="M 408 80 C 483 80 445 80 520 80"></path></g><g class="link"><path class="link_background link_path" d="M 240 180 C 306 180 262 180 328 180"></path><path class="link_outline link_path" d="M 240 180 C 306 180 262 180 328 180"></path><path class="link_line link_path" d="M 240 180 C 306 180 262 180 328 180"></path></g><g class="link"><path class="link_background link_path" d="M 508 180 C 539.5 180 518.5 180 550 180"></path><path class="link_outline link_path" d="M 508 180 C 539.5 180 518.5 180 550 180"></path><path class="link_line link_path" d="M 508 180 C 539.5 180 518.5 180 550 180"></path></g><g class="link"><path class="link_background link_path" d="M 477 232 C 522 232 492 232 537 232"></path><path class="link_outline link_path" d="M 477 232 C 522 232 492 232 537 232"></path><path class="link_line link_path" d="M 477 232 C 522 232 492 232 537 232"></path></g></g><g></g><g><g class="node nodegroup" id="d3bd8584.bc0528" transform="translate(80,65)"><rect class="node" rx="5" ry="5" fill="rgb(231, 231, 174)" width="120" height="30"></rect><g class="node_icon_group" x="0" y="0" transform="translate(0, 0)" style="pointer-events: none;"><rect x="0" y="0" class="node_icon_shade" width="30" stroke="none" fill="#000" fill-opacity="0.05" height="30"></rect><image href="icons/node-red/white-globe.png" class="node_icon" x="5" width="20" height="30" y="0"></image><path d="M 30 1 l 0 28" class="node_icon_shade_border" stroke-opacity="0.1" stroke="#000" stroke-width="1"></path></g><text class="node_label" x="38" dy=".35em" text-anchor="start" y="14">[get] /v2x</text><g class="node_status_group" style="display: none;"><rect class="node_status" x="6" y="1" width="9" height="9" rx="2" ry="2" stroke-width="3"></rect><text class="node_status_label" x="20" y="10"></text></g><image class="node_error hidden" href="red/images/icons/node-error.png" x="110" y="-6" width="10" height="9"></image><image class="node_changed hidden" href="red/images/icons/node-changed.png" x="110" y="-6" width="10" height="10"></image><g class="port_output" transform="translate(115,10)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g></g><g class="node nodegroup" id="12df74a1.8ef6cb" transform="translate(520,65)"><rect class="node" rx="5" ry="5" fill="rgb(231, 231, 174)" width="100" height="30"></rect><g class="node_icon_group node_icon_group_right" x="0" y="0" transform="translate(70,0)" style="pointer-events: none;"><rect x="0" y="0" class="node_icon_shade" width="30" stroke="none" fill="#000" fill-opacity="0.05" height="30"></rect><image href="icons/node-red/white-globe.png" class="node_icon" x="5" width="20" height="30" y="0"></image><path d="M 0 1 l 0 28" class="node_icon_shade_border" stroke-opacity="0.1" stroke="#000" stroke-width="1"></path></g><text class="node_label node_label_right" x="62" dy=".35em" text-anchor="end" y="14">http</text><g class="node_status_group" style="display: none;"><rect class="node_status" x="6" y="1" width="9" height="9" rx="2" ry="2" stroke-width="3"></rect><text class="node_status_label" x="20" y="10"></text></g><image class="node_error hidden" href="red/images/icons/node-error.png" x="90" y="-6" width="10" height="9"></image><image class="node_changed hidden" href="red/images/icons/node-changed.png" x="90" y="-6" width="10" height="10"></image><g class="port_input" transform="translate(-5,10)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g></g><g class="node nodegroup" id="45cd110a.19342" transform="translate(308,65)"><rect class="node" rx="5" ry="5" fill="rgb(243, 181, 103)" width="100" height="30"></rect><g class="node_icon_group" x="0" y="0" transform="translate(0, 0)" style="pointer-events: none;"><rect x="0" y="0" class="node_icon_shade" width="30" stroke="none" fill="#000" fill-opacity="0.05" height="30"></rect><image href="icons/node-red/template.png" class="node_icon" x="5" width="20" height="30" y="0"></image><path d="M 30 1 l 0 28" class="node_icon_shade_border" stroke-opacity="0.1" stroke="#000" stroke-width="1"></path></g><text class="node_label node_label_italic" x="38" dy=".35em" text-anchor="start" y="14">map</text><g class="node_status_group" style="display: none;"><rect class="node_status" x="6" y="1" width="9" height="9" rx="2" ry="2" stroke-width="3"></rect><text class="node_status_label" x="20" y="10"></text></g><image class="node_error hidden" href="red/images/icons/node-error.png" x="90" y="-6" width="10" height="9"></image><image class="node_changed hidden" href="red/images/icons/node-changed.png" x="90" y="-6" width="10" height="10"></image><g class="port_input" transform="translate(-5,10)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g><g class="port_output" transform="translate(95,10)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g></g><g class="node nodegroup" id="dc54f458.28d828" transform="translate(60,165)"><g transform="translate(-25,2)" class="node_button node_left_button" opacity="1"><rect rx="5" ry="5" width="32" height="26" fill="#eee" fill-opacity="1"></rect><rect class="node_button_button" x="5" y="4" rx="4" ry="4" width="16" height="18" fill="#a6bbcf" cursor="pointer" fill-opacity="1"></rect></g><rect class="node" rx="5" ry="5" fill="#a6bbcf" width="180" height="30"></rect><g class="node_icon_group" x="0" y="0" transform="translate(0, 0)" style="pointer-events: none;"><rect x="0" y="0" class="node_icon_shade" width="30" stroke="none" fill="#000" fill-opacity="0.05" height="30"></rect><image href="icons/node-red/inject.png" class="node_icon" x="5" width="20" height="30" y="0"></image><path d="M 30 1 l 0 28" class="node_icon_shade_border" stroke-opacity="0.1" stroke="#000" stroke-width="1"></path></g><text class="node_label node_label_italic" x="38" dy=".35em" text-anchor="start" y="14">Tick every 1 secs ↻</text><g class="node_status_group" style="display: none;"><rect class="node_status" x="6" y="1" width="9" height="9" rx="2" ry="2" stroke-width="3"></rect><text class="node_status_label" x="20" y="10"></text></g><image class="node_error hidden" href="red/images/icons/node-error.png" x="170" y="-6" width="10" height="9"></image><image class="node_changed hidden" href="red/images/icons/node-changed.png" x="170" y="-6" width="10" height="10"></image><g class="port_output" transform="translate(175,10)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g></g><g class="node nodegroup" id="850815da.0ab508" transform="translate(550,165)"><rect class="node" rx="5" ry="5" fill="rgb(215, 215, 160)" width="140" height="30"></rect><g class="node_icon_group node_icon_group_right" x="0" y="0" transform="translate(110,0)" style="pointer-events: none;"><rect x="0" y="0" class="node_icon_shade" width="30" stroke="none" fill="#000" fill-opacity="0.05" height="30"></rect><image href="icons/node-red/white-globe.png" class="node_icon" x="5" width="20" height="30" y="0"></image><path d="M 0 1 l 0 28" class="node_icon_shade_border" stroke-opacity="0.1" stroke="#000" stroke-width="1"></path></g><text class="node_label node_label_right" x="102" dy=".35em" text-anchor="end" y="14">[ws] /ws/v2x</text><g class="node_status_group" style="display: inline;" transform="translate(3,33)"><rect class="node_status" x="6" y="1" width="9" height="9" rx="2" ry="2" stroke-width="3" style="display: inline; fill: rgb(85, 170, 136); stroke: rgb(85, 170, 136);"></rect><text class="node_status_label" x="20" y="10">connected 1</text></g><image class="node_error hidden" href="red/images/icons/node-error.png" x="130" y="-6" width="10" height="9"></image><image class="node_changed hidden" href="red/images/icons/node-changed.png" x="130" y="-6" width="10" height="10"></image><g class="port_input" transform="translate(-5,10)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g></g><g class="node nodegroup" id="556a8419.17279c" transform="translate(328,165)"><rect class="node node_selected" rx="5" ry="5" fill="#fdd0a2" width="180" height="30"></rect><g class="node_icon_group" x="0" y="0" transform="translate(0, 0)" style="pointer-events: none;"><rect x="0" y="0" class="node_icon_shade" width="30" stroke="none" fill="#000" fill-opacity="0.05" height="30"></rect><image href="icons/node-red/function.png" class="node_icon" x="5" width="20" height="30" y="0"></image><path d="M 30 1 l 0 28" class="node_icon_shade_border" stroke-opacity="0.1" stroke="#000" stroke-width="1"></path></g><text class="node_label node_label_italic" x="38" dy=".35em" text-anchor="start" y="14">format time nicely</text><g class="node_status_group" style="display: none;"><rect class="node_status" x="6" y="1" width="9" height="9" rx="2" ry="2" stroke-width="3"></rect><text class="node_status_label" x="20" y="10"></text></g><image class="node_error hidden" href="red/images/icons/node-error.png" x="170" y="-6" width="10" height="9"></image><image class="node_changed hidden" href="red/images/icons/node-changed.png" x="170" y="-6" width="10" height="10"></image><g class="port_input" transform="translate(-5,10)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g><g class="port_output" transform="translate(175,10)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g></g><g class="node nodegroup" id="1afc0796.2300d8" transform="translate(337,217)"><rect class="node" rx="5" ry="5" fill="rgb(215, 215, 160)" width="140" height="30"></rect><g class="node_icon_group" x="0" y="0" transform="translate(0, 0)" style="pointer-events: none;"><rect x="0" y="0" class="node_icon_shade" width="30" stroke="none" fill="#000" fill-opacity="0.05" height="30"></rect><image href="icons/node-red/white-globe.png" class="node_icon" x="5" width="20" height="30" y="0"></image><path d="M 30 1 l 0 28" class="node_icon_shade_border" stroke-opacity="0.1" stroke="#000" stroke-width="1"></path></g><text class="node_label" x="38" dy=".35em" text-anchor="start" y="14">[ws] /ws/v2x</text><g class="node_status_group" style="display: inline;" transform="translate(3,33)"><rect class="node_status" x="6" y="1" width="9" height="9" rx="2" ry="2" stroke-width="3" style="display: inline; fill: rgb(85, 170, 136); stroke: rgb(85, 170, 136);"></rect><text class="node_status_label" x="20" y="10">connected 1</text></g><image class="node_error hidden" href="red/images/icons/node-error.png" x="130" y="-6" width="10" height="9"></image><image class="node_changed hidden" href="red/images/icons/node-changed.png" x="130" y="-6" width="10" height="10"></image><g class="port_output" transform="translate(135,10)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g></g><g class="node nodegroup" id="b20f83fb.803ff" transform="translate(537,217)"><g transform="translate(134,2)" class="node_button node_right_button" opacity="1" style="display: inherit;"><rect rx="5" ry="5" width="32" height="26" fill="#eee" fill-opacity="1"></rect><rect class="node_button_button" x="11" y="4" rx="4" ry="4" width="16" height="18" fill="#87a980" cursor="pointer" fill-opacity="1"></rect></g><rect class="node" rx="5" ry="5" fill="#87a980" width="140" height="30"></rect><g class="node_icon_group node_icon_group_right" x="0" y="0" transform="translate(110,0)" style="pointer-events: none;"><rect x="0" y="0" class="node_icon_shade" width="30" stroke="none" fill="#000" fill-opacity="0.05" height="30"></rect><image href="icons/node-red/debug.png" class="node_icon" x="5" width="20" height="30" y="0"></image><path d="M 0 1 l 0 28" class="node_icon_shade_border" stroke-opacity="0.1" stroke="#000" stroke-width="1"></path></g><text class="node_label node_label_right" x="102" dy=".35em" text-anchor="end" y="14">msg.payload</text><g class="node_status_group" style="display: inline;" transform="translate(-14,33)"><rect class="node_status" x="6" y="1" width="9" height="9" rx="2" ry="2" stroke-width="3" style="display: none;"></rect><text class="node_status_label" x="20" y="10"></text></g><image class="node_error hidden" href="red/images/icons/node-error.png" x="130" y="-6" width="10" height="9"></image><image class="node_changed hidden" href="red/images/icons/node-changed.png" x="130" y="-6" width="10" height="10"></image><g class="port_input" transform="translate(-5,10)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g></g></g></g></g></svg></div>
        <div id="workspace-toolbar" style="display: none;"></div>
        <div id="workspace-footer">
            <a class="workspace-footer-button" id="btn-zoom-out" href="http://xu7.co:8003/#" style="display: inline-block;"><i class="fa fa-minus"></i></a>
            <a class="workspace-footer-button" id="btn-zoom-zero" href="http://xu7.co:8003/#" style="display: inline-block;"><i class="fa fa-circle-o"></i></a>
            <a class="workspace-footer-button" id="btn-zoom-in" href="http://xu7.co:8003/#" style="display: inline-block;"><i class="fa fa-plus"></i></a>
            <a class="workspace-footer-button-toggle single" id="btn-navigate" href="http://xu7.co:8003/#" style="display: inline-block;"><i class="fa fa-map-o"></i></a>
        </div>
        <div id="editor-shade" class="hide" style="display: block;"></div>
    <div style="position: absolute; bottom: 25px; right: 0px; z-index: 1; display: none;"><svg width="200" height="200" pointer-events="all" style="position: absolute; bottom: 0px; right: 0px; border-left: 1px solid rgb(204, 204, 204); border-top: 1px solid rgb(204, 204, 204); background: rgba(245, 245, 245, 0.8); box-shadow: rgba(0, 0, 0, 0.1) -1px 0px 3px;"><rect x="0" y="0" width="200" height="200" style="fill: none; stroke: none;"></rect><rect stroke-dasharray="5,5" pointer-events="none" style="stroke: rgb(153, 153, 153); fill: white;" x="0" y="0" width="37.48" height="25.52"></rect><g></g></svg></div></div>
    <div id="editor-stack"><div class="editor-tray ui-draggable" style="width: 500px; right: 0px; transition: right 0.25s ease 0s;"><div class="editor-tray-header"><div class="editor-tray-titlebar"><ul class="editor-tray-breadcrumbs"><li>编辑function节点</li></ul></div><div class="editor-tray-toolbar"><button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only leftButton" role="button" aria-disabled="false" id="node-dialog-delete">删除</button><button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false" id="node-dialog-cancel">取消</button><button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only primary" role="button" aria-disabled="false" id="node-dialog-ok">完成</button></div></div><div class="editor-tray-body-wrapper" style="overflow: hidden;"><div class="editor-tray-body" style="min-width: 460px; height: 579.2px;"><div class="red-ui-tabs red-ui-tabs-collapsible"><div><ul><li class="red-ui-tab red-ui-tab-pinned active" id="red-ui-tab-editor-tab-properties" style="width: 388px;"><a href="http://xu7.co:8003/#editor-tab-properties" class="red-ui-tab-label" title="Properties"><i class="red-ui-tab-icon fa fa-cog"></i><span class="bidiAware" dir="">Properties</span></a><span class="red-ui-tabs-badges"></span></li><li class="red-ui-tab red-ui-tab-pinned" id="red-ui-tab-editor-tab-description" style="width: 388px;"><a href="http://xu7.co:8003/#editor-tab-description" class="red-ui-tab-label" title="Description"><i class="red-ui-tab-icon fa fa-file-text-o"></i><span class="bidiAware" dir="">Description</span></a><span class="red-ui-tabs-badges"></span></li><li class="red-ui-tab red-ui-tab-pinned" id="red-ui-tab-editor-tab-appearance" style="width: 388px;"><a href="http://xu7.co:8003/#editor-tab-appearance" class="red-ui-tab-label" title="Appearance"><i class="red-ui-tab-icon fa fa-object-group"></i><span class="bidiAware" dir="">Appearance</span></a><span class="red-ui-tabs-badges"></span></li></ul></div><div class="red-ui-tab-link-buttons"><a href="http://xu7.co:8003/#editor-tab-properties" class="red-ui-tab-link-button active selected" id="red-ui-tab-editor-tab-properties-link-button"><i class="fa fa-cog"></i></a><a href="http://xu7.co:8003/#editor-tab-description" class="red-ui-tab-link-button" id="red-ui-tab-editor-tab-description-link-button"><i class="fa fa-file-text-o"></i></a><a href="http://xu7.co:8003/#editor-tab-appearance" class="red-ui-tab-link-button" id="red-ui-tab-editor-tab-appearance-link-button"><i class="fa fa-object-group"></i></a></div></div><div><div class="editor-tray-content" style="display: block; height: 529px;"><form id="dialog-form" class="form-horizontal" autocomplete="off" style="height: 489px;"><input type="text" style="display: none;"><input type="password" style="display: none;">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name">名称</span></label>
        <div style="display: inline-block; width: calc(100% - 105px)"><input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name" dir="" placeholder="名称" style="width: calc(100% - 52px);"><div class="btn-group" style="margin-left:5px;"><a id="node-input-function-lookup" class="editor-button" data-toggle="dropdown"><i class="fa fa-book"></i> <i class="fa fa-caret-down"></i></a><ul class="dropdown-menu pull-right" role="menu"><li><a id="node-input-function-menu-open-library" tabindex="-1" href="http://xu7.co:8003/#">打开库...</a></li><li><a id="node-input-function-menu-save-library" tabindex="-1" href="http://xu7.co:8003/#">保存到库...</a></li></ul></div></div>
    </div>
    <div class="form-row" style="margin-bottom: 0px;">
        <label for="node-input-func"><i class="fa fa-wrench"></i> <span data-i18n="node-red:function.label.function">函数</span></label>
        <input type="hidden" id="node-input-func" autofocus="autofocus" value="msg.payload = Date(msg.payload).toString();
return msg;" dir="">
        <input type="hidden" id="node-input-noerr" value="0" dir="" class="input-error">
    </div>
    <div class="form-row node-text-editor-row" style="position:relative">
        <div style="position: absolute; right:0; bottom:calc(100% + 3px);"><button id="node-function-expand-js" class="editor-button editor-button-small"><i class="fa fa-expand"></i></button></div>
        <div style="height: 372px; min-height: 150px;" class="node-text-editor" id="node-input-func-editor"><div></div><div class="node-text-editor-container ace_editor ace_hidpi ace-tomorrow ace_focus"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; font-size: 1px; height: 1px; width: 1px; transform: translate(214px, 144px);"></textarea><div class="ace_gutter" aria-hidden="true" style="left: 0px; width: 50px;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="height: 1e+06px; transform: translate(0px, 0px); width: 50px;"><div class="ace_gutter-cell " style="height: 16px; top: 0px;">1<span class="ace_fold-widget ace_start ace_open" style="display: inline-block; height: 16px;"></span></div><div class="ace_gutter-cell " style="height: 16px; top: 16px;">2<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 16px; top: 32px;">3<span class="ace_fold-widget ace_start ace_open" style="height: 16px; display: inline-block;"></span></div><div class="ace_gutter-cell " style="height: 16px; top: 48px;">4<span class="ace_fold-widget ace_end ace_open" style="display: none; height: 16px;"></span></div><div class="ace_gutter-cell " style="height: 16px; top: 64px;">5<span class="ace_fold-widget ace_end ace_open" style="display: none; height: 16px;"></span></div><div class="ace_gutter-cell " style="height: 16px; top: 80px;">6<span class="ace_fold-widget ace_end ace_open" style="display: inline-block; height: 16px;"></span></div><div class="ace_gutter-cell " style="height: 16px; top: 96px;">7<span class="ace_fold-widget ace_start ace_open" style="display: inline-block; height: 16px;"></span></div><div class="ace_gutter-cell " style="height: 16px; top: 112px;">8<span class="ace_fold-widget ace_end ace_open" style="display: none; height: 16px;"></span></div><div class="ace_gutter-cell ace_gutter-active-line " style="height: 16px; top: 128px;">9<span class="ace_fold-widget ace_end ace_open" style="display: none; height: 16px;"></span></div><div class="ace_gutter-cell " style="height: 16px; top: 144px;">10<span class="ace_fold-widget ace_end ace_open" style="height: 16px; display: inline-block;"></span></div><div class="ace_gutter-cell " style="height: 16px; top: 160px;">11<span style="display: inline-block; height: 16px;" class="ace_fold-widget ace_end ace_open"></span></div><div class="ace_gutter-cell " style="height: 16px; top: 176px;">12<span style="display: none;"></span></div></div></div><div class="ace_scroller" style="left: 49.8574px; right: 0px; bottom: 0px;"><div class="ace_content" style="transform: translate(0px, 0px); width: 408.143px; height: 404px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 678px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height: 16px; top: 128px; left: 0px; right: 0px;"></div></div><div class="ace_layer ace_text-layer" style="height: 1e+06px; margin: 0px 4px; transform: translate(0px, 0px);"><div class="ace_line" style="height: 16px; top: 0px;"><span class="ace_identifier">msg</span><span class="ace_punctuation ace_operator">.</span><span class="ace_identifier">payload</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_paren ace_lparen">{</span></div><div class="ace_line" style="height: 16px; top: 16px;">    </div><div class="ace_line" style="height: 16px; top: 32px;">    <span class="ace_identifier">hv</span><span class="ace_punctuation ace_operator">:</span> <span class="ace_paren ace_lparen">{</span></div><div class="ace_line" style="height: 16px; top: 48px;">    <span class="ace_identifier">lon</span><span class="ace_punctuation ace_operator">:</span><span class="ace_constant ace_numeric">112.994341</span><span class="ace_punctuation ace_operator">,</span></div><div class="ace_line" style="height: 16px; top: 64px;">    <span class="ace_identifier">lat</span><span class="ace_punctuation ace_operator">:</span><span class="ace_constant ace_numeric">28.234125</span><span class="ace_punctuation ace_operator">,</span></div><div class="ace_line" style="height: 16px; top: 80px;">    <span class="ace_paren ace_rparen">}</span><span class="ace_punctuation ace_operator">,</span></div><div class="ace_line" style="height: 16px; top: 96px;">    <span class="ace_identifier">rv</span><span class="ace_punctuation ace_operator">:</span> <span class="ace_paren ace_lparen">{</span></div><div class="ace_line" style="height: 16px; top: 112px;"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">lon</span><span class="ace_punctuation ace_operator">:</span><span class="ace_constant ace_numeric">112.994341</span><span class="ace_punctuation ace_operator">,</span></div><div class="ace_line" style="height: 16px; top: 128px;"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">lat</span><span class="ace_punctuation ace_operator">:</span><span class="ace_constant ace_numeric">28.234125</span><span class="ace_punctuation ace_operator">,</span>  </div><div class="ace_line" style="height: 16px; top: 144px;">    <span class="ace_paren ace_rparen">}</span></div><div class="ace_line" style="height: 16px; top: 160px;"><span class="ace_paren ace_rparen">}</span></div><div class="ace_line" style="height: 16px; top: 176px;"><span class="ace_keyword">return</span> <span class="ace_identifier">msg</span><span class="ace_punctuation ace_operator">;</span></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_animate-blinking"><div class="ace_cursor" style="animation-duration: 1000ms; display: block; transform: translate(164px, 128px); width: 8px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 192px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 49.8574px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 416.57px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;">הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה</div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div><div class="ace_tooltip" style="display: none; left: 680.094px; top: 283.094px;">Expected an identifier and instead saw ','.</div></div></div>
    </div>
    <div class="form-row" style="margin-bottom: 0px">
        <label for="node-input-outputs"><i class="fa fa-random"></i> <span data-i18n="node-red:function.label.outputs">输出</span></label>
        <span class="ui-spinner ui-widget ui-widget-content ui-corner-all"><input id="node-input-outputs" style="width: 60px;" value="1" dir="" aria-valuemin="1" aria-valuenow="1" class="ui-spinner-input" autocomplete="off" role="spinbutton"><a class="ui-spinner-button ui-spinner-up ui-corner-tr ui-button ui-widget ui-state-default ui-button-text-only" tabindex="-1" role="button" aria-disabled="false"><span class="ui-button-text"><span class="ui-icon ui-icon-triangle-1-n">▲</span></span></a><a class="ui-spinner-button ui-spinner-down ui-corner-br ui-button ui-widget ui-state-default ui-button-text-only" tabindex="-1" role="button" aria-disabled="false"><span class="ui-button-text"><span class="ui-icon ui-icon-triangle-1-s">▼</span></span></a></span>
    </div>
</form></div><div class="editor-tray-content" style="display: none; height: 529px;"><form class="dialog-form form-horizontal" autocomplete="off" style="height: 489px;"><div></div><div class="form-row node-text-editor-row" style="position:relative; padding-top: 4px; height: 100%"><div style="height: 372px;" class="node-text-editor" id="node-info-input-info-editor"><div><div style="margin-bottom: 5px"><span class="button-group"><button type="button" class="editor-button" data-style="h1" style="font-size:1.1em; font-weight: bold">h1</button><button type="button" class="editor-button" data-style="h2" style="font-size:1.0em; font-weight: bold">h2</button><button type="button" class="editor-button" data-style="h3" style="font-size:0.9em; font-weight: bold">h3</button></span><span class="button-group"><button type="button" class="editor-button" data-style="b"><i class="fa fa-bold"></i></button><button type="button" class="editor-button" data-style="i"><i class="fa fa-italic"></i></button><button type="button" class="editor-button" data-style="code"><i class="fa fa-code"></i></button></span><span class="button-group"><button type="button" class="editor-button" data-style="ol"><i class="fa fa-list-ol"></i></button><button type="button" class="editor-button" data-style="ul"><i class="fa fa-list-ul"></i></button><button type="button" class="editor-button" data-style="bq"><i class="fa fa-quote-left"></i></button><button type="button" class="editor-button" data-style="hr"><i class="fa fa-minus"></i></button><button type="button" class="editor-button" data-style="link"><i class="fa fa-link"></i></button></span><button type="button" class="editor-button" style="float: right;"><i class="fa fa-expand"></i></button></div></div><div class="node-text-editor-container ace_editor ace_hidpi ace-tomorrow node-text-editor-container-toolbar"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; font-size: 1px;"></textarea><div class="ace_gutter" aria-hidden="true"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="height: 1e+06px;"></div></div><div class="ace_scroller"><div class="ace_content"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 4px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="height: 1e+06px; margin: 0px 4px;"></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px;"><div class="ace_scrollbar-inner" style="width: 20px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px;"><div class="ace_scrollbar-inner" style="height: 20px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><button type="button" class="node-text-editor-help editor-button editor-button-small"><i class="fa fa-question"></i></button></div></div></form></div><div class="editor-tray-content" style="display: none; height: 529px;"><form class="dialog-form form-horizontal" autocomplete="off" style="height: 489px;"><div class="form-row"><label for="node-input-show-label-btn" data-i18n="editor.label">Label</label><button type="button" id="node-input-show-label-btn" class="editor-button" style="min-width: 80px; text-align: left;"><i id="node-input-show-label-btn-i" class="fa fa-toggle-on"></i> <span id="node-input-show-label-label">Show</span></button> <input type="checkbox" id="node-input-show-label" style="display: none;"></div><div class="form-row"><label data-i18n="editor.settingIcon">Icon</label><button type="button" class="editor-button" id="node-settings-icon-button"><div class="red-ui-search-result-node" style="background-color: rgb(253, 208, 162);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/function.png&quot;);"></div></div></div><div id="node-settings-icon"></div></button></div><div class="form-row"><span data-i18n="editor.portLabels">端口标签</span></div><div class="form-row"><span style="margin-left: 50px;" data-i18n="editor.labelInputs">输入</span><div id="node-label-form-inputs"><div class="node-label-form-row"><label for="node-label-form-input-0">1.</label><input type="text" id="node-label-form-input-0" placeholder="无"><button type="button" class="editor-button editor-button-small"><i class="fa fa-times"></i></button></div></div></div><div class="form-row"><span style="margin-left: 50px;" data-i18n="editor.labelOutputs">输出</span><div id="node-label-form-outputs"><div class="node-label-form-row"><label for="node-label-form-output-0">1.</label><input type="text" id="node-label-form-output-0" placeholder="无"><button type="button" class="editor-button editor-button-small"><i class="fa fa-times"></i></button></div></div></div></form></div></div></div></div><div class="editor-tray-footer"></div><div class="editor-tray-resize-handle"></div></div></div>
    <div id="palette">
        <img src="./Node-RED _ xu7.co_files/spin.svg" class="palette-spinner hide" style="display: none;">
        <div id="palette-search" class="palette-search">
            <div class="red-ui-searchBox-container"><i class="fa fa-search"></i><input type="text" data-i18n="[placeholder]palette.filter" placeholder="过滤节点"><a href="http://xu7.co:8003/#"><i class="fa fa-times"></i></a><span class="red-ui-searchBox-resultCount hide"></span></div>
        </div>
        <div id="palette-container" class="palette-scroll"><div id="palette-container-subflows" class="palette-category palette-close hide"><div id="palette-header-subflows" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>子流程</span></div><div class="palette-content" id="palette-base-category-subflows"><div id="palette-subflows-input"></div><div id="palette-subflows-output"></div><div id="palette-subflows-function"></div></div></div><div id="palette-container-input" class="palette-category palette-close hide palette-open" style="display: block;"><div id="palette-header-input" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>输入</span></div><div class="palette-content" id="palette-base-category-input" style=""><div id="palette-input-input"></div><div id="palette-input-output"></div><div id="palette-input-function"></div><div id="palette-input"><div id="palette_node_inject" class="palette_node ui-draggable" style="background-color: rgb(166, 187, 207); height: 28px;"><div class="palette_label" dir="">inject</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/inject.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_catch" class="palette_node ui-draggable" style="background-color: rgb(228, 145, 145); height: 28px;"><div class="palette_label" dir="">catch</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/alert.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_status" class="palette_node ui-draggable" style="background-color: rgb(192, 237, 192); height: 28px;"><div class="palette_label" dir="">status</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/alert.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_link_in" class="palette_node ui-draggable" style="background-color: rgb(221, 221, 221); height: 28px;"><div class="palette_label" dir="">link</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/link-out.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_mqtt_in" class="palette_node ui-draggable" style="background-color: rgb(216, 191, 216); height: 28px;"><div class="palette_label" dir="">mqtt</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/bridge.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_http_in" class="palette_node ui-draggable" style="background-color: rgb(231, 231, 174); height: 28px;"><div class="palette_label" dir="">http</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/white-globe.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_websocket_in" class="palette_node ui-draggable" style="background-color: rgb(215, 215, 160); height: 28px;"><div class="palette_label" dir="">websocket</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/white-globe.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_tcp_in" class="palette_node ui-draggable" style="background-color: silver; height: 28px;"><div class="palette_label" dir="">tcp</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/bridge-dash.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_udp_in" class="palette_node ui-draggable" style="background-color: silver; height: 28px;"><div class="palette_label" dir="">udp</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/bridge-dash.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div></div></div></div><div id="palette-container-output" class="palette-category palette-close hide palette-open" style="display: block;"><div id="palette-header-output" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>输出</span></div><div class="palette-content" id="palette-base-category-output" style=""><div id="palette-output-input"></div><div id="palette-output-output"></div><div id="palette-output-function"></div><div id="palette-output"><div id="palette_node_debug" class="palette_node ui-draggable" style="background-color: rgb(135, 169, 128); height: 28px;"><div class="palette_label palette_label_right" dir="">debug</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/debug.png&quot;);"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_link_out" class="palette_node ui-draggable" style="background-color: rgb(221, 221, 221); height: 28px;"><div class="palette_label palette_label_right" dir="">link</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/link-out.png&quot;);"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_mqtt_out" class="palette_node ui-draggable" style="background-color: rgb(216, 191, 216); height: 28px;"><div class="palette_label palette_label_right" dir="">mqtt</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/bridge.png&quot;);"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_http_response" class="palette_node ui-draggable" style="background-color: rgb(231, 231, 174); height: 28px;"><div class="palette_label palette_label_right" dir="">http response</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/white-globe.png&quot;);"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_websocket_out" class="palette_node ui-draggable" style="background-color: rgb(215, 215, 160); height: 28px;"><div class="palette_label palette_label_right" dir="">websocket</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/white-globe.png&quot;);"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_tcp_out" class="palette_node ui-draggable" style="background-color: silver; height: 28px;"><div class="palette_label palette_label_right" dir="">tcp</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/bridge-dash.png&quot;);"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_udp_out" class="palette_node ui-draggable" style="background-color: silver; height: 28px;"><div class="palette_label palette_label_right" dir="">udp</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/bridge-dash.png&quot;);"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div></div></div></div><div id="palette-container-function" class="palette-category palette-close hide palette-open" style="display: block;"><div id="palette-header-function" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>功能</span></div><div class="palette-content" id="palette-base-category-function" style=""><div id="palette-function-input"></div><div id="palette-function-output"></div><div id="palette-function-function"></div><div id="palette-function"><div id="palette_node_function" class="palette_node ui-draggable" style="background-color: rgb(253, 208, 162); height: 28px;"><div class="palette_label" dir="">function</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/function.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_template" class="palette_node ui-draggable" style="background-color: rgb(243, 181, 103); height: 28px;"><div class="palette_label" dir="">template</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/template.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_delay" class="palette_node ui-draggable" style="background-color: rgb(230, 224, 248); height: 28px;"><div class="palette_label" dir="">delay</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/timer.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_trigger" class="palette_node ui-draggable" style="background-color: rgb(230, 224, 248); height: 28px;"><div class="palette_label" dir="">trigger</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/trigger.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_comment" class="palette_node ui-draggable" style="background-color: rgb(255, 255, 255); height: 28px;"><div class="palette_label" dir="">comment</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/comment.png&quot;);"></div></div></div><div id="palette_node_http_request" class="palette_node ui-draggable" style="background-color: rgb(231, 231, 174); height: 28px;"><div class="palette_label" dir="">http request</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/white-globe.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_tcp_request" class="palette_node ui-draggable" style="background-color: silver; height: 28px;"><div class="palette_label" dir="">tcp request</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/bridge-dash.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_switch" class="palette_node ui-draggable" style="background-color: rgb(226, 217, 110); height: 28px;"><div class="palette_label" dir="">switch</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/switch.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_change" class="palette_node ui-draggable" style="background-color: rgb(226, 217, 110); height: 28px;"><div class="palette_label" dir="">change</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/swap.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_range" class="palette_node ui-draggable" style="background-color: rgb(226, 217, 110); height: 28px;"><div class="palette_label" dir="">range</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/range.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_split" class="palette_node ui-draggable" style="background-color: rgb(226, 217, 110); height: 28px;"><div class="palette_label" dir="">split</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/split.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_join" class="palette_node ui-draggable" style="background-color: rgb(226, 217, 110); height: 28px;"><div class="palette_label" dir="">join</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/join.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_sort" class="palette_node ui-draggable" style="background-color: rgb(226, 217, 110); height: 28px;"><div class="palette_label" dir="">sort</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/sort.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_batch" class="palette_node ui-draggable" style="background-color: rgb(226, 217, 110); height: 28px;"><div class="palette_label" dir="">batch</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/batch.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_csv" class="palette_node ui-draggable" style="background-color: rgb(222, 189, 92); height: 28px;"><div class="palette_label" dir="">csv</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/parser-csv.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_html" class="palette_node ui-draggable" style="background-color: rgb(222, 189, 92); height: 28px;"><div class="palette_label" dir="">html</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/parser-html.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_json" class="palette_node ui-draggable" style="background-color: rgb(222, 189, 92); height: 28px;"><div class="palette_label" dir="">json</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/parser-json.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_xml" class="palette_node ui-draggable" style="background-color: rgb(222, 189, 92); height: 28px;"><div class="palette_label" dir="">xml</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/parser-xml.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_yaml" class="palette_node ui-draggable" style="background-color: rgb(222, 189, 92); height: 28px;"><div class="palette_label" dir="">yaml</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/parser-yaml.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_base64" class="palette_node ui-draggable" style="background-color: rgb(222, 189, 92); height: 28px;"><div class="palette_label" dir="">base64</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red-node-base64/parser-base64.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_msgpack" class="palette_node ui-draggable" style="background-color: rgb(222, 189, 92); height: 28px;"><div class="palette_label" dir="">msgpack</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red-node-msgpack/parser-msgpack.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_random" class="palette_node ui-draggable" style="background-color: rgb(226, 217, 110); height: 28px;"><div class="palette_label" dir="">random</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/debug.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_rbe" class="palette_node ui-draggable" style="background-color: rgb(226, 217, 110); height: 28px;"><div class="palette_label" dir="">rbe</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red-node-rbe/rbe.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div></div></div></div><div id="palette-container-social" class="palette-category palette-close hide palette-open" style="display: block;"><div id="palette-header-social" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>社交</span></div><div class="palette-content" id="palette-base-category-social" style=""><div id="palette-social-input"><div id="palette_node_e-mail_in" class="palette_node ui-draggable" style="background-color: rgb(199, 233, 192); height: 28px;"><div class="palette_label" dir="">email</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/envelope.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_twitter_in" class="palette_node ui-draggable" style="background-color: rgb(192, 222, 237); height: 28px;"><div class="palette_label" dir="">twitter</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red-node-twitter/twitter.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div></div><div id="palette-social-output"><div id="palette_node_e-mail" class="palette_node ui-draggable" style="background-color: rgb(199, 233, 192); height: 28px;"><div class="palette_label palette_label_right" dir="">email</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/envelope.png&quot;);"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_twitter_out" class="palette_node ui-draggable" style="background-color: rgb(192, 222, 237); height: 28px;"><div class="palette_label palette_label_right" dir="">twitter</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(&quot;icons/node-red-node-twitter/twitter.png&quot;);"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div></div><div id="palette-social-function"></div></div></div><div id="palette-container-mobile" class="palette-category palette-close hide"><div id="palette-header-mobile" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>mobile</span></div><div class="palette-content" id="palette-base-category-mobile"><div id="palette-mobile-input"></div><div id="palette-mobile-output"></div><div id="palette-mobile-function"></div></div></div><div id="palette-container-storage" class="palette-category palette-close hide palette-open" style="display: block;"><div id="palette-header-storage" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>存储</span></div><div class="palette-content" id="palette-base-category-storage" style=""><div id="palette-storage-input"><div id="palette_node_file_in" class="palette_node ui-draggable" style="background-color: burlywood; height: 28px;"><div class="palette_label" dir="">file</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/file-in.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_tail" class="palette_node ui-draggable" style="background-color: burlywood; height: 28px;"><div class="palette_label" dir="">tail</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/file.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div></div><div id="palette-storage-output"><div id="palette_node_file" class="palette_node ui-draggable" style="background-color: burlywood; height: 28px;"><div class="palette_label" dir="">file</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/file-out.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div></div><div id="palette-storage-function"></div></div></div><div id="palette-container-analysis" class="palette-category palette-close hide palette-open" style="display: block;"><div id="palette-header-analysis" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>分析</span></div><div class="palette-content" id="palette-base-category-analysis" style=""><div id="palette-analysis-input"></div><div id="palette-analysis-output"></div><div id="palette-analysis-function"><div id="palette_node_sentiment" class="palette_node ui-draggable" style="background-color: rgb(230, 224, 248); height: 28px;"><div class="palette_label" dir="">sentiment</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/arrow-in.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div></div></div></div><div id="palette-container-advanced" class="palette-category palette-close hide palette-open" style="display: block;"><div id="palette-header-advanced" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>高级</span></div><div class="palette-content" id="palette-base-category-advanced" style=""><div id="palette-advanced-input"><div id="palette_node_watch" class="palette_node ui-draggable" style="background-color: burlywood; height: 28px;"><div class="palette_label" dir="">watch</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/watch.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_feedparse" class="palette_node ui-draggable" style="background-color: rgb(192, 222, 237); height: 28px;"><div class="palette_label" dir="">feedparser</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/feed.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_sunrise" class="palette_node ui-draggable" style="background-color: rgb(255, 204, 102); height: 28px;"><div class="palette_label" dir="">sunrise</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red-node-suncalc/sun.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div></div><div id="palette-advanced-output"></div><div id="palette-advanced-function"><div id="palette_node_exec" class="palette_node ui-draggable" style="background-color: darksalmon; height: 28px;"><div class="palette_label palette_label_right" dir="">exec</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/arrow-in.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div></div></div></div><div id="palette-container-Raspberry_Pi" class="palette-category palette-close hide palette-open" style="display: block;"><div id="palette-header-Raspberry_Pi" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>Raspberry Pi</span></div><div class="palette-content" id="palette-base-category-Raspberry_Pi" style=""><div id="palette-Raspberry_Pi-input"></div><div id="palette-Raspberry_Pi-output"></div><div id="palette-Raspberry_Pi-function"></div><div id="palette-Raspberry_Pi"><div id="palette_node_rpi-gpio_in" class="palette_node ui-draggable" style="background-color: rgb(198, 219, 239); height: 28px;"><div class="palette_label" dir="">rpi gpio</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/rpi.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_rpi-gpio_out" class="palette_node ui-draggable" style="background-color: rgb(198, 219, 239); height: 28px;"><div class="palette_label palette_label_right" dir="">rpi gpio</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/rpi.png&quot;);"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_rpi-mouse" class="palette_node ui-draggable" style="background-color: rgb(198, 219, 239); height: 28px;"><div class="palette_label" dir="">rpi mouse</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/rpi.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_rpi-keyboard" class="palette_node ui-draggable" style="background-color: rgb(198, 219, 239); height: 28px;"><div class="palette_label" dir="">rpi keyboard</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(&quot;icons/node-red/rpi.png&quot;);"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div></div></div></div></div>
        <div id="palette-footer">
            <a class="palette-button" id="palette-collapse-all" href="http://xu7.co:8003/#"><i class="fa fa-angle-double-up"></i></a>
            <a class="palette-button" id="palette-expand-all" href="http://xu7.co:8003/#"><i class="fa fa-angle-double-down"></i></a>
        </div>
        <div id="palette-shade" class="hide" style="display: block;"></div>
    <div class="sidebar-control-left" style="display: none;"><i class="fa fa-chevron-left" <="" div=""></i></div></div><!-- /palette -->
    <div id="sidebar">
        <div class="red-ui-tabs red-ui-tabs-collapsible"><div><ul id="sidebar-tabs"><li class="red-ui-tab red-ui-tab-pinned active" id="red-ui-tab-info" style="width: 201px;"><a href="http://xu7.co:8003/#info" class="red-ui-tab-label" title="信息"><i class="red-ui-tab-icon fa fa-info"></i><span class="bidiAware" dir="">信息</span></a><span class="red-ui-tabs-badges"></span></li><li class="red-ui-tab red-ui-tab-pinned" id="red-ui-tab-config" style="width: 201px;"><a href="http://xu7.co:8003/#config" class="red-ui-tab-label" title="配置"><i class="red-ui-tab-icon fa fa-cog"></i><span class="bidiAware" dir="">配置</span></a><span class="red-ui-tabs-badges"></span></li><li class="red-ui-tab red-ui-tab-pinned" id="red-ui-tab-context" style="width: 201px;"><a href="http://xu7.co:8003/#context" class="red-ui-tab-label" title="context"><i class="red-ui-tab-icon fa fa-database"></i><span class="bidiAware" dir="">context</span></a><span class="red-ui-tabs-badges"></span></li><li class="red-ui-tab red-ui-tab-pinned" id="red-ui-tab-debug" style="width: 201px;"><a href="http://xu7.co:8003/#debug" class="red-ui-tab-label" title="调试窗口"><i class="red-ui-tab-icon fa fa-bug"></i><span class="bidiAware" dir="">调试窗口</span></a><span class="red-ui-tabs-badges"></span></li></ul></div><div class="red-ui-tab-link-buttons"><a href="http://xu7.co:8003/#info" class="red-ui-tab-link-button red-ui-tab-link-button-pinned active selected" id="red-ui-tab-info-link-button"><i class="fa fa-info"></i></a><a href="http://xu7.co:8003/#debug" class="red-ui-tab-link-button red-ui-tab-link-button-pinned" id="red-ui-tab-debug-link-button"><i class="fa fa-bug"></i></a><a href="http://xu7.co:8003/#config" class="red-ui-tab-link-button" id="red-ui-tab-config-link-button" style="display: none;"><i class="fa fa-cog"></i></a><a href="http://xu7.co:8003/#context" class="red-ui-tab-link-button" id="red-ui-tab-context-link-button" style="display: none;"><i class="fa fa-database"></i></a><a href="http://xu7.co:8003/#" class="red-ui-tab-link-button-menu"><i class="fa fa-caret-down"></i></a></div></div>
        <div id="sidebar-content"><div style="height: 100%; display: block;"><div class="sidebar-node-info show-tips"><div class="sidebar-node-info-stack red-ui-stack"><div class="palette-category palette-category-expanded" style=""><div class="palette-header"><i class="fa fa-angle-down expanded"></i><span>信息</span></div><div style="position: relative; display: block;"><div><table class="node-info"><tbody><tr class="node-info-node-row"><td>节点</td><td><span class="debug-message-element debug-message-top-level"><span class="debug-message-row"><span class="debug-message-object-value"><span class="debug-message-type-string debug-message-object-header">"556a8419.17279c"</span></span></span></span></td></tr><tr class="node-info-node-row"><td>姓名</td><td><span class="bidiAware" dir="">format time nicely</span></td></tr><tr class="node-info-node-row"><td>类型</td><td>function</td></tr><tr class="node-info-property-row hide"><td>Module</td><td>node-red</td></tr><tr class="node-info-property-expand node-info-property-row blank hide"><td colspan="2"></td></tr><tr class="node-info-property-row hide"><td>func</td><td><span class="debug-message-element debug-message-top-level collapsed"><span class="debug-message-row debug-message-expandable"><i class="fa fa-caret-right debug-message-object-handle"></i><span class="debug-message-object-value"><span class="debug-message-type-string debug-message-object-header">"msg.payload = Date(msg.payload).toString();↵return msg;"</span></span></span></span></td></tr><tr class="node-info-property-row hide"><td>outputs</td><td><span class="debug-message-element debug-message-top-level"><span class="debug-message-row"><span class="debug-message-object-value"><span class="debug-message-type-number debug-message-type-number-toggle">1</span></span></span></span></td></tr><tr class="node-info-property-row hide"><td>noerr</td><td><span class="debug-message-element debug-message-top-level"><span class="debug-message-row"><span class="debug-message-object-value"><span class="debug-message-type-number debug-message-type-number-toggle">0</span></span></span></span></td></tr><tr class="node-info-property-expand blank"><td colspan="2"><a href="http://xu7.co:8003/#" class=" node-info-property-header"><span class="node-info-property-show-more">展开</span><span class="node-info-property-show-less">收起</span> <i class="fa fa-caret-down"></i></a></td></tr></tbody></table></div></div></div><div class="palette-category palette-category-expanded" style="display: block;"><div class="palette-header"><i class="fa fa-angle-down expanded"></i><span>Description</span></div><div style="position: relative; display: block;"><div style="padding: 6px;"><div class="node-help"><span class="bidiAware" dir=""></span></div></div></div></div><div class="palette-category palette-category-expanded" style="display: block;"><div class="palette-header"><i class="fa fa-angle-down expanded"></i><span>节点帮助</span></div><div style="position: relative; display: block;"><div style="padding: 6px;"><div class="node-help"><span class="bidiAware" dir="">
    <p>A JavaScript function block to run against the messages being received by the node.</p>
    <p>The messages are passed in as a JavaScript object called <code>msg</code>.</p>
    <p>By convention it will have a <code>msg.payload</code> property containing
       the body of the message.</p>
    <p>The function is expected to return a message object (or multiple message objects), but can choose
       to return nothing in order to halt a flow.</p>
    <h3><a class="node-info-header expanded" href="http://xu7.co:8003/#"><i class="fa fa-angle-right"></i>Details</a></h3>
    <p>See the <a target="_blank" href="http://nodered.org/docs/writing-functions.html">online documentation</a>
    for more information on writing functions.</p>
    <h4>Sending messages</h4>
    <p>The function can either return the messages it wants to pass on to the next nodes
    in the flow, or can call <code>node.send(messages)</code>.</p>
    <p>It can return/send:</p>
    <ul>
      <li>a single message object - passed to nodes connected to the first output</li>
      <li>an array of message objects - passed to nodes connected to the corresponding outputs</li>
    </ul>
    <p>If any element of the array is itself an array of messages, multiple
          messages are sent to the corresponding output.</p>
    <p>If null is returned, either by itself or as an element of the array, no
          message is passed on.</p>
    <h4>Logging and Error Handling</h4>
    <p>To log any information, or report an error, the following functions are available:</p>
      <ul>
          <li><code>node.log("Log message")</code></li>
          <li><code>node.warn("Warning")</code></li>
          <li><code>node.error("Error")</code></li>
      </ul>
    <p></p>
    <p>The Catch node can also be used to handle errors. To invoke a Catch node,
    pass <code>msg</code> as a second argument to <code>node.error</code>:</p>
    <pre>node.error("Error",msg);</pre>
    <h4>Accessing Node Information</h4>
    <p>In the function block, id and name of the node can be referenced using the following properties:</p>
    <ul>
        <li><code>node.id</code> - id of the node</li>
        <li><code>node.name</code> - name of the node</li>
    </ul>
    <h4>Using environment variables</h4>
    <p>Environment variables can be accessed using <code>env.get("MY_ENV_VAR")</code>.</p>
</span></div></div></div></div></div><div class="node-info-tips"><div class="node-info-tip" style="display: inline-block;">您可以在 <span class="help-key-block"><span class="help-key">⌘⇧p</span></span> 中管理节点的控制面板。</div><div class="node-info-tips-buttons"><a href="http://xu7.co:8003/#" class="workspace-footer-button"><i class="fa fa-refresh"></i></a><a href="http://xu7.co:8003/#" class="workspace-footer-button"><i class="fa fa-times"></i></a></div></div></div></div><div style="height: 100%; display: none;"><div class="sidebar-node-config" id="sidebar-node-config" tabindex="0"><div class="sidebar-header"><span class="button-group"><a class="sidebar-header-button-toggle selected" id="workspace-config-node-filter-all" href="http://xu7.co:8003/#"><span data-i18n="sidebar.config.filterAll">所有</span></a><a class="sidebar-header-button-toggle" id="workspace-config-node-filter-unused" href="http://xu7.co:8003/#"><span data-i18n="sidebar.config.filterUnused">未使用</span></a> </span></div><div><div class="palette-category workspace-config-node-category" id="workspace-config-node-category-global"><div class="workspace-config-node-tray-header palette-header"><i class="fa fa-angle-down expanded"></i><span class="config-node-label" data-i18n="sidebar.config.global">所有流程</span><span class="config-node-filter-info" style="display: none;"></span></div><ul class="palette-content config-node-list" style="display: block;"><li class="config_node_type">mqtt-broker</li><li class="palette_node config_node palette_node_id_a1b300cb-0e9fb config_node_unused"><div class="palette_label">47.100.237.250</div><div class="palette_icon_container palette_icon_container_right">0</div></li><li class="config_node_type">websocket-client</li><li class="palette_node config_node palette_node_id_4f479a7f-28fcf4 config_node_unused"><div class="palette_label">xu7.co:8003/ws/test</div><div class="palette_icon_container palette_icon_container_right">0</div></li><li class="config_node_type">websocket-listener</li><li class="palette_node config_node palette_node_id_bb68a65a-7179b8"><div class="palette_label">/ws/v2x</div><div class="palette_icon_container palette_icon_container_right"><a href="http://xu7.co:8003/#">2</a></div></li></ul></div></div><div><div class="palette-category workspace-config-node-category" id="workspace-config-node-category-8beb964b-c21ac8"><div class="workspace-config-node-tray-header palette-header"><i class="fa fa-angle-down expanded"></i><span class="config-node-label">流程1</span><span class="config-node-filter-info" style="display: none;"></span></div><ul class="palette-content config-node-list" style="display: block;"><li class="config_node_type">websocket-listener</li><li class="palette_node config_node palette_node_id_835e5b5d-36be98"><div class="palette_label">/ws/simple</div><div class="palette_icon_container palette_icon_container_right"><a href="http://xu7.co:8003/#">2</a></div></li></ul></div><div class="palette-category workspace-config-node-category" id="workspace-config-node-category-3bf62ee6-30e682"><div class="workspace-config-node-tray-header palette-header"><i class="fa fa-angle-down"></i><span class="config-node-label">v2x</span><span class="config-node-filter-info" style="display: none;"></span></div><ul class="palette-content config-node-list" style="display: none;"><li class="config_node_none" data-i18n="sidebar.config.none">无</li></ul></div></div><div></div></div><div class="sidebar-shade hide" style="display: block;"></div></div><div style="height: 100%; display: none;"><div style="position: relative; height: 100%;"><div class="sidebar-context-stack red-ui-stack"><div class="palette-category palette-category-expanded"><div class="palette-header"><i class="fa fa-angle-down expanded"></i><span>Node</span><div style="float: right"><button class="editor-button editor-button-small"><i class="fa fa-refresh"></i></button></div></div><div style="position: relative; display: block;"><div style="height: 100%;"><div class="sidebar-context-updated">&nbsp;</div><table class="node-info"><tbody><tr class="node-info-node-row red-ui-search-empty blank" colspan="2"><td data-i18n="sidebar.context.refresh">refresh to load</td></tr></tbody></table></div></div></div><div class="palette-category palette-category-expanded"><div class="palette-header"><i class="fa fa-angle-down expanded"></i><span>Flow</span><div style="float: right"><button class="editor-button editor-button-small"><i class="fa fa-refresh"></i></button></div></div><div style="position: relative; display: block;"><div style="height: 100%;"><div class="sidebar-context-updated">2019/8/29 下午10:25:57</div><table class="node-info"><tbody><tr class="node-info-node-row red-ui-search-empty blank" colspan="2"><td data-i18n="sidebar.context.empty">empty</td></tr></tbody></table></div></div></div><div class="palette-category palette-category-expanded"><div class="palette-header"><i class="fa fa-angle-down expanded"></i><span>Global</span><div style="float: right"><button class="editor-button editor-button-small"><i class="fa fa-refresh"></i></button></div></div><div style="position: relative; display: block;"><div style="height: 100%;"><div class="sidebar-context-updated">2019/8/29 下午9:50:27</div><table class="node-info"><tbody><tr class="node-info-node-row red-ui-search-empty blank" colspan="2"><td data-i18n="sidebar.context.empty">empty</td></tr></tbody></table></div></div></div></div></div></div><div style="height: 100%; display: none;"><div style="position: relative; height: 100%;"><div class="sidebar-header"><span class="button-group"><a id="debug-tab-filter" class="sidebar-header-button" href="http://xu7.co:8003/#"><i class="fa fa-filter"></i> <span>所有节点</span></a></span><span class="button-group"><a id="debug-tab-clear" class="sidebar-header-button" href="http://xu7.co:8003/#" data-i18n="[title]node-red:debug.sidebar.clearLog" title="清空日志"><i class="fa fa-trash"></i></a></span><div class="debug-filter-box hide"><div class="debug-filter-row"><span class="button-group"><a class="sidebar-header-button-toggle debug-tab-filter-option selected" id="debug-tab-filterAll" href="http://xu7.co:8003/#"><span data-i18n="node-red:debug.sidebar.filterAll">所有节点</span></a><a class="sidebar-header-button-toggle debug-tab-filter-option" id="debug-tab-filterSelected" href="http://xu7.co:8003/#"><span data-i18n="node-red:debug.sidebar.filterSelected">已选节点</span></a><a class="sidebar-header-button-toggle debug-tab-filter-option" id="debug-tab-filterCurrent" href="http://xu7.co:8003/#"><span data-i18n="node-red:debug.sidebar.filterCurrent">当前流程</span></a> </span></div><div class="debug-filter-row hide" id="debug-filter-node-list-row"><div class="red-ui-editableList red-ui-nodeList"><div class="red-ui-editableList-border"><div class="red-ui-editableList-header"><span data-i18n="node-red:debug.sidebar.debugNodes">调试节点</span><span><span class="red-ui-checkboxSet"><input type="checkbox"><span class="red-ui-checkboxSet-option hide" style="display: inline;"><i class="fa fa-square-o"></i></span><span class="red-ui-checkboxSet-option hide"><i class="fa fa-check-square-o"></i></span><span class="red-ui-checkboxSet-option hide"><i class="fa fa-minus-square-o"></i></span></span></span></div><div class="red-ui-editableList-container" style="min-height: 250px; max-height: 250px; overflow-y: scroll;"><ol style="text-align: left; min-height: 0px; max-height: 250px; height: auto;" class="red-ui-editableList-list"></ol></div></div></div></div></div></div><div class="debug-content debug-content-list"></div><div class="debug-content  debug-content-table hide"></div></div></div></div>
        <div id="sidebar-footer"><div style="display: none;"><a class="sidebar-footer-button" id="workspace-config-node-collapse-all" href="http://xu7.co:8003/#"><i class="fa fa-angle-double-up"></i></a> <a class="sidebar-footer-button" id="workspace-config-node-expand-all" href="http://xu7.co:8003/#"><i class="fa fa-angle-double-down"></i></a></div><div style="display: none;"></div><div style="display: none;"><span class="button-group"><a id="debug-tab-open" class="sidebar-footer-button" href="http://xu7.co:8003/#" data-i18n="[title]node-red:debug.sidebar.openWindow" title="在新窗口打开"><i class="fa fa-desktop"></i></a></span> </div></div>
        <div id="sidebar-shade" class="hide" style="display: none;"></div>
    </div>

    <div id="sidebar-separator" class="ui-draggable"><div class="sidebar-control-right" style="display: none;"><i class="fa fa-chevron-right" <="" div=""></i></div></div>

</div>
<div id="full-shade" class="hide"></div>

<div id="notifications"></div>
<div id="dropTarget"><div data-i18n="[append]workspace.dropFlowHere"><br><i class="fa fa-download"></i>把流程放到这里</div></div>

<script src="./Node-RED _ xu7.co_files/vendor.js"></script>
<script src="./Node-RED _ xu7.co_files/jsonata.min.js"></script>
<script src="./Node-RED _ xu7.co_files/ace.js"></script>
<script src="./Node-RED _ xu7.co_files/ext-language_tools.js"></script>
<script src="./Node-RED _ xu7.co_files/red.min.js"></script><script type="text/x-red" data-template-name="_buffer"><div id="node-input-buffer-panels"><div id="node-input-buffer-panel-str" class="red-ui-panel"><div class="form-row" style="margin-bottom: 3px; text-align: right;"><span class="node-input-buffer-type"><i class="fa fa-exclamation-circle"></i> <span id="node-input-buffer-type-string" data-i18n="bufferEditor.modeString"></span><span id="node-input-buffer-type-array" data-i18n="bufferEditor.modeArray"></span></span></div><div class="form-row node-text-editor-row"><div class="node-text-editor" id="node-input-buffer-str"></div></div></div><div id="node-input-buffer-panel-bin" class="red-ui-panel"><div class="form-row node-text-editor-row" style="margin-top: 10px"><div class="node-text-editor" id="node-input-buffer-bin"></div></div></div></div></script><script type="text/x-red" data-template-name="_expression"><div id="node-input-expression-panels"><div id="node-input-expression-panel-expr" class="red-ui-panel"><div class="form-row" style="margin-bottom: 3px; text-align: right;"><span class="node-input-expression-legacy"><i class="fa fa-exclamation-circle"></i> <span data-i18n="expressionEditor.compatMode"></span></span><button id="node-input-expression-reformat" class="editor-button editor-button-small"><span data-i18n="expressionEditor.format"></span></button></div><div class="form-row node-text-editor-row"><div class="node-text-editor" id="node-input-expression"></div></div></div><div id="node-input-expression-panel-info" class="red-ui-panel"><div class="form-row"><ul id="node-input-expression-tabs"></ul><div id="node-input-expression-tab-help" class="node-input-expression-tab-content hide"><div><select id="node-input-expression-func"></select><button id="node-input-expression-func-insert" class="editor-button" data-i18n="expressionEditor.insert"></button></div><div id="node-input-expression-help"></div></div><div id="node-input-expression-tab-test" class="node-input-expression-tab-content hide"><div><span style="display: inline-block; width: calc(50% - 5px);"><span data-i18n="expressionEditor.data"></span><button style="float: right; margin-right: 5px;" id="node-input-example-reformat" class="editor-button editor-button-small"><span data-i18n="jsonEditor.format"></span></button></span><span style="display: inline-block; width: calc(50% - 5px);" data-i18n="expressionEditor.result"></span></div><div style="display: inline-block; width: calc(50% - 5px);" class="node-text-editor" id="node-input-expression-test-data"></div><div style="display: inline-block; width: calc(50% - 5px);" class="node-text-editor" id="node-input-expression-test-result"></div></div></div></div></div></script><script type="text/x-red" data-template-name="_js"><div class="form-row node-text-editor-row"><div style="height: 200px;min-height: 150px;" class="node-text-editor" id="node-input-js"></div></div></script><script type="text/x-red" data-template-name="_json"><div class="form-row" style="margin-bottom: 3px; text-align: right;"><button id="node-input-json-reformat" class="editor-button editor-button-small"><span data-i18n="jsonEditor.format"></span></button></div><div class="form-row node-text-editor-row"><div style="height: 200px;min-height: 150px;" class="node-text-editor" id="node-input-json"></div></div></script><script type="text/x-red" data-template-name="_markdown"><div id="node-input-markdown-panels"><div id="node-input-markdown-panel-editor" class="red-ui-panel"><div style="height: 100%; margin: auto; max-width: 1000px;"><div id="node-input-markdown-toolbar"></div><div class="node-text-editor" style="height: 100%" id="node-input-markdown"></div></div></div><div class="red-ui-panel"><div class="node-input-markdown-panel-preview node-help"></div></div></script>
<script src="./Node-RED _ xu7.co_files/main.min.js"></script>



<div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-front ui-dialog-buttons ui-draggable" tabindex="-1" role="dialog" aria-describedby="library-dialog" aria-labelledby="ui-id-1" style="display: none;"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span id="ui-id-1" class="ui-dialog-title">将节点导出到库</span><button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only ui-dialog-titlebar-close" role="button" aria-disabled="false" title="close"><span class="ui-button-icon-primary ui-icon ui-icon-closethick"></span><span class="ui-button-text">close</span></button></div><div id="library-dialog" class="hide ui-dialog-content ui-widget-content" style="display: block;"><form class="dialog-form form-horizontal"><div class="form-row"><label for="node-input-library-filename" data-i18n="[append]editor:library.filename"><i class="fa fa-file"></i> 文件名</label><input type="text" id="node-input-library-filename" data-i18n="[placeholder]editor:library.fullFilenamePlaceholder" placeholder="a/b/文件"><input type="text" style="display: none;"></div></form></div><div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"><div class="ui-dialog-buttonset"><button type="button" id="library-dialog-cancel" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">取消</span></button><button type="button" id="library-dialog-ok" class="primary ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">导出</span></button></div></div></div><script type="text/x-red" data-template-name="_eventLog"><div class="form-row node-text-editor-row"><div style="height: 100%;min-height: 150px;" class="node-text-editor" id="event-log-editor"></div></div></script><script type="text/x-red" data-template-name="subflow"><div class="form-row"><label for="node-input-name" data-i18n="[append]editor:common.label.name"><i class="fa fa-tag"></i> </label><input type="text" id="node-input-name"></div><div class="form-row" style="margin-bottom: 0px;"><label style="width: auto;" data-i18n="[append]editor:editor-tab.env"><i class="fa fa-th-list"></i> </label></div><div class="form-row node-input-env-container-row"><ol id="node-input-env-container"></ol></div></script><script type="text/x-red" data-template-name="subflow-template"><div class="form-row"><i class="fa fa-tag"></i> <label for="subflow-input-name" data-i18n="common.label.name"></label><input type="text" id="subflow-input-name"></div><div class="form-row"><i class="fa fa-folder-o"></i> <label for="subflow-input-category" data-i18n="editor:subflow.category"></label><select style="width: 250px;" id="subflow-input-category"></select><input style="display:none; margin-left: 10px; width:calc(100% - 250px)" type="text" id="subflow-input-custom-category"></div><div class="form-row" style="margin-bottom: 0px;"><label style="width: auto;" data-i18n="[append]editor:editor-tab.env"><i class="fa fa-th-list"></i> </label></div><div class="form-row node-input-env-container-row"><ol id="node-input-env-container"></ol></div><div class="form-row form-tips" id="subflow-dialog-user-count"></div></script><div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-front ui-dialog-buttons ui-draggable" tabindex="-1" role="dialog" aria-describedby="clipboard-dialog" aria-labelledby="ui-id-2" style="display: none;"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span id="ui-id-2" class="ui-dialog-title">&nbsp;</span><button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only ui-dialog-titlebar-close" role="button" aria-disabled="false" title="close"><span class="ui-button-icon-primary ui-icon ui-icon-closethick"></span><span class="ui-button-text">close</span></button></div><div id="clipboard-dialog" class="hide node-red-dialog ui-dialog-content ui-widget-content" style="display: block;"><form class="dialog-form form-horizontal"></form></div><div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"><div class="ui-dialog-buttonset"><button type="button" id="clipboard-dialog-cancel" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">取消</span></button><button type="button" id="clipboard-dialog-close" class="primary ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">关闭</span></button><button type="button" id="clipboard-dialog-download" class="primary ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">Download</span></button><button type="button" id="clipboard-dialog-copy" class="primary ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">导出到剪贴板</span></button><button type="button" id="clipboard-dialog-ok" class="primary ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">导入</span></button></div></div></div><input type="text" id="clipboard-hidden"><div><!-- --- [red-module:node-red/inject] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="inject">
    <div class="form-row">
        <label for="node-input-payload"><i class="fa fa-envelope"></i> <span data-i18n="common.label.payload"></span></label>
        <input type="text" id="node-input-payload" style="width:70%">
        <input type="hidden" id="node-input-payloadType">
    </div>

    <div class="form-row">
        <label for="node-input-topic"><i class="fa fa-tasks"></i> <span data-i18n="common.label.topic"></span></label>
        <input type="text" id="node-input-topic">
    </div>

    <div class="form-row" id="node-once">
        <label for="node-input-once">&nbsp;</label>
        <input type="checkbox" id="node-input-once" style="display:inline-block; width:15px; vertical-align:baseline;">
        <span data-i18n="inject.onstart"></span>&nbsp;
        <input type="text" id="node-input-onceDelay" placeholder="0.1" style="width:45px; height:28px;">&nbsp;
        <span data-i18n="inject.onceDelay"></span>
    </div>

    <div class="form-row">
        <label for=""><i class="fa fa-repeat"></i> <span data-i18n="inject.label.repeat"></span></label>
        <select id="inject-time-type-select">
            <option value="none" data-i18n="inject.none"></option>
            <option value="interval" data-i18n="inject.interval"></option>
            <option value="interval-time" data-i18n="inject.interval-time"></option>
            <option value="time" data-i18n="inject.time"></option>
        </select>
        <input type="hidden" id="node-input-repeat">
        <input type="hidden" id="node-input-crontab">
    </div>

    <div class="form-row inject-time-row hidden" id="inject-time-row-interval">
        <span data-i18n="inject.every"></span>
        <input id="inject-time-interval-count" class="inject-time-count" value="1"></input>
        <select style="width:100px" id="inject-time-interval-units">
            <option value="s" data-i18n="inject.seconds"></option>
            <option value="m" data-i18n="inject.minutes"></option>
            <option value="h" data-i18n="inject.hours"></option>
        </select><br/>
    </div>

    <div class="form-row inject-time-row hidden" id="inject-time-row-interval-time">
        <span data-i18n="inject.every"></span> <select style="width:90px; margin-left:20px;" id="inject-time-interval-time-units" class="inject-time-int-count" value="1">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="10">10</option>
            <option value="12">12</option>
            <option value="15">15</option>
            <option value="20">20</option>
            <option value="30">30</option>
            <option value="0">60</option>
        </select> <span data-i18n="inject.minutes"></span><br/>
        <span data-i18n="inject.between"></span> <select id="inject-time-interval-time-start" class="inject-time-times"></select>
        <span data-i18n="inject.and"></span> <select id="inject-time-interval-time-end" class="inject-time-times"></select><br/>
        <div id="inject-time-interval-time-days" class="inject-time-days" style="margin-top:5px">
            <div style="display:inline-block; vertical-align:top; margin-right:5px;" data-i18n="inject.on">on</div>
            <div style="display:inline-block;">
                <div>
                    <label><input type='checkbox' checked value='1'/> <span data-i18n="inject.days.0"></span></label>
                    <label><input type='checkbox' checked value='2'/> <span data-i18n="inject.days.1"></span></label>
                    <label><input type='checkbox' checked value='3'/> <span data-i18n="inject.days.2"></span></label>
                </div>
                <div>
                    <label><input type='checkbox' checked value='4'/> <span data-i18n="inject.days.3"></span></label>
                    <label><input type='checkbox' checked value='5'/> <span data-i18n="inject.days.4"></span></label>
                    <label><input type='checkbox' checked value='6'/> <span data-i18n="inject.days.5"></span></label>
                </div>
                <div>
                    <label><input type='checkbox' checked value='0'/> <span data-i18n="inject.days.6"></span></label>
                </div>
            </div>
        </div>
    </div>

    <div class="form-row inject-time-row hidden" id="inject-time-row-time">
        <span data-i18n="inject.at"></span> <input type="text" id="inject-time-time" value="12:00"></input><br/>
        <div id="inject-time-time-days" class="inject-time-days">
            <div style="display:inline-block; vertical-align:top; margin-right:5px;" data-i18n="inject.on"></div>
            <div style="display:inline-block;">
                <div>
                    <label><input type='checkbox' checked value='1'/> <span data-i18n="inject.days.0"></span></label>
                    <label><input type='checkbox' checked value='2'/> <span data-i18n="inject.days.1"></span></label>
                    <label><input type='checkbox' checked value='3'/> <span data-i18n="inject.days.2"></span></label>
                </div>
                <div>
                    <label><input type='checkbox' checked value='4'/> <span data-i18n="inject.days.3"></span></label>
                    <label><input type='checkbox' checked value='5'/> <span data-i18n="inject.days.4"></span></label>
                    <label><input type='checkbox' checked value='6'/> <span data-i18n="inject.days.5"></span></label>
                </div>
                <div>
                    <label><input type='checkbox' checked value='0'/> <span data-i18n="inject.days.6"></span></label>
                </div>
            </div>
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>

    <div class="form-tips" data-i18n="[html]inject.tip"></div>
</script>
<style>
    .inject-time-row {
        padding-left: 110px;
    }
    .inject-time-row select {
        margin: 3px 0;
    }
    .inject-time-days label {
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        vertical-align: baseline;
        width: 100px;
    }
    .inject-time-days input {
        width: auto;
        vertical-align: baseline;
    }
    .inject-time-times {
        width: 90px;
    }
    #inject-time-time {
        width: 75px;
        margin-left: 8px;
        margin-bottom: 8px;
    }
    .inject-time-count {
        width: 40px !important;
    }
</style>

<script type="text/javascript">
    RED.nodes.registerType('inject',{
        category: 'input',
        color:"#a6bbcf",
        defaults: {
            name: {value:""},
            topic: {value:""},
            payload: {value:"", validate: RED.validators.typedInput("payloadType")},
            payloadType: {value:"date"},
            repeat: {value:"", validate:function(v) { return ((v === "") || (RED.validators.number(v) && (v >= 0) && (v <= 2147483))) }},
            crontab: {value:""},
            once: {value:false},
            onceDelay: {value:0.1}
        },
        icon: "inject.png",
        inputs:0,
        outputs:1,
        outputLabels: function(index) {
            var lab = this.payloadType;
            if (lab === "json") {
                try {
                    lab = typeof JSON.parse(this.payload);
                    if (lab === "object") {
                        if (Array.isArray(JSON.parse(this.payload))) { lab = "Array"; }
                    }
                } catch(e) {
                    return this._("inject.label.invalid"); }
            }
            var name = "inject.label."+lab;
            var label = this._(name);
            if (name !== label) {
                return label;
            }
            return lab;
        },
        label: function() {
            var suffix = "";
            // if fire once then add small indication
            if (this.once) {
                suffix = " ¹";
            }
            // but replace with repeat one if set to repeat
            if ((this.repeat && this.repeat != 0) || this.crontab) {
                suffix = " ↻";
            }
            if (this.name) {
                return this.name+suffix;
            } else if (this.payloadType === "string" ||
                    this.payloadType === "str" ||
                    this.payloadType === "num" ||
                    this.payloadType === "bool" ||
                    this.payloadType === "json") {
                if ((this.topic !== "") && ((this.topic.length + this.payload.length) <= 32)) {
                    return this.topic + ":" + this.payload+suffix;
                } else if (this.payload.length > 0 && this.payload.length < 24) {
                    return this.payload+suffix;
                } else {
                    return this._("inject.inject")+suffix;
                }
            } else if (this.payloadType === 'date') {
                if ((this.topic !== "") && (this.topic.length <= 16)) {
                    return this.topic + ":" + this._("inject.timestamp")+suffix;
                } else {
                    return this._("inject.timestamp")+suffix;
                }
            } else if (this.payloadType === 'flow' || this.payloadType === 'global') {
                var key = RED.utils.parseContextKey(this.payload);
                return this.payloadType+"."+key.key+suffix;
            } else {
                return this._("inject.inject")+suffix;
            }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (this.payloadType == null) {
                if (this.payload == "") {
                    this.payloadType = "date";
                } else {
                    this.payloadType = "str";
                }
            } else if (this.payloadType === 'string' || this.payloadType === 'none') {
                this.payloadType = "str";
            }
            $("#node-input-payloadType").val(this.payloadType);

            $("#node-input-payload").typedInput({
                default: 'str',
                typeField: $("#node-input-payloadType"),
                types:['flow','global','str','num','bool','json','bin','date','env']
            });

            $("#inject-time-type-select").change(function() {
                $("#node-input-crontab").val('');
                var id = $("#inject-time-type-select").val();
                $(".inject-time-row").hide();
                $("#inject-time-row-"+id).show();
                if ((id == "none") || (id == "interval") || (id == "interval-time")) {
                    $("#node-once").show();
                }
                else {
                    $("#node-once").hide();
                    $("#node-input-once").prop('checked', false);
                }
            });

            $("#node-input-once").change(function() {
                $("#node-input-onceDelay").attr('disabled', !$("#node-input-once").prop('checked'));
            })

            $(".inject-time-times").each(function() {
                for (var i=0; i<24; i++) {
                    var l = (i<10?"0":"")+i+":00";
                    $(this).append($("<option></option>").val(i).text(l));
                }
            });
            $("<option></option>").val(24).text("00:00").appendTo("#inject-time-interval-time-end");
            $("#inject-time-interval-time-start").change(function() {
                var start = Number($("#inject-time-interval-time-start").val());
                var end = Number($("#inject-time-interval-time-end").val());
                $("#inject-time-interval-time-end option").remove();
                for (var i=start+1; i<25; i++) {
                    var l = (i<10?"0":"")+i+":00";
                    if (i==24) {
                        l = "00:00";
                    }
                    var opt = $("<option></option>").val(i).text(l).appendTo("#inject-time-interval-time-end");
                    if (i === end) {
                        opt.attr("selected","selected");
                    }
                }
            });

            $(".inject-time-count").spinner({
                //max:60,
                min:1
            });

            var repeattype = "none";
            if (this.repeat != "" && this.repeat != 0) {
                repeattype = "interval";
                var r = "s";
                var c = this.repeat;
                if (this.repeat % 60 === 0) { r = "m"; c = c/60; }
                if (this.repeat % 1440 === 0) { r = "h"; c = c/60; }
                $("#inject-time-interval-count").val(c);
                $("#inject-time-interval-units").val(r);
                $("#inject-time-interval-days").prop("disabled","disabled");
            } else if (this.crontab) {
                var cronparts = this.crontab.split(" ");
                var days = cronparts[4];
                if (!isNaN(cronparts[0]) && !isNaN(cronparts[1])) {
                    repeattype = "time";
                    // Fixed time
                    var time = cronparts[1]+":"+cronparts[0];
                    $("#inject-time-time").val(time);
                    $("#inject-time-type-select").val("s");
                    if (days == "*") {
                        $("#inject-time-time-days input[type=checkbox]").prop("checked",true);
                    } else {
                        $("#inject-time-time-days input[type=checkbox]").removeAttr("checked");
                        days.split(",").forEach(function(v) {
                            $("#inject-time-time-days [value=" + v + "]").prop("checked", true);
                        });
                    }
                } else {
                    repeattype = "interval-time";
                    // interval - time period
                    var minutes = cronparts[0].slice(2);
                    if (minutes === "") { minutes = "0"; }
                    $("#inject-time-interval-time-units").val(minutes);
                    if (days == "*") {
                        $("#inject-time-interval-time-days input[type=checkbox]").prop("checked",true);
                    } else {
                        $("#inject-time-interval-time-days input[type=checkbox]").removeAttr("checked");
                        days.split(",").forEach(function(v) {
                            $("#inject-time-interval-time-days [value=" + v + "]").prop("checked", true);
                        });
                    }
                    var time = cronparts[1];
                    var timeparts = time.split(",");
                    var start;
                    var end;
                    if (timeparts.length == 1) {
                        // 0 or 0-10
                        var hours = timeparts[0].split("-");
                        if (hours.length == 1) {
                            if (hours[0] === "") {
                                start = "0";
                                end = "0";
                            }
                            else {
                                start = hours[0];
                                end = Number(hours[0])+1;
                            }
                        } else {
                            start = hours[0];
                            end = Number(hours[1])+1;
                        }
                    } else {
                        // 23,0 or 17-23,0-10 or 23,0-2 or 17-23,0
                        var startparts = timeparts[0].split("-");
                        start = startparts[0];

                        var endparts = timeparts[1].split("-");
                        if (endparts.length == 1) {
                            end = Number(endparts[0])+1;
                        } else {
                            end = Number(endparts[1])+1;
                        }
                    }
                    $("#inject-time-interval-time-end").val(end);
                    $("#inject-time-interval-time-start").val(start);

                }
            } else {
                $("#inject-time-type-select").val("none");
            }

            $(".inject-time-row").hide();
            $("#inject-time-type-select").val(repeattype);
            $("#inject-time-row-"+repeattype).show();

            $("#node-input-payload").typedInput('type',this.payloadType);

            $("#inject-time-type-select").change();
            $("#inject-time-interval-time-start").change();

        },
        oneditsave: function() {
            var repeat = "";
            var crontab = "";
            var type = $("#inject-time-type-select").val();
            if (type == "none") {
                // nothing
            } else if (type == "interval") {
                var count = $("#inject-time-interval-count").val();
                var units = $("#inject-time-interval-units").val();
                if (units == "s") {
                    repeat = count;
                } else {
                    if (units == "m") {
                        //crontab = "*/"+count+" * * * "+days;
                        repeat = count * 60;
                    } else if (units == "h") {
                        //crontab = "0 */"+count+" * * "+days;
                        repeat = count * 60 * 60;
                    }
                }
            } else if (type == "interval-time") {
                repeat = "";
                var count = $("#inject-time-interval-time-units").val();
                var startTime = Number($("#inject-time-interval-time-start").val());
                var endTime = Number($("#inject-time-interval-time-end").val());
                var days = $('#inject-time-interval-time-days input[type=checkbox]:checked').map(function(_, el) {
                    return $(el).val()
                }).get();
                if (days.length == 0) {
                    crontab = "";
                } else {
                    if (days.length == 7) {
                        days="*";
                    } else {
                        days = days.join(",");
                    }
                    var timerange = "";
                    if (endTime == 0) {
                        timerange = startTime+"-23";
                    } else if (startTime+1 < endTime) {
                        timerange = startTime+"-"+(endTime-1);
                    } else if (startTime+1 == endTime) {
                        timerange = startTime;
                    } else {
                        var startpart = "";
                        var endpart = "";
                        if (startTime == 23) {
                            startpart = "23";
                        } else {
                            startpart = startTime+"-23";
                        }
                        if (endTime == 1) {
                            endpart = "0";
                        } else {
                            endpart = "0-"+(endTime-1);
                        }
                        timerange = startpart+","+endpart;
                    }
                    if (count === "0") {
                        crontab = count+" "+timerange+" * * "+days;
                    } else {
                        crontab = "*/"+count+" "+timerange+" * * "+days;
                    }
                }
            } else if (type == "time") {
                var time = $("#inject-time-time").val();
                var days = $('#inject-time-time-days  input[type=checkbox]:checked').map(function(_, el) {
                    return $(el).val()
                }).get();
                if (days.length == 0) {
                    crontab = "";
                } else {
                    if (days.length == 7) {
                        days="*";
                    } else {
                        days = days.join(",");
                    }
                    var parts = time.split(":");
                    if (parts.length === 2) {
                        repeat = "";
                        parts[1] = ("00" + (parseInt(parts[1]) % 60)).substr(-2);
                        parts[0] = ("00" + (parseInt(parts[0]) % 24)).substr(-2);
                        crontab = parts[1]+" "+parts[0]+" * * "+days;
                    }
                    else { crontab = ""; }
                }
            }

            $("#node-input-repeat").val(repeat);
            $("#node-input-crontab").val(crontab);
        },
        button: {
            enabled: function() {
                return !this.changed
            },
            onclick: function() {
                if (this.changed) {
                    return RED.notify(RED._("notification.warning", {message:RED._("notification.warnings.undeployedChanges")}),"warning");
                }
                var payload = this.payload;
                if ((this.payloadType === 'flow') ||
                    (this.payloadType === 'global')) {
                    var key = RED.utils.parseContextKey(payload);
                    payload = this.payloadType+"."+key.key;
                }
                var label = this._def.label.call(this);
                if (label.length > 30) {
                    label = label.substring(0,50)+"...";
                }
                label = label.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");
                var node = this;
                $.ajax({
                    url: "inject/"+this.id,
                    type:"POST",
                    success: function(resp) {
                        RED.notify(node._("inject.success",{label:label}),{type:"success",id:"inject"});
                    },
                    error: function(jqXHR,textStatus,errorThrown) {
                        if (jqXHR.status == 404) {
                            RED.notify(node._("common.notification.error",{message:node._("common.notification.errors.not-deployed")}),"error");
                        } else if (jqXHR.status == 500) {
                            RED.notify(node._("common.notification.error",{message:node._("inject.errors.failed")}),"error");
                        } else if (jqXHR.status == 0) {
                            RED.notify(node._("common.notification.error",{message:node._("common.notification.errors.no-response")}),"error");
                        } else {
                            RED.notify(node._("common.notification.error",{message:node._("common.notification.errors.unexpected",{status:jqXHR.status,message:textStatus})}),"error");
                        }
                    }
                });
            }
        }
    });

</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="inject">
<p>Injects a message into a flow either manually or at regular intervals. The message
payload can be a variety of types, including strings, JavaScript objects or the current time.</p>
<h3>Outputs</h3>
<dl class="message-properties">
    <dt>payload<span class="property-type">various</span></dt>
    <dd>The configured payload of the message.</dd>
    <dt class="optional">topic <span class="property-type">string</span></dt>
    <dd>An optional property that can be configured in the node.</dd>
</dl>
<h3>Details</h3>
<p>The Inject node can initiate a flow with a specific payload value.
The default payload is a timestamp of the current time in millisecs since January 1st, 1970.</p>
<p>The node also supports injecting strings, numbers, booleans, JavaScript objects, or flow/global context values.</p>
<p>By default, the node is triggered manually by clicking on its button within the editor. It can also be set to
inject at regular intervals or according to a schedule.</p>
<p>It can also be configured to inject once each time the flows are started.</p>
<p>The maximum <i>Interval</i> that can be specified is about 596 hours / 24 days. However if you are looking at intervals
greater than one day you should consider using a scheduler node that can cope with power outages and restarts.</p>
<p><b>Note</b>: The <i>"Interval between times"</i> and <i>"at a specific time"</i> options use the standard cron system.
This means that 20 minutes will be at the next hour, 20 minutes past and 40 minutes past - not in 20 minutes time.
If you want every 20 minutes from now - use the <i>"interval"</i> option.</p>
<p><b>Note</b>: To include a newline in a string you must use a Function node to create the payload.</p>
</script>

</div><div><!-- --- [red-module:node-red/catch] --- -->

<script type="text/x-red" data-template-name="catch">
    <div class="form-row">
        <label style="width: auto" for="node-input-scope" data-i18n="catch.label.source"></label>
        <select id="node-input-scope-select">
            <option value="all" data-i18n="catch.scope.all"></option>
            <option value="target" data-i18n="catch.scope.selected"></options>
        </select>
    </div>
    <div class="form-row node-input-uncaught-row">
        <input type="checkbox" id="node-input-uncaught" style="display: inline-block; width: auto; vertical-align: top; margin-left: 30px; margin-right: 5px;">
        <label for="node-input-uncaught" style="width: auto" data-i18n="catch.label.uncaught"></label>
    </div>
    <div class="form-row node-input-target-row" style="display: none;">
        <div id="node-input-catch-target-container-div" style="min-height: 100px;position: relative;   box-sizing: border-box; border-radius: 2px; height: 180px;  border: 1px solid #ccc;overflow:hidden; ">
            <div style="box-sizing: border-box; line-height: 20px; font-size: 0.8em; border-bottom: 1px solid #ddd; height: 20px;">
              <input type="checkbox" data-i18n="[title]catch.label.selectAll" id="node-input-target-node-checkbox-all" style="width: 30px; margin: 0 2px 1px 2px;">
              <div style="display: inline-block;"><a id="node-input-target-sort-label" href="#" data-i18n="[title]catch.label.sortByLabel"><span data-i18n="catch.label.node"></span> <i class="node-input-catch-sort-label-a fa fa-caret-down"></i><i class="node-input-catch-sort-label-d fa fa-caret-up"></i></a></div>
              <div style="position: absolute; right: 10px; width: 50px; display: inline-block; text-align: right;"><a id="node-input-target-sort-type" href="#" data-i18n="[title]catch.label.sortByType"><i class="node-input-catch-sort-sublabel-a fa fa-caret-down"></i><i class="node-input-catch-sort-sublabel-d fa fa-caret-up"></i> <span data-i18n="catch.label.type"></span></a></div>
            </div>
            <div style="background: #fbfbfb; box-sizing: border-box; position:absolute; top:20px;bottom:0;left:0px;right:0px; overflow-y: scroll; overflow-x: hidden;">
                <ul id="node-input-catch-target-container" style=" list-style-type:none; margin: 0;"></ul>
            </div>
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>

<style>
#node-input-catch-target-container {
    position: relative;
}
#node-input-catch-target-container li {
    padding: 2px 5px;
    background: none;
    font-size: 0.8em;
    margin:0;
    white-space: nowrap;
}
#node-input-catch-target-container li label {
    margin-bottom: 0;
    width: 100%;
}
#node-input-catch-target-container li label input {
    vertical-align: top;
    width:15px;
    margin-right: 10px;
}
#node-input-catch-target-container li:hover,
#node-input-catch-target-container li:hover .node-input-target-node-sublabel {
    background: #f0f0f0;
}
.node-input-target-node-sublabel {
    position:absolute;
    right: 0px;
    padding-right: 10px;
    padding-left: 10px;
    font-size: 0.8em;
    background: #fbfbfb;
}
</style>
<script type="text/javascript">
    RED.nodes.registerType('catch',{
        category: 'input',
        color:"#e49191",
        defaults: {
            name: {value:""},
            scope: {value:null},
            uncaught: {value:false}
        },
        inputs:0,
        outputs:1,
        icon: "alert.png",
        label: function() {
            if (this.name) {
                return this.name;
            }
            if (this.scope) {
                return this._("catch.catchNodes",{number:this.scope.length});
            }
            return this.uncaught?this._("catch.catchUncaught"):this._("catch.catch")
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var nodeList = $("#node-input-catch-target-container");
            var node = this;
            this.resize = function() {
                var rows = $("#dialog-form>div:not(.node-input-target-row)");
                var height = $("#dialog-form").height();
                for (var i=0;i<rows.size();i++) {
                    height -= $(rows[i]).outerHeight(true);
                }
                var editorRow = $("#dialog-form>div.node-input-target-row");
                height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));
                $("#node-input-catch-target-container-div").css("height",height+"px");
            };

            function createNodeList() {
                var scope = node.scope || [];
                nodeList.empty();

                var candidateNodes = RED.nodes.filterNodes({z:node.z});
                var allChecked = true;

                candidateNodes.forEach(function(n) {
                    if (n.id === node.id) {
                        return;
                    }
                    var isChecked = scope.indexOf(n.id) !== -1;

                    allChecked = allChecked && isChecked;

                    var container = $('<li></li>',{class:"node-input-target-node"});
                    var row = $('<label></label>',{for:"node-input-target-node-"+n.id}).appendTo(container);
                    $('<input>',{type:"checkbox",class:"node-input-target-node-checkbox",id:"node-input-target-node-"+n.id})
                        .data('node-id',n.id)
                        .prop('checked', isChecked)
                        .appendTo(row);
                    container.on('mouseover',function(e) {
                        n.highlighted = true;
                        n.dirty = true;
                        RED.view.redraw();
                    });
                    container.on('mouseout',function(e) {
                        n.highlighted = false;
                        n.dirty = true;
                        RED.view.redraw();
                    });
                    var labelSpan = $('<span>');
                    var nodeDef = RED.nodes.getType(n.type);
                    var label;
                    var sublabel;
                    if (nodeDef) {
                        var l = nodeDef.label;
                        label = (typeof l === "function" ? l.call(n) : l)||"";
                        sublabel = n.type;
                        if (sublabel.indexOf("subflow:") === 0) {
                            var subflowId = sublabel.substring(8);
                            var subflow = RED.nodes.subflow(subflowId);
                            sublabel = "subflow : "+subflow.name;
                        }
                    }
                    if (!nodeDef || !label) {
                        label = n.type;
                    }
                    $('<span>',{class:"node-input-target-node-label",style:"white-space:nowrap"}).text(label).appendTo(row);
                    if (sublabel) {
                        $('<span>',{class:"node-input-target-node-sublabel"}).text(sublabel).appendTo(row);
                    }

                    container.appendTo(nodeList);
                });

                $(".node-input-target-node-checkbox").change(function() {
                    if (!this.checked) {
                        $("#node-input-target-node-checkbox-all").prop('checked',false);
                    }
                });

                $("#node-input-target-node-checkbox-all").prop('checked',allChecked);

                sortNodeList('label');
            }

            function sortNodeList(sortOn) {
                var currentSort = nodeList.data('currentSort');
                var currentSortOrder = nodeList.data('currentSortOrder');

                if (!currentSort) {
                    currentSort = sortOn;
                    currentSortOrder = 'a';
                } else {
                    if (currentSort === sortOn) {
                        currentSortOrder = (currentSortOrder === 'a'?'d':'a');
                    } else {
                        currentSortOrder = 'a';
                    }
                    currentSort = sortOn;
                }
                nodeList.data('currentSort',currentSort);
                nodeList.data('currentSortOrder',currentSortOrder);

                $("#node-input-catch-target-container-div .fa").hide();
                $(".node-input-catch-sort-"+currentSort+"-"+currentSortOrder).show();


                var items = nodeList.find("li").get();
                items.sort(function(a,b) {
                    var labelA = $(a).find(".node-input-target-node-"+currentSort).text().toLowerCase();
                    var labelB = $(b).find(".node-input-target-node-"+currentSort).text().toLowerCase();
                    if (labelA < labelB) { return currentSortOrder==='a'?-1:1; }
                    if (labelA > labelB) { return currentSortOrder==='a'?1:-1; }
                    return 0;
                });
                $.each(items, function(i, li){
                    nodeList.append(li);
                });
            }
            $("#node-input-target-sort-label").click(function(e) {
                e.preventDefault();
                sortNodeList('label');
            });

            $("#node-input-target-sort-type").click(function(e) {
                e.preventDefault();
                sortNodeList('sublabel');
            });
            $("#node-input-target-node-checkbox-all").change(function() {
                $(".node-input-target-node-checkbox").prop('checked',this.checked);
            });



            $("#node-input-scope-select").change(function(e) {
                var scope = $(this).val();
                if (scope === "target") {
                    createNodeList();
                    $(".node-input-target-row").show();
                    $(".node-input-uncaught-row").hide();
                } else {
                    $(".node-input-target-row").hide();
                    $(".node-input-uncaught-row").show();
                }
                node.resize();
            });
            if (this.scope === null) {
                $("#node-input-scope-select").val("all");
            } else {
                $("#node-input-scope-select").val("target");
            }
            $("#node-input-scope-select").change();
        },
        oneditsave: function() {
            var scope = $("#node-input-scope-select").val();
            if (scope === 'all') {
                this.scope = null;
            } else {
                $("#node-input-uncaught").prop("checked",false);
                var node = this;
                node.scope = [];
                $(".node-input-target-node-checkbox").each(function(n) {
                    if ($(this).prop("checked")) {
                        node.scope.push($(this).data('node-id'));
                    }
                });
            }
        },
        oneditresize: function(size) {
            this.resize();
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="catch">
    <p>Catch errors thrown by nodes on the same tab.</p>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>error.message <span class="property-type">string</span></dt>
        <dd>the error message.</dd>
        <dt>error.source.id <span class="property-type">string</span></dt>
        <dd>the id of the node that threw the error.</dd>
        <dt>error.source.type <span class="property-type">string</span></dt>
        <dd>the type of the node that threw the error.</dd>
        <dt>error.source.name <span class="property-type">string</span></dt>
        <dd>the name, if set, of the node that threw the error.</dd>
    </dl>
    <h3>Details</h3>
    <p>If a node throws an error whilst handling a message, the flow will typically
       halt. This node can be used to catch those errors and handle them with a
       dedicated flow.</p>
    <p>By default, the node will catch errors thrown by any node on the same tab. Alternatively
    it can be targetted at specific nodes, or configured to only catch errors that
    have not already been caught by a 'targeted' catch node.</p>
    <p>When an error is thrown, all matching catch nodes will receive the message.</p>
    <p>If an error is thrown within a subflow, the error will get handled by any
       catch nodes within the subflow. If none exists, the error will be propagated
       up to the tab the subflow instance is on.</p>
   <p>If the message already has a <code>error</code> property, it is copied to <code>_error</code>.</p>
</script>

</div><div><!-- --- [red-module:node-red/status] --- -->

<script type="text/x-red" data-template-name="status">
    <div class="form-row">
        <label style="width: auto" for="node-input-scope" data-i18n="status.label.source"></label>
        <select id="node-input-scope-select">
            <option value="all" data-i18n="status.scope.all"></option>
            <option value="target" data-i18n="status.scope.selected"></options>
        </select>
    </div>
    <div class="form-row node-input-target-row" style="display: none;">
        <div id="node-input-status-target-container-div" style=" min-height: 100px;position: relative;   box-sizing: border-box; border-radius: 2px; height: 180px;  border: 1px solid #ccc;overflow:hidden; ">
            <div style="box-sizing: border-box; line-height: 20px; font-size: 0.8em; border-bottom: 1px solid #ddd; height: 20px;">
              <input type="checkbox" data-i18n="[title]status.label.selectAll" id="node-input-target-node-checkbox-all" style="width: 30px; margin: 0 2px 1px 2px;">
              <div style="display: inline-block;"><a id="node-input-target-sort-label" href="#" data-i18n="[title]status.label.sortByLabel"><span data-i18n="status.label.node"></span> <i class="node-input-status-sort-label-a fa fa-caret-down"></i><i class="node-input-status-sort-label-d fa fa-caret-up"></i></a></div>
              <div style="position: absolute; right: 10px; width: 50px; display: inline-block; text-align: right;"><a id="node-input-target-sort-type" href="#" data-i18n="[title]status.label.sortByType"><i class="node-input-status-sort-sublabel-a fa fa-caret-down"></i><i class="node-input-status-sort-sublabel-d fa fa-caret-up"></i> <span data-i18n="status.label.type"></span></a></div>
            </div>
            <div style="background: #fbfbfb; box-sizing: border-box; position:absolute; top:20px;bottom:0;left:0px;right:0px; overflow-y: scroll; overflow-x: hidden;">
                <ul id="node-input-status-target-container" style=" list-style-type:none; margin: 0;"></ul>
            </div>
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>

<style>
#node-input-status-target-container {
    position: relative;
}
#node-input-status-target-container li {
    padding: 2px 5px;
    background: none;
    font-size: 0.8em;
    margin:0;
    white-space: nowrap;
}
#node-input-status-target-container li label {
    margin-bottom: 0;
    width: 100%;
}
#node-input-status-target-container li label input {
    vertical-align: top;
    width:15px;
    margin-right: 10px;
}
#node-input-status-target-container li:hover,
#node-input-status-target-container li:hover .node-input-target-node-sublabel {
    background: #f0f0f0;
}
.node-input-target-node-sublabel {
    position:absolute;
    right: 0px;
    padding-right: 10px;
    padding-left: 10px;
    font-size: 0.8em;
    background: #fbfbfb;
}
</style>
<script type="text/javascript">
    RED.nodes.registerType('status',{
        category: 'input',
        color:"#c0edc0",
        defaults: {
            name: {value:""},
            scope: {value:null}
        },
        inputs:0,
        outputs:1,
        icon: "alert.png",
        label: function() {
            return this.name||(this.scope?this._("status.statusNodes",{number:this.scope.length}):this._("status.status"));
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var nodeList = $("#node-input-status-target-container");
            var node = this;
            this.resize = function() {
                var rows = $("#dialog-form>div:not(.node-input-target-row)");
                var height = $("#dialog-form").height();
                for (var i=0;i<rows.size();i++) {
                    height -= $(rows[i]).outerHeight(true);
                }
                var editorRow = $("#dialog-form>div.node-input-target-row");
                height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));
                $("#node-input-status-target-container-div").css("height",height+"px");
            };

            function createNodeList() {
                var scope = node.scope || [];
                nodeList.empty();

                var candidateNodes = RED.nodes.filterNodes({z:node.z});
                var allChecked = true;

                candidateNodes.forEach(function(n) {
                    if (n.id === node.id) {
                        return;
                    }
                    var isChecked = scope.indexOf(n.id) !== -1;

                    allChecked = allChecked && isChecked;

                    var container = $('<li></li>',{class:"node-input-target-node"});
                    var row = $('<label></label>',{for:"node-input-target-node-"+n.id}).appendTo(container);
                    $('<input>',{type:"checkbox",class:"node-input-target-node-checkbox",id:"node-input-target-node-"+n.id})
                        .data('node-id',n.id)
                        .prop('checked', isChecked)
                        .appendTo(row);
                    container.on('mouseover',function(e) {
                        n.highlighted = true;
                        n.dirty = true;
                        RED.view.redraw();
                    });
                    container.on('mouseout',function(e) {
                        n.highlighted = false;
                        n.dirty = true;
                        RED.view.redraw();
                    });
                    var labelSpan = $('<span>');
                    var nodeDef = RED.nodes.getType(n.type);
                    var label;
                    var sublabel;
                    if (nodeDef) {
                        var l = nodeDef.label;
                        label = (typeof l === "function" ? l.call(n) : l)||"";
                        sublabel = n.type;
                        if (sublabel.indexOf("subflow:") === 0) {
                            var subflowId = sublabel.substring(8);
                            var subflow = RED.nodes.subflow(subflowId);
                            sublabel = "subflow : "+subflow.name;
                        }
                    }
                    if (!nodeDef || !label) {
                        label = n.type;
                    }
                    $('<span>',{class:"node-input-target-node-label",style:"white-space:nowrap"}).text(label).appendTo(row);
                    if (sublabel) {
                        $('<span>',{class:"node-input-target-node-sublabel"}).text(sublabel).appendTo(row);
                    }

                    container.appendTo(nodeList);
                });

                $(".node-input-target-node-checkbox").change(function() {
                    if (!this.checked) {
                        $("#node-input-target-node-checkbox-all").prop('checked',false);
                    }
                });

                $("#node-input-target-node-checkbox-all").prop('checked',allChecked);

                sortNodeList('label');
            }

            function sortNodeList(sortOn) {
                var currentSort = nodeList.data('currentSort');
                var currentSortOrder = nodeList.data('currentSortOrder');

                if (!currentSort) {
                    currentSort = sortOn;
                    currentSortOrder = 'a';
                } else {
                    if (currentSort === sortOn) {
                        currentSortOrder = (currentSortOrder === 'a'?'d':'a');
                    } else {
                        currentSortOrder = 'a';
                    }
                    currentSort = sortOn;
                }
                nodeList.data('currentSort',currentSort);
                nodeList.data('currentSortOrder',currentSortOrder);

                $("#node-input-status-target-container-div .fa").hide();
                $(".node-input-status-sort-"+currentSort+"-"+currentSortOrder).show();


                var items = nodeList.find("li").get();
                items.sort(function(a,b) {
                    var labelA = $(a).find(".node-input-target-node-"+currentSort).text().toLowerCase();
                    var labelB = $(b).find(".node-input-target-node-"+currentSort).text().toLowerCase();
                    if (labelA < labelB) { return currentSortOrder==='a'?-1:1; }
                    if (labelA > labelB) { return currentSortOrder==='a'?1:-1; }
                    return 0;
                });
                $.each(items, function(i, li) {
                    nodeList.append(li);
                });
            }
            $("#node-input-target-sort-label").click(function(e) {
                e.preventDefault();
                sortNodeList('label');
            });

            $("#node-input-target-sort-type").click(function(e) {
                e.preventDefault();
                sortNodeList('sublabel');
            });
            $("#node-input-target-node-checkbox-all").change(function() {
                $(".node-input-target-node-checkbox").prop('checked',this.checked);
            });

            $("#node-input-scope-select").change(function(e) {
                var scope = $(this).val();
                if (scope === "target") {
                    createNodeList();
                    $(".node-input-target-row").show();
                } else {
                    $(".node-input-target-row").hide();
                }
                node.resize();
            });
            if (this.scope === null) {
                $("#node-input-scope-select").val("all");
            } else {
                $("#node-input-scope-select").val("target");
            }
            $("#node-input-scope-select").change();
        },
        oneditsave: function() {
            var scope = $("#node-input-scope-select").val();
            if (scope === 'all') {
                this.scope = null;
            } else {
                var node = this;
                node.scope = [];
                $(".node-input-target-node-checkbox").each(function(n) {
                    if ($(this).prop("checked")) {
                        node.scope.push($(this).data('node-id'));
                    }
                });
            }
        },
        oneditresize: function(size) {
            this.resize();
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="status">
    <p>Report status messages from other nodes on the same tab.</p>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>status.text <span class="property-type">string</span></dt>
        <dd>the status text.</dd>
        <dt>status.source.type <span class="property-type">string</span></dt>
        <dd>the type of the node that reported status.</dd>
        <dt>status.source.id <span class="property-type">string</span></dt>
        <dd>the id of the node that reported status.</dd>
        <dt>status.source.name <span class="property-type">string</span></dt>
        <dd>the name, if set, of the node that reported status.</dd>
    </dl>
    <h3>Details</h3>
   <p>This node does not produce a <code>payload</code>.</p>
   <p>By default the node reports status for all nodes on the same workspace tab.
   It can be configured to selectively report status for individual nodes.</p>
</script>

</div><script src="./Node-RED _ xu7.co_files/debug-utils.js"></script><div><!-- --- [red-module:node-red/debug] --- -->

<script type="text/x-red" data-template-name="debug">
    <div class="form-row">
        <label for="node-input-typed-complete"><i class="fa fa-list"></i> <span data-i18n="debug.output"></span></label>
        <input id="node-input-typed-complete" type="text" style="width: 70%">
        <input id="node-input-complete" type="hidden">
        <input id="node-input-targetType" type="hidden">
    </div>

    <div class="form-row">
        <label for="node-input-tosidebar"><i class="fa fa-random"></i> <span data-i18n="debug.to"></span></label>
        <label for="node-input-tosidebar" style="width:70%">
        <input type="checkbox" id="node-input-tosidebar" style="display:inline-block; width:22px; vertical-align:baseline;"><span data-i18n="debug.toSidebar"></span>
        </label>
    </div>
    <div class="form-row">
        <label for="node-input-console"> </label>
        <label for="node-input-console" style="width:70%">
        <input type="checkbox" id="node-input-console" style="display:inline-block; width:22px; vertical-align:baseline;"><span data-i18n="debug.toConsole"></span>
        </label>
    </div>
    <div class="form-row" id="node-tostatus-line">
    <label for="node-input-tostatus"> </label>
    <label for="node-input-tostatus" style="width:70%">
        <input type="checkbox" id="node-input-tostatus" style="display:inline-block; width:22px; vertical-align:baseline;"><span data-i18n="debug.toStatus"></span>
    </label>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>



<script type="text/javascript">
(function() {
    var subWindow = null;
    RED.nodes.registerType('debug',{
        category: 'output',
        defaults: {
            name: {value:""},
            active: {value:true},
            tosidebar: {value:true},
            console: {value:false},
            tostatus: {value:false},
            complete: {value:"false", required:true},
            targetType: {value:undefined}
        },
        label: function() {
            var suffix = "";
            if (this.console === true || this.console === "true") { suffix = " ⇲"; }
            if (this.targetType === "jsonata") {
                return (this.name || "JSONata") + suffix;
            }
            if (this.complete === true || this.complete === "true") {
                return (this.name||"msg") + suffix;
            } else {
                return (this.name || "msg." + ((!this.complete || this.complete === "false") ? "payload" : this.complete)) + suffix;
            }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        color:"#87a980",
        inputs:1,
        outputs:0,
        icon: "debug.png",
        align: "right",
        button: {
            toggle: "active",
            visible: function() { return this.tosidebar; },
            onclick: function() {
                var label = this.name||"debug";
                var node = this;
                $.ajax({
                    url: "debug/"+this.id+"/"+(this.active?"enable":"disable"),
                    type: "POST",
                    success: function(resp, textStatus, xhr) {
                        var historyEvent = {
                            t:'edit',
                            node:node,
                            changes:{
                                active:!node.active
                            },
                            dirty:node.dirty,
                            changed:node.changed
                        };
                        node.changed = true;
                        node.dirty = true;
                        RED.nodes.dirty(true);
                        RED.history.push(historyEvent);
                        RED.view.redraw();
                        if (xhr.status == 200) {
                            RED.notify(node._("debug.notification.activated",{label:label}),"success");
                        } else if (xhr.status == 201) {
                            RED.notify(node._("debug.notification.deactivated",{label:label}),"success");
                        }
                    },
                    error: function(jqXHR,textStatus,errorThrown) {
                        if (jqXHR.status == 404) {
                            RED.notify(node._("common.notification.error", {message: node._("common.notification.errors.not-deployed")}),"error");
                        } else if (jqXHR.status === 0) {
                            RED.notify(node._("common.notification.error", {message: node._("common.notification.errors.no-response")}),"error");
                        } else {
                            RED.notify(node._("common.notification.error",{message:node._("common.notification.errors.unexpected",{status:err.status,message:err.response})}),"error");
                        }
                    }
                });
            }
        },
        onpaletteadd: function() {
            var options = {
                messageMouseEnter: function(sourceId) {
                    if (sourceId) {
                        var n = RED.nodes.node(sourceId);
                        if (n) {
                            n.highlighted = true;
                            n.dirty = true;
                        }
                        RED.view.redraw();
                    }
                },
                messageMouseLeave: function(sourceId) {
                    if (sourceId) {
                        var n = RED.nodes.node(sourceId);
                        if (n) {
                            n.highlighted = false;
                            n.dirty = true;
                        }
                        RED.view.redraw();
                    }
                },
                messageSourceClick: function(sourceId) {
                    RED.view.reveal(sourceId);
                },
                clear: function() {
                    RED.nodes.eachNode(function(node) {
                        node.highlighted = false;
                        node.dirty = true;
                    });
                    RED.view.redraw();
                }
            };

            var uiComponents = RED.debug.init(options);

            RED.sidebar.addTab({
                id: "debug",
                label: this._("debug.sidebar.label"),
                name: this._("debug.sidebar.name"),
                content: uiComponents.content,
                toolbar: uiComponents.footer,
                enableOnEdit: true,
                pinned: true,
                iconClass: "fa fa-bug",
                action: "core:show-debug-tab"
            });
            RED.actions.add("core:show-debug-tab",function() { RED.sidebar.show('debug'); });

            var that = this;
            RED._debug = function(msg) {
                that.handleDebugMessage("", {
                    name:"debug",
                    msg:msg
                });
            };

            this.refreshMessageList = function() {
                RED.debug.refreshMessageList(RED.workspaces.active());
                if (subWindow) {
                    try {
                        subWindow.postMessage({event:"workspaceChange",activeWorkspace:RED.workspaces.active()},"*");
                    } catch(err) {
                        console.log(err);
                    }
                }
            };
            RED.events.on("workspace:change", this.refreshMessageList);

            this.handleDebugMessage = function(t,o) {
                var sourceNode = RED.nodes.node(o.id) || RED.nodes.node(o.z);
                if (sourceNode) {
                    o._source = {id:sourceNode.id,z:sourceNode.z,name:sourceNode.name,type:sourceNode.type,_alias:o._alias};
                }
                RED.debug.handleDebugMessage(o);
                if (subWindow) {
                    try {
                        subWindow.postMessage({event:"message",msg:o},"*");
                    } catch(err) {
                        console.log(err);
                    }
                }
            };
            RED.comms.subscribe("debug",this.handleDebugMessage);

            this.clearMessageList = function() {
                RED.debug.clearMessageList(true);
                if (subWindow) {
                    try {
                        subWindow.postMessage({event:"projectChange"},"*");
                    } catch(err) {
                        console.log(err);
                    }
                }
            };
            RED.events.on("project:change", this.clearMessageList);

            $("#debug-tab-open").click(function(e) {
                e.preventDefault();
                subWindow = window.open(document.location.toString().replace(/[?#].*$/,"")+"debug/view/view.html"+document.location.search,"nodeREDDebugView","menubar=no,location=no,toolbar=no,chrome,height=500,width=600");
                subWindow.onload = function() {
                    subWindow.postMessage({event:"workspaceChange",activeWorkspace:RED.workspaces.active()},"*");
                };
            });
            RED.popover.tooltip($("#debug-tab-open"),RED._('node-red:debug.sidebar.openWindow'));



            $(window).unload(function() {
                if (subWindow) {
                    try {
                        subWindow.close();
                    } catch(err) {
                        console.log(err);
                    }
                }
            });

            this.handleWindowMessage = function(evt) {
                var msg = evt.data;
                if (msg.event === "mouseEnter") {
                    options.messageMouseEnter(msg.id);
                } else if (msg.event === "mouseLeave") {
                    options.messageMouseLeave(msg.id);
                } else if (msg.event === "mouseClick") {
                    options.messageSourceClick(msg.id);
                } else if (msg.event === "clear") {
                    options.clear();
                }
            };
            window.addEventListener('message',this.handleWindowMessage);
        },
        onpaletteremove: function() {
            RED.comms.unsubscribe("debug",this.handleDebugMessage);
            RED.sidebar.removeTab("debug");
            RED.events.off("workspace:change", this.refreshMessageList);
            window.removeEventListener("message",this.handleWindowMessage);
            RED.actions.remove("core:show-debug");

            delete RED._debug;
        },
        oneditprepare: function() {
            var none = {
                value: "none",
                label: RED._("node-red:debug.none"),
                hasValue: false
            };
            if (this.tosidebar === undefined) {
                this.tosidebar = true;
                $("#node-input-tosidebar").prop('checked', true);
            }
            if (typeof this.console === "string") {
                this.console = (this.console == 'true');
                $("#node-input-console").prop('checked', this.console);
                $("#node-input-tosidebar").prop('checked', true);
            }
            var fullType = {
                value: "full",
                label: RED._("node-red:debug.msgobj"),
                hasValue: false
            };
            $("#node-input-typed-complete").typedInput({
                default: "msg",
                types:['msg', fullType, "jsonata"],
                typeField: $("#node-input-targetType")
            });
            if (this.targetType === "jsonata") {
                var property = this.complete || "";
                $("#node-input-typed-complete").typedInput('type','jsonata');
                $("#node-input-typed-complete").typedInput('value',property);
            } else if ((this.targetType === "full") || this.complete === "true" || this.complete === true) {
                // show complete message object
                $("#node-input-typed-complete").typedInput('type','full');
            } else {
                var property = (!this.complete||(this.complete === "false")) ? "payload" : this.complete+"";
                $("#node-input-typed-complete").typedInput('type','msg');
                $("#node-input-typed-complete").typedInput('value',property);
            }
            $("#node-input-typed-complete").on('change',function() {
                if ($("#node-input-typed-complete").typedInput('type') === 'msg' &&
                    $("#node-input-typed-complete").typedInput('value') === ''
                ) {
                    $("#node-input-typed-complete").typedInput('value','payload');
                }
                if ($("#node-input-typed-complete").typedInput('type') === 'full') {
                    $("#node-tostatus-line").hide();
                } else {
                    $("#node-tostatus-line").show();
                }
            });
            $("#node-input-complete").on('change',function() {
                if ($("#node-input-typed-complete").typedInput('type') === 'full') {
                    $("#node-tostatus-line").hide();
                } else {
                    $("#node-tostatus-line").show();
                }
            });
        },
        oneditsave: function() {
            var type = $("#node-input-typed-complete").typedInput('type');
            if (type === 'full') {
                $("#node-input-complete").val("true");
            } else {
                $("#node-input-complete").val($("#node-input-typed-complete").typedInput('value'));
            }
        }
    });
})();
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="debug">
    <p>Displays selected message properties in the debug sidebar tab and optionally the runtime log. By default it displays <code>msg.payload</code>, but can be configured to display any property, the full message or the result of a JSONata expression.</p>
    <h3>Details</h3>
    <p>The debug sidebar provides a structured view of the messages it is sent, making it easier to understand their structure.</p>
    <p>JavaScript objects and arrays can be collapsed and expanded as required. Buffer objects can be displayed as raw data or as a string if possible.</p>
    <p>Alongside each message, the debug sidebar includes information about the time the message was received, the node that sent it and the type of the message.
       Clicking on the source node id will reveal that node within the workspace.</p>
    <p>The button on the node can be used to enable or disable its output. It is recommended to disable or remove any Debug nodes that are not being used.</p>
    <p>The node can also be configured to send all messages to the runtime log, or to send short (32 characters) to the status text under the debug node.</p>
</script>

</div><div><!-- --- [red-module:node-red/link] --- -->

<script type="text/x-red" data-template-name="link in">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-row node-input-link-row"></div>
</script>
<script type="text/x-red" data-template-name="link out">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-row node-input-link-row"></div>
</script>

<script type="text/javascript">
(function() {

    var treeList;

    function onEditPrepare(node,targetType) {
        if (!node.links) {
            node.links = [];
        }
        node.oldLinks = [];

        var activeSubflow = RED.nodes.subflow(node.z);

        treeList = $("<div>")
            .css({width: "100%", height: "100%"})
            .appendTo(".node-input-link-row")
            .treeList({})
            .on('treelistitemmouseover',function(e,item) {
                if (item.node) {
                    item.node.highlighted = true;
                    item.node.dirty = true;
                    RED.view.redraw();
                }
            })
            .on('treelistitemmouseout',function(e,item) {
                if (item.node) {
                    item.node.highlighted = false;
                    item.node.dirty = true;
                    RED.view.redraw();
                }
            });
        var candidateNodes = RED.nodes.filterNodes({type:targetType});

        var flows = [];
        var flowMap = {};

        if (activeSubflow) {
            flowMap[activeSubflow.id] = {
                id: activeSubflow.id,
                class: 'palette-header',
                label:  "Subflow : "+(activeSubflow.name || activeSubflow.id),
                expanded: true,
                children: []
            };
            flows.push(flowMap[activeSubflow.id])
        } else {
            RED.nodes.eachWorkspace(function(ws) {
                flowMap[ws.id] = {
                    id: ws.id,
                    class: 'palette-header',
                    label: (ws.label || ws.id)+(node.z===ws.id ? " *":""),
                    expanded: true,
                    children: []
                }
                flows.push(flowMap[ws.id])
            })
        }

        candidateNodes.forEach(function(n) {
            if (flowMap[n.z]) {
                var isChecked = false;
                isChecked = (node.links.indexOf(n.id) !== -1) || (n.links||[]).indexOf(node.id) !== -1;
                if (isChecked) {
                    node.oldLinks.push(n.id);
                }
                flowMap[n.z].children.push({
                    id: n.id,
                    node: n,
                    label: n.name||n.id,
                    selected: isChecked
                })
            }
        });
        flows = flows.filter(function(f) { return f.children.length > 0 })
        treeList.treeList('data',flows);
        setTimeout(function() {
            treeList.treeList('show',node.z);
        },100);
    }

    function resizeNodeList() {
        var rows = $("#dialog-form>div:not(.node-input-link-row)");
        var height = $("#dialog-form").height();
        for (var i=0;i<rows.size();i++) {
            height -= $(rows[i]).outerHeight(true);
        }
        var editorRow = $("#dialog-form>div.node-input-link-row");
        height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));
        $(".node-input-link-row").css("height",height+"px");
    }

    function onEditSave(node) {
        var flows = treeList.treeList('data');
        node.links = [];
        flows.forEach(function(f) {
            f.children.forEach(function(n) {
                if (n.selected) {
                    node.links.push(n.id);
                }
            })
        })
        node.oldLinks.sort();
        node.links.sort();
        var nodeMap = {};
        var length = Math.max(node.oldLinks.length,node.links.length);
        for (var i=0;i<length;i++) {
            if (i<node.oldLinks.length) {
                nodeMap[node.oldLinks[i]] = nodeMap[node.oldLinks[i]]||{};
                nodeMap[node.oldLinks[i]].old = true;
            }
            if (i<node.links.length) {
                nodeMap[node.links[i]] = nodeMap[node.links[i]]||{};
                nodeMap[node.links[i]].new = true;
            }
        }
        var n;
        for (var id in nodeMap) {
            if (nodeMap.hasOwnProperty(id)) {
                n = RED.nodes.node(id);
                if (n) {
                    if (nodeMap[id].old && !nodeMap[id].new) {
                        // Removed id
                        i = n.links.indexOf(node.id);
                        if (i > -1) {
                            n.links.splice(i,1);
                        }
                    } else if (!nodeMap[id].old && nodeMap[id].new) {
                        // Added id
                        i = n.links.indexOf(id);
                        if (i === -1) {
                            n.links.push(node.id);
                        }
                    }
                }
            }
        }
    }

    function onAdd() {
        for (var i=0;i<this.links.length;i++) {
            var n = RED.nodes.node(this.links[i]);
            if (n && n.links.indexOf(this.id) === -1) {
                n.links.push(this.id);
            }
        }
    }

    RED.nodes.registerType('link in',{
        category: 'input',
        color:"#ddd",//"#87D8CF",
        defaults: {
            name: {value:""},
            links: { value: [] }
        },
        inputs:0,
        outputs:1,
        icon: "link-out.png",
        outputLabels: function(i) {
            return this.name||this._("link.linkIn");
        },
        label: function() {
            return this.name||this._("link.linkIn");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            onEditPrepare(this,"link out");
        },
        oneditsave: function() {
            onEditSave(this);
        },
        onadd: onAdd,
        oneditresize: resizeNodeList
    });

    RED.nodes.registerType('link out',{
        category: 'output',
        color:"#ddd",//"#87D8CF",
        defaults: {
            name: {value:""},
            links: { value: []}
        },
        align:"right",
        inputs:1,
        outputs:0,
        icon: "link-out.png",
        inputLabels: function(i) {
            return this.name||this._("link.linkOut");
        },
        label: function() {
            return this.name||this._("link.linkOut");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            onEditPrepare(this,"link in");
        },
        oneditsave: function() {
            onEditSave(this);
        },
        onadd: onAdd,
        oneditresize: resizeNodeList
    });
})();
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="link in">
    <p>Create virtual wires between flows.</p>
    <h3>Details</h3>
    <p>The node can be connected to any <code>link out</code> node that exists on any tab.
       Once connected, they behave as if they were wired together.</p>
    <p>The wires between link nodes are only displayed when a link node is selected.
       If there are any wires to other tabs, a virtual node is shown that can be clicked
       on to jump to the appropriate tab.</p>
    <p><b>Note: </b>Links cannot be created going into, or out of, a subflow.</p>
</script>

<script type="text/x-red" data-help-name="link out">
    <p>Create virtual wires between flows.</p>
    <h3>Details</h3>
    <p>The node can be connected to any <code>link in</code> node that exists on any tab.
       Once connected, they behave as if they were wired together.</p>
    <p>The wires between link nodes are only displayed when a link node is selected.
       If there are any wires to other tabs, a virtual node is show that can be clicked
       on to jump to the appropriate tab.</p>
    <p><b>Note: </b>Links cannot be created going into, or out of, a subflow.</p>
</script>

</div><div><!-- --- [red-module:node-red/exec] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="exec">
    <div class="form-row">
        <label for="node-input-command"><i class="fa fa-file"></i> <span data-i18n="exec.label.command"></span></label>
        <input type="text" id="node-input-command" data-i18n="[placeholder]exec.label.command">
    </div>
    <div class="form-row">
        <label><i class="fa fa-plus"></i> <span data-i18n="exec.label.append"></span></label>
        <input type="checkbox" id="node-input-addpay" style="display:inline-block; width:auto; vertical-align:top;">
        &nbsp;msg.payload
    </div>
    <div class="form-row">
        <label for="node-input-append"> </label>
        <input type="text" id="node-input-append" data-i18n="[placeholder]exec.placeholder.extraparams">
    </div>
    <div class="form-row">
        <label><i class="fa fa-sign-out"></i> <span data-i18n="exec.label.return"></span></label>
        <select type="text" id="node-input-useSpawn" style="width:70%">
            <option value="false" data-i18n="exec.opt.exec"></option>
            <option value="true" data-i18n="exec.opt.spawn"></option>
        </select>
    </div>
    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-oldrc" style="display:inline-block; width:auto; vertical-align:top;">
        <label for="node-input-oldrc" style="width:70%;"><span data-i18n="exec.oldrc"></span></label>
    </div>
    <div class="form-row">
        <label for="node-input-timer"><i class="fa fa-clock-o"></i> <span data-i18n="exec.label.timeout"></span></label>
        <input type="text" id="node-input-timer" style="width:65px;" data-i18n="[placeholder]exec.label.timeoutplace">
        <span data-i18n="exec.label.seconds"></span>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('exec',{
        category: 'advanced-function',
        color:"darksalmon",
        defaults: {
            command: {value:""},
            addpay: {value:true},
            append: {value:""},
            useSpawn: {value:"false"},
            timer: {value:""},
            oldrc: {value:false},
            name: {value:""}
        },
        inputs:1,
        outputs:3,
        outputLabels: function(i) {
            return [
                this._("exec.label.stdout"),
                this._("exec.label.stderr"),
                this._("exec.label.retcode")
            ][i];
        },
        icon: "arrow-in.png",
        align: "right",
        label: function() {
            return this.name||this.command||(this.useSpawn=="true"?this._("exec.spawn"):this._("exec.exec"));
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            if ($("#node-input-useSpawn").val() === null) {
                $("#node-input-useSpawn").val(this.useSpawn.toString());
            }
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="exec">
    <p>Runs a system command and returns its output.</p>
    <p>The node can be configured to either wait until the command completes, or to
    send its output as the command generates it.</p>
    <p>The command that is run can be configured in the node or provided by the received
    message.</p>

    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt class="optional">payload <span class="property-type">string</span></dt>
        <dd>if configured to do so, will be appended to the executed command.</dd>
        <dt class="optional">kill <span class="property-type">string</span></dt>
        <dd>the type of kill signal to send an existing exec node process.</dd>
        <dt class="optional">pid <span class="property-type">number|string</span></dt>
        <dd>the process ID of an existing exec node process to kill.</dd>
    </dl>

    <h3>Outputs</h3>
    <ol class="node-ports">
        <li>Standard output
            <dl class="message-properties">
                <dt>payload <span class="property-type">string</span></dt>
                <dd>the standard output of the command.</dd>
            </dl>
            <dl class="message-properties">
                <dt>rc <span class="property-type">object</span></dt>
                <dd>exec mode only, a copy of the return code object (also available on port 3)</dd>
            </dl>
        </li>
        <li>Standard error
            <dl class="message-properties">
                <dt>payload <span class="property-type">string</span></dt>
                <dd>the standard error of the command.</dd>
            </dl>
            <dl class="message-properties">
                <dt>rc <span class="property-type">object</span></dt>
                <dd>exec mode only, a copy of the return code object (also available on port 3)</dd>
            </dl>
        </li>
        <li>Return code
            <dl class="message-properties">
                <dt>payload <span class="property-type">object</span></dt>
                <dd>an object containing the return code, and possibly <code>message</code>, <code>signal</code> properties.</dd>
            </dl>
        </li>
    </ol>
    <h3>Details</h3>
    <p>By default uses the <code>exec</code> system call which calls the command, waits for it to complete, and then
    returns the output. For example a successful command should have a return code of <code>{ code: 0 }</code>.</p>
    <p>Optionally can use <code>spawn</code> instead, which returns the output from stdout and stderr
    as the command runs, usually one line at a time. On completion it then returns an object
    on the 3rd port. For example, a successful command should return <code>{ code: 0 }</code>.</p>
    <p>Errors may return extra information on the 3rd port <code>msg.payload</code>, such as a <code>message</code> string,
    <code>signal</code> string.</p>
    <p>The command that is run is defined within the node, with an option to append <code>msg.payload</code> and a further set of parameters.</p>
    <p>Commands or parameters with spaces should be enclosed in quotes - <code>"This is a single parameter"</code></p>
    <p>The returned <code>payload</code> is usually a <i>string</i>, unless non-UTF8 characters are detected, in which
    case it is a <i>buffer</i>.</p>
    <p>The node&apos;s status icon and PID will be visible while the node is active. Changes to this can be read by the <code>Status</code> node.</p>
    <h4>Killing processes</h4>
    <p>Sending <code>msg.kill</code> will kill a single active process. <code>msg.kill</code> should be a string containing
    the type of signal to be sent, for example, <code>SIGINT</code>, <code>SIGQUIT</code> or <code>SIGHUP</code>.
    Defaults to <code>SIGTERM</code> if set to an empty string.</p>
    <p>If the node has more than one process running then <code>msg.pid</code> must also be set with the value of the PID to be killed.</p>
    <p>If a value is provided in the <code>Timeout</code> field then, if the process has not completed when the specified number of seconds has elapsed, the process will be killed automatically</p>
    <p>Tip: if running a Python app you may need to use the <code>-u</code> parameter to stop the output being buffered.</p>
</script>

</div><div><!-- --- [red-module:node-red/function] --- -->

<script type="text/x-red" data-template-name="function">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <div style="display: inline-block; width: calc(100% - 105px)"><input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name"></div>
    </div>
    <div class="form-row" style="margin-bottom: 0px;">
        <label for="node-input-func"><i class="fa fa-wrench"></i> <span data-i18n="function.label.function"></span></label>
        <input type="hidden" id="node-input-func" autofocus="autofocus">
        <input type="hidden" id="node-input-noerr">
    </div>
    <div class="form-row node-text-editor-row" style="position:relative">
        <div style="position: absolute; right:0; bottom:calc(100% + 3px);"><button id="node-function-expand-js" class="editor-button editor-button-small"><i class="fa fa-expand"></i></button></div>
        <div style="height: 250px; min-height:150px;" class="node-text-editor" id="node-input-func-editor" ></div>
    </div>
    <div class="form-row" style="margin-bottom: 0px">
        <label for="node-input-outputs"><i class="fa fa-random"></i> <span data-i18n="function.label.outputs"></span></label>
        <input id="node-input-outputs" style="width: 60px;" value="1">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('function',{
        color:"#fdd0a2",
        category: 'function',
        defaults: {
            name: {value:""},
            func: {value:"\nreturn msg;"},
            outputs: {value:1},
            noerr: {value:0,required:true,validate:function(v) { return !v; }}
        },
        inputs:1,
        outputs:1,
        icon: "function.png",
        label: function() {
            return this.name||this._("function.function");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var that = this;
            $( "#node-input-outputs" ).spinner({
                min:1,
                change: function(event, ui) {
                    var value = this.value;
                    if (!value.match(/^\d+$/)) { value = 1;  }
                    else if (value < this.min) { value = this.min; }
                    if (value !== this.value) { $(this).spinner("value", value); }
                }
            });

            this.editor = RED.editor.createEditor({
                id: 'node-input-func-editor',
                mode: 'ace/mode/nrjavascript',
                value: $("#node-input-func").val(),
                globals: {
                    msg:true,
                    context:true,
                    RED: true,
                    util: true,
                    flow: true,
                    global: true,
                    console: true,
                    Buffer: true,
                    setTimeout: true,
                    clearTimeout: true,
                    setInterval: true,
                    clearInterval: true
                }
            });

            RED.library.create({
                url:"functions", // where to get the data from
                type:"function", // the type of object the library is for
                editor:this.editor, // the field name the main text body goes to
                mode:"ace/mode/nrjavascript",
                fields:['name','outputs']
            });
            this.editor.focus();

            $("#node-function-expand-js").click(function(e) {
                e.preventDefault();
                var value = that.editor.getValue();
                RED.editor.editJavaScript({
                    value: value,
                    width: "Infinity",
                    cursor: that.editor.getCursorPosition(),
                    mode: "ace/mode/nrjavascript",
                    complete: function(v,cursor) {
                        that.editor.setValue(v, -1);
                        that.editor.gotoLine(cursor.row+1,cursor.column,false);
                        setTimeout(function() {
                            that.editor.focus();
                        },300);
                    }
                })
            })
        },
        oneditsave: function() {
            var annot = this.editor.getSession().getAnnotations();
            this.noerr = 0;
            $("#node-input-noerr").val(0);
            for (var k=0; k < annot.length; k++) {
                //console.log(annot[k].type,":",annot[k].text, "on line", annot[k].row);
                if (annot[k].type === "error") {
                    $("#node-input-noerr").val(annot.length);
                    this.noerr = annot.length;
                }
            }
            $("#node-input-func").val(this.editor.getValue());
            this.editor.destroy();
            delete this.editor;
        },
        oneditcancel: function() {
            this.editor.destroy();
            delete this.editor;
        },
        oneditresize: function(size) {
            var rows = $("#dialog-form>div:not(.node-text-editor-row)");
            var height = $("#dialog-form").height();
            for (var i=0; i<rows.size(); i++) {
                height -= $(rows[i]).outerHeight(true);
            }
            var editorRow = $("#dialog-form>div.node-text-editor-row");
            height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));
            $(".node-text-editor").css("height",height+"px");
            this.editor.resize();
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="function">
    <p>A JavaScript function block to run against the messages being received by the node.</p>
    <p>The messages are passed in as a JavaScript object called <code>msg</code>.</p>
    <p>By convention it will have a <code>msg.payload</code> property containing
       the body of the message.</p>
    <p>The function is expected to return a message object (or multiple message objects), but can choose
       to return nothing in order to halt a flow.</p>
    <h3>Details</h3>
    <p>See the <a target="_blank" href="http://nodered.org/docs/writing-functions.html">online documentation</a>
    for more information on writing functions.</p>
    <h4>Sending messages</h4>
    <p>The function can either return the messages it wants to pass on to the next nodes
    in the flow, or can call <code>node.send(messages)</code>.</p>
    <p>It can return/send:</p>
    <ul>
      <li>a single message object - passed to nodes connected to the first output</li>
      <li>an array of message objects - passed to nodes connected to the corresponding outputs</li>
    </ul>
    <p>If any element of the array is itself an array of messages, multiple
          messages are sent to the corresponding output.</p>
    <p>If null is returned, either by itself or as an element of the array, no
          message is passed on.</p>
    <h4>Logging and Error Handling</h4>
    <p>To log any information, or report an error, the following functions are available:</p>
      <ul>
          <li><code>node.log("Log message")</code></li>
          <li><code>node.warn("Warning")</code></li>
          <li><code>node.error("Error")</code></li>
      </ul>
    </p>
    <p>The Catch node can also be used to handle errors. To invoke a Catch node,
    pass <code>msg</code> as a second argument to <code>node.error</code>:</p>
    <pre>node.error("Error",msg);</pre>
    <h4>Accessing Node Information</h4>
    <p>In the function block, id and name of the node can be referenced using the following properties:</p>
    <ul>
        <li><code>node.id</code> - id of the node</li>
        <li><code>node.name</code> - name of the node</li>
    </ul>
    <h4>Using environment variables</h4>
    <p>Environment variables can be accessed using <code>env.get("MY_ENV_VAR")</code>.</p>
</script>

</div><div><!-- --- [red-module:node-red/template] --- -->

<script type="text/x-red" data-template-name="template">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <div style="display: inline-block; width: calc(100% - 105px)"><input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name"></div>
    </div>
    <div class="form-row">
        <label for="node-input-field"><i class="fa fa-ellipsis-h"></i> <span data-i18n="template.label.property"></span></label>
        <input type="text" id="node-input-field" placeholder="payload" style="width:250px;">
        <input type="hidden" id="node-input-fieldType">
    </div>
    <div class="form-row">
        <label for="node-input-syntax"><i class="fa fa-code"></i> <span data-i18n="template.label.syntax"></span></label>
        <select id="node-input-syntax" style="width:180px;">
            <option value="mustache" data-i18n="template.label.mustache"></option>
            <option value="plain" data-i18n="template.label.plain"></option>
        </select>
    </div>

    <div class="form-row" style="position: relative; margin-bottom: 0px;">
        <label for="node-input-template"><i class="fa fa-file-code-o"></i> <span data-i18n="template.label.template"></span></label>
        <input type="hidden" id="node-input-template" autofocus="autofocus">
        <div style="position: absolute; right:0;display:inline-block; text-align: right; font-size: 0.8em;">
            <span data-i18n="template.label.format"></span>:
            <select id="node-input-format" style="width:110px; font-size: 10px !important;  height: 24px; padding:0;">
                <option value="handlebars">mustache</option>
                <option value="html">HTML</option>
                <option value="json">JSON</option>
                <option value="javascript">Javascript</option>
                <option value="css">CSS</option>
                <option value="markdown">Markdown</option>
                <option value="yaml">YAML</option>
                <option value="text" data-i18n="template.label.none"></option>
            </select>
        </div>
    </div>
    <div class="form-row node-text-editor-row">
        <div style="height: 250px; min-height:150px;" class="node-text-editor" id="node-input-template-editor" ></div>
    </div>
    <div class="form-row">
        <label for="node-input-output"><i class="fa fa-long-arrow-right"></i> <span data-i18n="template.label.output"></span></label>
        <select id="node-input-output" style="width:180px;">
            <option value="str" data-i18n="template.label.plain"></option>
            <option value="json" data-i18n="template.label.json"></option>
            <option value="yaml" data-i18n="template.label.yaml"></option>
        </select>
    </div>

</script>

<script type="text/javascript">
    RED.nodes.registerType('template',{
        color:"rgb(243, 181, 103)",
        category: 'function',
        defaults: {
            name: {value:""},
            field: {value:"payload", validate:RED.validators.typedInput("fieldType")},
            fieldType: {value:"msg"},
            format: {value:"handlebars"},
            syntax: {value:"mustache"},
            template: {value:"This is the payload: {{payload}} !"},
            output: {value:"str"}
        },
        inputs:1,
        outputs:1,
        icon: "template.png",
        label: function() {
            return this.name||this._("template.template");;
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var that = this;
            if (!this.field) {
                this.field = 'payload';
                $("#node-input-field").val("payload");
            }
            if (!this.fieldType) {
                this.fieldType = 'msg';
            }
            if (!this.syntax) {
                this.syntax = 'mustache';
                $("#node-input-syntax").val(this.syntax);
            }
            $("#node-input-field").typedInput({
                default: 'msg',
                types: ['msg','flow','global'],
                typeField: $("#node-input-fieldType")
            });

            this.editor = RED.editor.createEditor({
                id: 'node-input-template-editor',
                mode: 'ace/mode/html',
                value: $("#node-input-template").val()
            });
            RED.library.create({
                url:"functions", // where to get the data from
                type:"function", // the type of object the library is for
                editor:that.editor, // the field name the main text body goes to
                fields:['name','outputs']
            });
            this.editor.focus();

            $("#node-input-format").change(function() {
                var mod = "ace/mode/"+$("#node-input-format").val();
                that.editor.getSession().setMode({
                    path: mod,
                    v: Date.now()
                });
            });
        },
        oneditsave: function() {
            $("#node-input-template").val(this.editor.getValue());
            this.editor.destroy();
            delete this.editor;
        },
        oneditcancel: function() {
            this.editor.destroy();
            delete this.editor;
        },
        oneditresize: function(size) {
            var rows = $("#dialog-form>div:not(.node-text-editor-row)");
            var height = $("#dialog-form").height();
            for (var i=0; i<rows.size(); i++) {
                height -= $(rows[i]).outerHeight(true);
            }
            var editorRow = $("#dialog-form>div.node-text-editor-row");
            height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));
            $(".node-text-editor").css("height",height+"px");
            this.editor.resize();
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="template">
    <p>Sets a property based on the provided template.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>msg <span class="property-type">object</span></dt>
        <dd>A msg object containing information to populate the template.</dd>
        <dt class="optional">template <span class="property-type">string</span></dt>
        <dd>A template to be populated from msg.payload. If not configured in the edit panel,
         this can be set as a property of msg.</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>msg <span class="property-type">object</span></dt>
        <dd>a msg with a property set by populating the configured template with properties from the incoming msg.</dd>
    </dl>
    <h3>Details</h3>
    <p>By default this uses the <i><a href="http://mustache.github.io/mustache.5.html" target="_blank">mustache</a></i>
    format, but this can be switched off if required.</p>
    <p>For example, when a template of:
    <pre>Hello {{payload.name}}. Today is {{date}}</pre>
    <p>receives a message containing:
    <pre>{
  date: "Monday"
  payload: {
    name: "Fred",
  }
}</pre>
    <p>The resulting property will be:
    <pre>Hello Fred. Today is Monday</pre>
    <p>It is possible to use a property from the flow context or global context. Just use <code>{{flow.name}}</code> or
    <code>{{global.name}}</code>, or for persistable store <code>store</code> use <code>{{flow[store].name}}</code> or
    <code>{{global[store].name}}</code>.
    <p><b>Note: </b>By default, <i>mustache</i> will escape any HTML entities in the values it substitutes.
       To prevent this, use <code>{{{triple}}}</code> braces.
</script>

</div><div><!-- --- [red-module:node-red/delay] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="delay">
    <div class="form-row">
        <label for="node-input-delay-action"><i class="fa fa-tasks"></i> <span data-i18n="delay.action"></span></label>
        <select id="node-input-delay-action" style="width:270px !important">
            <option value="delay" data-i18n="delay.delaymsg"></option>
            <option value="rate" data-i18n="delay.limitrate"></option>
        </select>
    </div>

    <div id="delay-details">
        <div class="form-row">
            <label></label>
            <select id="node-input-delay-type" style="width:270px !important">
                <option value="delay" data-i18n="delay.delayfixed"></option>
                <option value="random" data-i18n="delay.randomdelay"></option>
                <option value="delayv" data-i18n="delay.delayvarmsg"></option>
            </select>
        </div>
        <div class="form-row" id="delay-details-for">
            <label for="node-input-timeout"><i class="fa fa-clock-o"></i> <span data-i18n="delay.for"></span></label>
            <input type="text" id="node-input-timeout" style="text-align:end; width:50px !important">
            <select id="node-input-timeoutUnits" style="width:200px !important">
              <option value="milliseconds" data-i18n="delay.milisecs"></option>
              <option value="seconds" data-i18n="delay.secs"></option>
              <option value="minutes" data-i18n="delay.mins"></option>
              <option value="hours" data-i18n="delay.hours"></option>
              <option value="days" data-i18n="delay.days"></option>
            </select>
        </div>
        <div id="random-details" class="form-row">
            <label for="node-input-randomFirst"><i class="fa fa-clock-o"></i> <span data-i18n="delay.between"></span></label>
            <input type="text" id="node-input-randomFirst" placeholder="" style="text-align:end; width:30px !important">
            <span data-i18n="delay.and"></span>
            <input type="text" id="node-input-randomLast" placeholder="" style="text-align:end; width:30px !important">
            <select id="node-input-randomUnits" style="width:140px !important">
              <option value="milliseconds" data-i18n="delay.milisecs"></option>
              <option value="seconds" data-i18n="delay.secs"></option>
              <option value="minutes" data-i18n="delay.mins"></option>
              <option value="hours" data-i18n="delay.hours"></option>
              <option value="days" data-i18n="delay.days"></option>
            </select>
        </div>
    </div>

    <div id="rate-details">
        <div class="form-row">
            <label></label>
            <select id="node-input-rate-type" style="width:270px !important">
                <option value="all" data-i18n="delay.limitall"></option>
                <option value="topic" data-i18n="delay.limittopic"></option>
            </select>
        </div>
        <div class="form-row">
            <label for="node-input-rate"><i class="fa fa-clock-o"></i> <span data-i18n="delay.rate"></span></label>
            <input type="text" id="node-input-rate" placeholder="1" style="text-align:end; width:40px !important">
            <label for="node-input-rateUnits"><span data-i18n="delay.msgper"></span></label>
            <input type="text" id="node-input-nbRateUnits" placeholder="1" style="text-align:end; width:40px !important">
            <select id="node-input-rateUnits" style="width:90px !important">
              <option value="second" data-i18n="delay.label.units.second.singular"></option>
              <option value="minute" data-i18n="delay.label.units.minute.singular"></option>
              <option value="hour" data-i18n="delay.label.units.hour.singular"></option>
              <option value="day" data-i18n="delay.label.units.day.singular"></option>
            </select>
        </div>
        <div class="form-row" id="rate-details-drop">
            <label></label><input style="width: 30px;" type="checkbox" id="node-input-drop"><label style="width: 250px;" for="node-input-drop" data-i18n="delay.dropmsg"></label>
        </div>
        <div class="form-row" id="rate-details-per-topic">
            <label></label>
            <select id="node-input-rate-topic-type" style="width:270px !important">
                <option value="queue" data-i18n="delay.fairqueue"></option>
                <option value="timed" data-i18n="delay.timedqueue"></option>
            </select>
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('delay',{
        category: 'function',
        color:"#E6E0F8",
        defaults: {
            name: {value:""},
            pauseType: {value:"delay", required:true},
            timeout: {value:"5", required:true, validate:function(v) { return RED.validators.number(v) && (v >= 0); }},
            timeoutUnits: {value:"seconds"},
            rate: {value:"1", required:true, validate:function(v) { return RED.validators.number(v) && (v >= 0); }},
            nbRateUnits: {value:"1", required:false, validate:RED.validators.regex(/\d+|/)},
            rateUnits: {value: "second"},
            randomFirst: {value:"1", required:true, validate:function(v) { return RED.validators.number(v) && (v >= 0); }},
            randomLast: {value:"5", required:true, validate:function(v) { return RED.validators.number(v) && (v >= 0); }},
            randomUnits: {value: "seconds"},
            drop: {value:false}
        },
        inputs:1,
        outputs:1,
        icon: "timer.png",
        label: function() {
            if (this.name) {
                return this.name;
            }
            if (this.pauseType == "delayv") {
                return this._("delay.label.variable");
            } else if (this.pauseType == "delay") {
                var units = this.timeoutUnits ? this.timeoutUnits.charAt(0) : "s";
                if (this.timeoutUnits == "milliseconds") { units = "ms"; }
                return this._("delay.label.delay")+" "+this.timeout+units;
            } else if (this.pauseType == "random") {
                return this._("delay.label.random");
            } else {
                var rate = this.rate+" msg/"+(this.rateUnits ? (this.nbRateUnits > 1 ? this.nbRateUnits : '') + this.rateUnits.charAt(0) : "s");
                if (this.pauseType == "rate") {
                    return this._("delay.label.limit")+" "+rate;
                } else if (this.pauseType == "timed") {
                    return this._("delay.label.limitTopic")+" "+rate;
                } else {
                    return this._("delay.label.limitTopic")+" "+rate;
                }
            }
            //     var units = '';
            //     if (this.nbRateUnits > 1) {
            //         units = this.nbRateUnits + ' ' + this._("delay.label.units." + this.rateUnits + ".plural");
            //     } else {
            //         units = this._("delay.label.units." + this.rateUnits + ".singular");
            //     }
            //     return this.name || this.rate + " " + this._("delay.label.timed") + ' ' + units;
            // } else {
            //     var units = this.rateUnits ? (this.nbRateUnits > 1 ? this.nbRateUnits : '') + this.rateUnits.charAt(0) : "s";
            //     return this.name || this._("delay.label.queue")+" "+this.rate+" msg/"+units;
            // }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var node = this;
            $( "#node-input-timeout" ).spinner({min:1});
            $( "#node-input-rate" ).spinner({min:1});
            $( "#node-input-nbRateUnits" ).spinner({min:1});

            $( "#node-input-randomFirst" ).spinner({min:0});
            $( "#node-input-randomLast" ).spinner({min:1});

            $('.ui-spinner-button').click(function() {
                $(this).siblings('input').change();
            });

            $( "#node-input-nbRateUnits" ).on('change keyup', function() {
                var $this = $(this);
                var val = parseInt($this.val());
                var type = "singular";
                if (val > 1) {
                    type = "plural";
                }
                if ($this.attr("data-type") == type) {
                    return;
                }
                $this.attr("data-type", type);
                $("#node-input-rateUnits option").each(function () {
                    var $option = $(this);
                    var key = "delay.label.units." + $option.val() + "." + type;
                    $option.attr('data-i18n', 'node-red:' + key);
                    $option.html(node._(key));
                });
            });

            if (this.pauseType == "delay") {
                $("#node-input-delay-action").val('delay');
                $("#node-input-delay-type").val('delay');
            } else if (this.pauseType == "delayv") {
                $("#node-input-delay-action").val('delay');
                $("#node-input-delay-type").val('delayv');
            } else if (this.pauseType == "random") {
                $("#node-input-delay-action").val('delay');
                $("#node-input-delay-type").val('random');
            } else if (this.pauseType == "rate") {
                $("#node-input-delay-action").val('rate');
                $("#node-input-rate-type").val('all');
            } else if (this.pauseType == "queue") {
                $("#node-input-delay-action").val('rate');
                $("#node-input-rate-type").val('topic');
                $("#node-input-rate-topic-type").val('queue');
            } else if (this.pauseType == "timed") {
                $("#node-input-delay-action").val('rate');
                $("#node-input-rate-type").val('topic');
                $("#node-input-rate-topic-type").val('timed');
            }

            if (!this.timeoutUnits) {
                $("#node-input-timeoutUnits option").filter(function() {
                    return $(this).val() == 'seconds';
                }).attr('selected', true);
            }

            if (!this.randomUnits) {
                $("#node-input-randomUnits option").filter(function() {
                    return $(this).val() == 'seconds';
                }).attr('selected', true);
            }

            $("#node-input-delay-action").on("change",function() {
                if (this.value === "delay") {
                    $("#delay-details").show();
                    $("#rate-details").hide();
                } else if (this.value === "rate") {
                    $("#delay-details").hide();
                    $("#rate-details").show();
                }
            }).change();

            $("#node-input-delay-type").on("change", function() {
                if (this.value === "delay") {
                    $("#delay-details-for").show();
                    $("#random-details").hide();
                } else if (this.value === "delayv") {
                    $("#delay-details-for").show();
                    $("#random-details").hide();
                } else if (this.value === "random") {
                    $("#delay-details-for").hide();
                    $("#random-details").show();
                }
            }).change();

            $("#node-input-rate-type").on("change", function() {
                if (this.value === "all") {
                    $("#node-input-drop").attr('disabled',false).next().css("opacity",1)
                    $("#rate-details-per-topic").hide();
                } else if (this.value === "topic") {
                    $("#node-input-drop").prop('checked',true).attr('disabled',true).next().css("opacity",0.5)
                    $("#rate-details-per-topic").show();
                }
            }).change();
        },
        oneditsave: function() {
            var action = $("#node-input-delay-action").val();
            if (action === "delay") {
                this.pauseType = $("#node-input-delay-type").val();
            } else if (action === "rate") {
                action = $("#node-input-rate-type").val();
                if (action === "all") {
                    this.pauseType = "rate";
                } else {
                    this.pauseType = $("#node-input-rate-topic-type").val();
                }
            }
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="delay">
    <p>Delays each message passing through the node or limits the rate at which they can pass.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt class="optional">delay <span class="property-type">number</span></dt>
        <dd>Sets the delay, in milliseconds, to be applied to the message. This
            option only applies if the node is configured to allow the message to
            override the configured default delay interval.</dd>
            <dt class="optional">reset</dt>
            <dd>If the received message has this property set to any value, all
                outstanding messages held by the node are cleared without being sent.</dd>
            <dt class="optional">flush</dt>
            <dd>If the received message has this property set to any value, all
                outstanding messages held by the node are sent immediately.</dd>
    </dl>
    <h3>Details</h3>
    <p>When configured to delay messages, the delay interval can be a fixed value,
       a random value within a range or dynamically set for each message.</p>
    <p>When configured to rate limit messages, their delivery is spread across
       the configured time period. The status shows the number of messages currently in the queue.
       It can optionally discard intermediate messages as they arrive.</p>
    </p>
    <p>The rate limiting can be applied to all messages, or group them according to
       their <code>msg.topic</code> value. When grouping, intermerdiate messages are
       automatically dropped. At each time interval, the node can either release
       the most recent message for all topics, or release the most recent message
       for the next topic.
    </p>
</script>

</div><div><!-- --- [red-module:node-red/trigger] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="trigger">
    <div class="form-row">
        <label data-i18n="trigger.send" for="node-input-op1"></label>
        <input type="hidden" id="node-input-op1type">
        <input style="width: 70%" type="text" id="node-input-op1" placeholder="1">
    </div>
    <div class="form-row">
        <label data-i18n="trigger.then"></label>
        <select id="node-then-type" style="width:70%;">
            <option value="block" data-i18n="trigger.wait-reset"></option>
            <option value="wait" data-i18n="trigger.wait-for"></option>
            <option value="loop" data-i18n="trigger.wait-loop"></option>
        </select>
    </div>
    <div class="form-row node-type-duration">
        <label></label>
        <input type="text" id="node-input-duration" style="text-align:end; width:70px !important">
        <select id="node-input-units" style="width:140px !important">
            <option value="ms" data-i18n="trigger.duration.ms"></option>
            <option value="s" data-i18n="trigger.duration.s"></option>
            <option value="min" data-i18n="trigger.duration.m"></option>
            <option value="hr" data-i18n="trigger.duration.h"></option>
        </select>
    </div>
    <div class="form-row node-type-wait">
    <label></label>
        <input type="checkbox" id="node-input-extend" style="margin-left: 0px; vertical-align: top; width: auto !important;"> <label style="width:auto !important;" for="node-input-extend" data-i18n="trigger.extend"></label>
    </div>
    <div class="form-row node-type-wait">
        <label data-i18n="trigger.then-send"></label>
        <input type="hidden" id="node-input-op2type">
        <input style="width: 70%" type="text" id="node-input-op2" placeholder="0">
    </div>
    <div class="form-row">
        <label data-i18n="trigger.label.reset" style="width:auto"></label>
        <div style="display:inline-block; width:70%;vertical-align:top">
        <ul>
            <li data-i18n="trigger.label.resetMessage"></li>
            <li><span data-i18n="trigger.label.resetPayload"></span> <input type="text" id="node-input-reset" style="width:150px" data-i18n="[placeholder]trigger.label.resetprompt"></li>
        </ul>
    </div>
    <br/>
    <div class="form-row">
        <label data-i18n="trigger.for" for="node-input-bytopic"></label>
        <select id="node-input-bytopic">
            <option value="all" data-i18n="trigger.alltopics"></option>
            <option value="topic" data-i18n="trigger.bytopics"></option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name"></input>
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('trigger',{
        category: 'function',
        color:"#E6E0F8",
        defaults: {
            op1: {value:"1", validate: RED.validators.typedInput("op1type")},
            op2: {value:"0", validate: RED.validators.typedInput("op2type")},
            op1type: {value:"val"},
            op2type: {value:"val"},
            duration: {value:"250",required:true,validate:RED.validators.number()},
            extend: {value:"false"},
            units: {value:"ms"},
            reset: {value:""},
            bytopic: {value: "all"},
            name: {value:""}
        },
        inputs:1,
        outputs:1,
        icon: "trigger.png",
        label: function() {
            if (this.duration > 0) {
                return this.name|| this._("trigger.label.trigger")+" "+this.duration+this.units;
            }
            if (this.duration < 0) {
                return this.name|| this._("trigger.label.trigger-loop")+" "+(this.duration * -1)+this.units;
            }
            else {
                return this.name|| this._("trigger.label.trigger-block");
            }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            $("#node-then-type").change(function() {
                if ($(this).val() == "block") {
                    $(".node-type-wait").hide();
                    $(".node-type-duration").hide();
                }
                else if ($(this).val() == "loop") {
                    $(".node-type-wait").hide();
                    $(".node-type-duration").show();
                } else {
                    $(".node-type-wait").show();
                    $(".node-type-duration").show();
                }
            });

            if (this.op1type === 'val') {
                $("#node-input-op1type").val('str');
            }
            if (this.op2type === 'val') {
                $("#node-input-op2type").val('str');
            }

            var optionNothing = {value:"nul",label:this._("trigger.output.nothing"),hasValue:false};
            var optionPayload = {value:"pay",label:this._("trigger.output.existing"),hasValue:false};
            var optionOriginalPayload = {value:"pay",label:this._("trigger.output.original"),hasValue:false};
            var optionLatestPayload = {value:"payl",label:this._("trigger.output.latest"),hasValue:false};

            $("#node-input-op1").typedInput({
                default: 'str',
                typeField: $("#node-input-op1type"),
                types:['flow','global','str','num','bool','json','bin','date','env',
                    optionPayload,
                    optionNothing
                ]
            });
            $("#node-input-op2").typedInput({
                default: 'str',
                typeField: $("#node-input-op2type"),
                types:['flow','global','str','num','bool','json','bin','date','env',
                    optionOriginalPayload,
                    optionLatestPayload,
                    optionNothing
                ]
            });

            if (this.bytopic === undefined) {
                $("#node-input-bytopic").val("all");
            }

            if (this.duration == "0") {
                $("#node-then-type").val("block");
            }
            else if ((this.duration * 1) < 0) {
                $("#node-then-type").val("loop");
                $("#node-input-duration").val(this.duration*-1);
            } else {
                $("#node-then-type").val("wait");
            }
            $("#node-then-type").change();

            if (this.extend === "true" || this.extend === true) {
                $("#node-input-extend").prop("checked",true);
            } else {
                $("#node-input-extend").prop("checked",false);
            }

        },
        oneditsave: function() {
            if ($("#node-then-type").val() == "block") {
                $("#node-input-duration").val("0");
            }
            if ($("#node-then-type").val() == "loop") {
                $("#node-input-duration").val($("#node-input-duration").val() * -1);
            }


        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="trigger">
    <p>When triggered, can send a message, and then optionally a second message, unless extended or reset.</p>

    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt class="optional">reset</dt>
        <dd>If a message is received with this property, any timeout or repeat
        currently in progress will be cleared and no message triggered.</dd>
    </dl>

    <h3>Details</h3>
    <p>This node can be used to create a timeout within a flow. By default, when
    it receives a message, it sends on a message with a <code>payload</code> of <code>1</code>.
    It then waits 250ms before sending a second message with a <code>payload</code> of <code>0</code>.
    This could be used, for example, to blink an LED attached to a Raspberry Pi GPIO pin.</p>
    <p>The payloads of each message sent can be configured to a variety of values, including
    the option to not send anything. For example, setting the initial message to <i>nothing</i> and
    selecting the option to extend the timer with each received message, the node will
    act as a watchdog timer; only sending a message if nothing is received within the
    set interval.</p>
    <p>If set to a <i>string</i> type, the node supports the mustache template syntax.</p>
    <p>If the node receives a message with a <code>reset</code> property, or a <code>payload</code>
    that matches that configured in the node, any timeout or repeat currently in
    progress will be cleared and no message triggered.</p>
    <p>The node can be configured to resend a message at a regular interval until it
    is reset by a received message.</p>
    <p>Optionally, the node can be configured to treat messages with <code>msg.topic</code> as if they
    are separate streams.</p>
</script>

</div><div><!-- --- [red-module:node-red/comment] --- -->

<script type="text/x-red" data-template-name="comment">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name">
    </div>
    <div class="form-row node-text-editor-row">
        <input type="hidden" id="node-input-info" autofocus="autofocus">
        <div style="height: 250px; min-height:150px;" class="node-text-editor" id="node-input-info-editor"></div>
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('comment',{
        category: 'function',
        color:"#ffffff",
        defaults: {
            name: {value:""},
            info: {value:""}
        },
        inputs:0,
        outputs:0,
        icon: "comment.png",
        label: function() {
            return this.name||this._("comment.comment");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        info: function() {
            return this.name?"# "+this.name+"\n\n---\n\n":"";
        },
        oneditprepare: function() {
            var that = this;
            this.editor = RED.editor.createEditor({
                id: 'node-input-info-editor',
                mode: 'ace/mode/markdown',
                value: $("#node-input-info").val()
            });
            this.editor.focus();
        },
        oneditsave: function() {
            $("#node-input-info").val(this.editor.getValue());
            this.editor.destroy();
            delete this.editor;
        },
        oneditcancel: function() {
            this.editor.destroy();
            delete this.editor;
        },
        oneditresize: function(size) {
            var rows = $("#dialog-form>div:not(.node-text-editor-row)");
            var height = $("#dialog-form").height();
            for (var i=0; i<rows.size(); i++) {
                height -= $(rows[i]).outerHeight(true);
            }
            var editorRow = $("#dialog-form>div.node-text-editor-row");
            height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));
            $(".node-text-editor").css("height",height+"px");
            this.editor.resize();
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="comment">
    <p>A node you can use to add comments to your flows.</p>
    <h3>Details</h3>
    <p>The edit panel will accept Markdown syntax. The text will be rendered into
    this information side panel.</p>
</script>

</div><div><!-- --- [red-module:node-red/unknown] --- -->

<script type="text/x-red" data-template-name="unknown">
    <div class="form-tips"><span data-i18n="[html]unknown.tip"></span></div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('unknown',{
        category: 'unknown',
        color:"#fff0f0",
        defaults: {
            name: {value:""}
        },
        inputs:1,
        outputs:1,
        icon: "",
        label: function() {
            return "("+this.name+")"||this._("unknown.label.unknown");
        },
        labelStyle: function() {
            return "node_label_unknown";
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="unknown">
    <p>This node is a type unknown to your installation of Node-RED.</p>
    <h3>Details</h3>
    <p><i>If you deploy with the node in this state, its configuration will be preserved, but
    the flow will not start until the missing type is installed.</i></p>
    <p>Use the <code>Menu - Manage Palette</code> option
    to search for and install nodes, or <b>npm install &lt;module&gt;</b> to
    install, any missing modules and restart Node-RED and reimport the nodes.</p>
    <p>It is possible this node type is already installed, but is missing a dependency. Check the Node-RED start-up
    log for any error messages associated with the missing node type.</p>
    <p>Otherwise, you should contact the author of the flow to obtain a copy of the missing node type.</p>
</script>

</div><div><!-- --- [red-module:node-red/rpi-gpio] --- -->
<style>
    .rpi-gpio-pinTable {
        width: 340px;
        display: inline-table;
        font-size: 13px;
        height: 380px;
        min-height: 380px;
        max-height: 380px;
    }
    .rpi-gpio-pinTable input[type="radio"] {
        width: auto;
        margin: 2px 2px;
    }
    .rpi-gpio-pinTable label {
        width: auto;
        margin: 0;
        display: block;
    }
    .rpi-gpio-pinTable .pinTableBody {
        width: 340px;
        display: table-row-group;
        line-height: 12px;
    }
    .rpi-gpio-pinTable .pinTableRow {
        width: 340px;
        display: table-row;
        height: 14px;
    }
    .rpi-gpio-pinTable .pinTableCellL {
        width: 170px;
        display: table-cell;
        text-align: right;
        padding-right: 4px;
        vertical-align: top;
        border: 1px solid #444;
    }
    .rpi-gpio-pinTable .pinTableCellR {
        width: 170px;
        display: table-cell;
        text-align: left;
        padding-left: 4px;
        vertical-align: top;
        border: 1px solid #000;
    }
    .rpi-gpio-pinTable .pinColorPower {
        background-color:#FECBCE;
    }
    .rpi-gpio-pinTable .pinColorGround {
        background-color:#DDDDDD;
    }
    .rpi-gpio-pinTable .pinColorGPIO {
        background-color:#BFEBBF;
    }
    .rpi-gpio-pinTable .pinColorDual {
        background-color:#D0E6F4;
    }
    .rpi-gpio-pinTable .pinColorSD {
        background-color:#FFFDD0;
    }
</style>
<script type="text/x-red" data-template-name="rpi-gpio in">

    <div class="form-row" style="min-width: 540px">
        <label><i class="fa fa-circle"></i> <span data-i18n="rpi-gpio.pinname"></span></label>
        <input type="text" id="node-input-pin" style="display:none;">
        <div class="rpi-gpio-pinTable">
            <div class="pinTableBody" id="pinform">
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorPower"><label>3.3V Power - 1 <input disabled type="radio" name="pins" value=""></label></div>
                    <div class="pinTableCellR pinColorPower"><label><input disabled type="radio" name="pins" value=""> 2 - 5V Power</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorDual"><label for="pinTable-pin-3">SDA1 - GPIO02 - 3 <input id="pinTable-pin-3" type="radio" name="pins" value="3"></label></div>
                    <div class="pinTableCellR pinColorPower"><label><input disabled type="radio" name="pins" value=""> 4 - 5V Power</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorDual"><label for="pinTable-pin-5">SCL1 - GPIO03 - 5 <input id="pinTable-pin-5" type="radio" name="pins" value="5"></label></div>
                    <div class="pinTableCellR pinColorGround"><label><input disabled type="radio" name="pins" value=""> 6 - Ground</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGPIO"><label for="pinTable-pin-7">GPIO04 - 7 <input id="pinTable-pin-7" type="radio" name="pins" value="7"></label></div>
                    <div class="pinTableCellR pinColorDual"><label for="pinTable-pin-8"><input id="pinTable-pin-8" type="radio" name="pins" value="8"> 8 - GPIO14 - TxD</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGround"><label>Ground - 9 <input disabled type="radio" name="pins" value=""></label></div>
                    <div class="pinTableCellR pinColorDual"><label for="pinTable-pin-10"><input id="pinTable-pin-10" type="radio" name="pins" value="10"> 10 - GPIO15 - RxD</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGPIO"><label for="pinTable-pin-11">GPIO17 - 11 <input id="pinTable-pin-11" type="radio" name="pins" value="11"></label></div>
                    <div class="pinTableCellR pinColorGPIO"><label for="pinTable-pin-12"><input id="pinTable-pin-12" type="radio" name="pins" value="12"> 12 - GPIO18</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGPIO"><label for="pinTable-pin-13">GPIO27 - 13 <input id="pinTable-pin-13" type="radio" name="pins" value="13"></label></div>
                    <div class="pinTableCellR pinColorGround"><label><input disabled type="radio" name="pins" value=""> 14 - Ground</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGPIO"><label for="pinTable-pin-15">GPIO22 - 15 <input id="pinTable-pin-15" type="radio" name="pins" value="15"></label></div>
                    <div class="pinTableCellR pinColorGPIO"><label for="pinTable-pin-16"><input id="pinTable-pin-16" type="radio" name="pins" value="16"> 16 - GPIO23</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorPower"><label>3.3V Power - 17 <input disabled type="radio" name="pins" value=""></label></div>
                    <div class="pinTableCellR pinColorGPIO"><label for="pinTable-pin-18"><input id="pinTable-pin-18" type="radio" name="pins" value="18"> 18 - GPIO24</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorDual"><label for="pinTable-pin-19">MOSI - GPIO10 - 19 <input id="pinTable-pin-19" type="radio" name="pins" value="19"></label></div>
                    <div class="pinTableCellR pinColorGround"><label><input disabled type="radio" name="pins" value=""> 20 - Ground</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorDual"><label for="pinTable-pin-21">MISO - GPIO09 - 21 <input id="pinTable-pin-21" type="radio" name="pins" value="21"></label></div>
                    <div class="pinTableCellR pinColorGPIO"><label for="pinTable-pin-22"><input id="pinTable-pin-22" type="radio" name="pins" value="22"> 22 - GPIO25</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorDual"><label for="pinTable-pin-23">SCLK - GPIO11 - 23 <input id="pinTable-pin-23" type="radio" name="pins" value="23"></label></div>
                    <div class="pinTableCellR pinColorDual"><label for="pinTable-pin-24"><input id="pinTable-pin-24" type="radio" name="pins" value="24"> 24 - GPIO8 - CE0</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGround"><label>Ground - 25 <input disabled type="radio" name="pins" value=""></label></div>
                    <div class="pinTableCellR pinColorDual"><label for="pinTable-pin-26"><input id="pinTable-pin-26" type="radio" name="pins" value="26"> 26 - GPIO7 - CE1</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorSD"><label>SD - 27 <input disabled type="radio" name="pins" value=""></label></div>
                    <div class="pinTableCellR pinColorSD"><label><input disabled type="radio" name="pins" value=""> 28 - SC</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGPIO"><label for="pinTable-pin-29">GPIO05 - 29 <input id="pinTable-pin-29" type="radio" name="pins" value="29"></label></div>
                    <div class="pinTableCellR pinColorGround"><label><input disabled type="radio" name="pins" value=""> 30 - Ground</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGPIO"><label for="pinTable-pin-31">GPIO06 - 31 <input id="pinTable-pin-31" type="radio" name="pins" value="31"></label></div>
                    <div class="pinTableCellR pinColorGPIO"><label for="pinTable-pin-32"><input id="pinTable-pin-32" type="radio" name="pins" value="32"> 32 - GPIO12</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGPIO"><label for="pinTable-pin-33">GPIO13 - 33 <input id="pinTable-pin-33" type="radio" name="pins" value="33"></label></div>
                    <div class="pinTableCellR pinColorGround"><label><input disabled type="radio" name="pins" value=""> 34 - Ground</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGPIO"><label for="pinTable-pin-35">GPIO19 - 35 <input id="pinTable-pin-35" type="radio" name="pins" value="35"></label></div>
                    <div class="pinTableCellR pinColorGPIO"><label for="pinTable-pin-36"><input id="pinTable-pin-36" type="radio" name="pins" value="36"> 36 - GPIO16</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGPIO"><label for="pinTable-pin-37">GPIO26 - 37 <input id="pinTable-pin-37" type="radio" name="pins" value="37"></label></div>
                    <div class="pinTableCellR pinColorGPIO"><label for="pinTable-pin-38"><input id="pinTable-pin-38" type="radio" name="pins" value="38"> 38 - GPIO20</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGround"><label>Ground - 39 <input disabled type="radio" name="pins" value=""></label></div>
                    <div class="pinTableCellR pinColorGPIO"><label for="pinTable-pin-40"><input id="pinTable-pin-40" type="radio" name="pins" value="40"> 40 - GPIO21</label></div>
                </div>
            </div>
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-intype"><i class="fa fa-level-up"></i> <span data-i18n="rpi-gpio.label.resistor"></span></label>
        <select type="text" id="node-input-intype" style="width:100px;">
        <option value="tri" data-i18n="rpi-gpio.resistor.none"></option>
        <option value="up" data-i18n="rpi-gpio.resistor.pullup"></option>
        <option value="down" data-i18n="rpi-gpio.resistor.pulldown"></option>
        </select>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-i18n="rpi-gpio.label.debounce"></span>
        <input type="text" id="node-input-debounce" style="width:47px; text-align:right"/>&nbsp;mS
    </div>
    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-read" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-read" style="width:70%;"><span data-i18n="rpi-gpio.label.readinitial"></span></label>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-tips" id="pin-tip"><span data-i18n="[html]rpi-gpio.tip.pin"></span></div>
    <div class="form-tips"><span data-i18n="[html]rpi-gpio.tip.in"></span></div>
</script>

<script type="text/javascript">
    var bcm2pin = {
        "2":"3", "3":"5", "4":"7", "14":"8", "15":"10", "17":"11", "18":"12", "27":"13", "22":"15",
        "23":"16", "24":"18", "10":"19", "9":"21", "25":"22", "11":"23", "8":"24", "7":"26",
        "5":"29", "6":"31", "12":"32", "13":"33", "19":"35", "16":"36", "26":"37", "20":"38", "21":"40"
    };
    var pinsInUse = {};
    RED.nodes.registerType('rpi-gpio in',{
        category: 'Raspberry Pi',
        color:"#c6dbef",
        defaults: {
            name: { value:"" },
            pin: { value:"tri",required:true,validate:RED.validators.number() },
            intype: { value:"tri" },
            debounce: { value:"25" },
            read: { value:false }
        },
        inputs:0,
        outputs:1,
        icon: "rpi.png",
        info: function() {
            if ( Object.keys(pinsInUse).length !== 0 ) {
                return "**Pins in use** : "+Object.keys(pinsInUse);
            }
            else { return ""; }
        },
        label: function() {
            var suf = "";
            if (this.intype === "up") { suf = "↑ "}
            if (this.intype === "down") { suf = "↓ "}
            return this.name || "PIN: "+suf+this.pin ;
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        outputLabels: function() { return "GPIO"+this.pin; },
        oneditprepare: function() {
            var pinnow = this.pin;
            var pintip = this._("rpi-gpio.tip.pin");
            var pinname = this._("rpi-gpio.pinname");
            var alreadyuse = this._("rpi-gpio.alreadyuse");
            var alreadyset = this._("rpi-gpio.alreadyset");

            $.getJSON('rpi-pins/'+this.id,function(data) {
                pinsInUse = data || {};
                $('#pin-tip').html(pintip + Object.keys(data));
            });
            $("#node-input-pin").change(function() {
                if ($("#node-input-pin").val()) {
                    $("#pinform input[value="+$("#node-input-pin").val()+"]").prop('checked', true);
                }
                var pinnew = $("#node-input-pin").val();
                if ((pinnew) && (pinnew !== pinnow)) {
                    if (pinsInUse.hasOwnProperty(pinnew)) {
                        RED.notify(pinname+" "+pinnew+" "+alreadyuse,"warn");
                    }
                    pinnow = pinnew;
                }
            });
            $("#node-input-intype").change(function() {
                var newtype = $("#node-input-intype").val();
                if ((pinsInUse.hasOwnProperty(pinnow)) && (pinsInUse[pinnow] !== newtype)) {
                    RED.notify(pinname+" "+pinnow+" "+alreadyset+" "+pinsInUse[pinnow],"error");
                }
            });
            $('#pinform input').on('change', function() {
                this.pin = $("#pinform input[type='radio']:checked").val();
                $("#node-input-pin").val(this.pin);
            });
        }
    });
</script>

<script type="text/x-red" data-template-name="rpi-gpio out">
    <div class="form-row" style="min-width: 540px">
        <label><i class="fa fa-circle"></i> <span data-i18n="rpi-gpio.pinname"></span></label>
        <input type="text" id="node-input-pin" style="display:none;">
        <div class="rpi-gpio-pinTable">
            <div class="pinTableBody" id="pinform">
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorPower"><label>3.3V Power - 1 <input disabled type="radio" name="pins" value=""></label></div>
                    <div class="pinTableCellR pinColorPower"><label><input disabled type="radio" name="pins" value=""> 2 - 5V Power</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorDual"><label for="pinTable-pin-3">SDA1 - GPIO02 - 3 <input id="pinTable-pin-3" type="radio" name="pins" value="3"></label></div>
                    <div class="pinTableCellR pinColorPower"><label><input disabled type="radio" name="pins" value=""> 4 - 5V Power</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorDual"><label for="pinTable-pin-5">SCL1 - GPIO03 - 5 <input id="pinTable-pin-5" type="radio" name="pins" value="5"></label></div>
                    <div class="pinTableCellR pinColorGround"><label><input disabled type="radio" name="pins" value=""> 6 - Ground</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGPIO"><label for="pinTable-pin-7">GPIO04 - 7 <input id="pinTable-pin-7" type="radio" name="pins" value="7"></label></div>
                    <div class="pinTableCellR pinColorDual"><label for="pinTable-pin-8"><input id="pinTable-pin-8" type="radio" name="pins" value="8"> 8 - GPIO14 - TxD</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGround"><label>Ground - 9 <input disabled type="radio" name="pins" value=""></label></div>
                    <div class="pinTableCellR pinColorDual"><label for="pinTable-pin-10"><input id="pinTable-pin-10" type="radio" name="pins" value="10"> 10 - GPIO15 - RxD</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGPIO"><label for="pinTable-pin-11">GPIO17 - 11 <input id="pinTable-pin-11" type="radio" name="pins" value="11"></label></div>
                    <div class="pinTableCellR pinColorGPIO"><label for="pinTable-pin-12"><input id="pinTable-pin-12" type="radio" name="pins" value="12"> 12 - GPIO18</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGPIO"><label for="pinTable-pin-13">GPIO27 - 13 <input id="pinTable-pin-13" type="radio" name="pins" value="13"></label></div>
                    <div class="pinTableCellR pinColorGround"><label><input disabled type="radio" name="pins" value=""> 14 - Ground</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGPIO"><label for="pinTable-pin-15">GPIO22 - 15 <input id="pinTable-pin-15" type="radio" name="pins" value="15"></label></div>
                    <div class="pinTableCellR pinColorGPIO"><label for="pinTable-pin-16"><input id="pinTable-pin-16" type="radio" name="pins" value="16"> 16 - GPIO23</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorPower"><label>3.3V Power - 17 <input disabled type="radio" name="pins" value=""></label></div>
                    <div class="pinTableCellR pinColorGPIO"><label for="pinTable-pin-18"><input id="pinTable-pin-18" type="radio" name="pins" value="18"> 18 - GPIO24</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorDual"><label for="pinTable-pin-19">MOSI - GPIO10 - 19 <input id="pinTable-pin-19" type="radio" name="pins" value="19"></label></div>
                    <div class="pinTableCellR pinColorGround"><label><input disabled type="radio" name="pins" value=""> 20 - Ground</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorDual"><label for="pinTable-pin-21">MISO - GPIO09 - 21 <input id="pinTable-pin-21" type="radio" name="pins" value="21"></label></div>
                    <div class="pinTableCellR pinColorGPIO"><label for="pinTable-pin-22"><input id="pinTable-pin-22" type="radio" name="pins" value="22"> 22 - GPIO25</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorDual"><label for="pinTable-pin-23">SCLK - GPIO11 - 23 <input id="pinTable-pin-23" type="radio" name="pins" value="23"></label></div>
                    <div class="pinTableCellR pinColorDual"><label for="pinTable-pin-24"><input id="pinTable-pin-24" type="radio" name="pins" value="24"> 24 - GPIO8 - CE0</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGround"><label>Ground - 25 <input disabled type="radio" name="pins" value=""></label></div>
                    <div class="pinTableCellR pinColorDual"><label for="pinTable-pin-26"><input id="pinTable-pin-26" type="radio" name="pins" value="26"> 26 - GPIO7 - CE1</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorSD"><label>SD - 27 <input disabled type="radio" name="pins" value=""></label></div>
                    <div class="pinTableCellR pinColorSD"><label><input disabled type="radio" name="pins" value=""> 28 - SC</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGPIO"><label for="pinTable-pin-29">GPIO05 - 29 <input id="pinTable-pin-29" type="radio" name="pins" value="29"></label></div>
                    <div class="pinTableCellR pinColorGround"><label><input disabled type="radio" name="pins" value=""> 30 - Ground</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGPIO"><label for="pinTable-pin-31">GPIO06 - 31 <input id="pinTable-pin-31" type="radio" name="pins" value="31"></label></div>
                    <div class="pinTableCellR pinColorGPIO"><label for="pinTable-pin-32"><input id="pinTable-pin-32" type="radio" name="pins" value="32"> 32 - GPIO12</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGPIO"><label for="pinTable-pin-33">GPIO13 - 33 <input id="pinTable-pin-33" type="radio" name="pins" value="33"></label></div>
                    <div class="pinTableCellR pinColorGround"><label><input disabled type="radio" name="pins" value=""> 34 - Ground</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGPIO"><label for="pinTable-pin-35">GPIO19 - 35 <input id="pinTable-pin-35" type="radio" name="pins" value="35"></label></div>
                    <div class="pinTableCellR pinColorGPIO"><label for="pinTable-pin-36"><input id="pinTable-pin-36" type="radio" name="pins" value="36"> 36 - GPIO16</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGPIO"><label for="pinTable-pin-37">GPIO26 - 37 <input id="pinTable-pin-37" type="radio" name="pins" value="37"></label></div>
                    <div class="pinTableCellR pinColorGPIO"><label for="pinTable-pin-38"><input id="pinTable-pin-38" type="radio" name="pins" value="38"> 38 - GPIO20</label></div>
                </div>
                <div class="pinTableRow">
                    <div class="pinTableCellL pinColorGround"><label>Ground - 39 <input disabled type="radio" name="pins" value=""></label></div>
                    <div class="pinTableCellR pinColorGPIO"><label for="pinTable-pin-40"><input id="pinTable-pin-40" type="radio" name="pins" value="40"> 40 - GPIO21</label></div>
                </div>
            </div>
        </div>
    </div>
    <div class="form-row" id="node-set-pwm">
        <label>&nbsp;&nbsp;&nbsp;&nbsp;<span data-i18n="rpi-gpio.label.type"></span></label>
        <select id="node-input-out" style="width: 250px;">
            <option value="out" data-i18n="rpi-gpio.digout"></option>
            <option value="pwm" data-i18n="rpi-gpio.pwmout"></option>
        </select>
    </div>
    <div class="form-row" id="node-set-tick">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-set" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-set" style="width: 70%;"><span data-i18n="rpi-gpio.label.initpin"></span></label>
    </div>
    <div class="form-row" id="node-set-state">
        <label for="node-input-level">&nbsp;</label>
        <select id="node-input-level" style="width: 250px;">
            <option value="0" data-i18n="rpi-gpio.initpin0"></option>
            <option value="1" data-i18n="rpi-gpio.initpin1"></option>
        </select>
    </div>
    <div class="form-row" id="node-set-freq">
        <label for="node-input-freq"> <span data-i18n="rpi-gpio.label.freq"></span></label>
        <input type="text" id="node-input-freq" placeholder="100"> Hz
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-tips" id="pin-tip"><span data-i18n="[html]rpi-gpio.tip.pin"></span></div>
    <div class="form-tips" id="dig-tip"><span data-i18n="[html]rpi-gpio.tip.dig"></span></div>
    <div class="form-tips" id="pwm-tip"><span data-i18n="[html]rpi-gpio.tip.pwm"></span></div>
</script>

<script type="text/javascript">
    var bcm2pin = {
        "2":"3", "3":"5", "4":"7", "14":"8", "15":"10", "17":"11", "18":"12", "27":"13", "22":"15",
        "23":"16", "24":"18", "10":"19", "9":"21", "25":"22", "11":"23", "8":"24", "7":"26",
        "5":"29", "6":"31", "12":"32", "13":"33", "19":"35", "16":"36", "26":"37", "20":"38", "21":"40"
    };
    var pinsInUse = {};
    RED.nodes.registerType('rpi-gpio out',{
        category: 'Raspberry Pi',
        color:"#c6dbef",
        defaults: {
            name: { value:"" },
            pin: { value:"",required:true,validate:RED.validators.number() },
            set: { value:"" },
            level: { value:"0" },
            freq: {value:""},
            out: { value:"out" }
        },
        inputs:1,
        outputs:0,
        icon: "rpi.png",
        info: function() {
            if ( Object.keys(pinsInUse).length !== 0 ) {
                return "**Pins in use** : "+Object.keys(pinsInUse);
            }
            else { return ""; }
        },
        align: "right",
        label: function() {
            if (this.out === "pwm") { return this.name || "PWM: "+this.pin; }
            else if (this.out === "ser") { return this.name || "Servo: "+this.pin; }
            else {
                var suf = "";
                if (this.set == true) { suf = (this.level === "1") ? " ¹" : " ₀"; }
                return this.name||"PIN: "+ this.pin + suf ;
            }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        inputLabels: function() { return "GPIO"+this.pin; },
        oneditprepare: function() {
            var pinnow = this.pin;
            var pintip = this._("rpi-gpio.tip.pin");
            var pinname = this._("rpi-gpio.pinname");
            var alreadyuse = this._("rpi-gpio.alreadyuse");
            var alreadyset = this._("rpi-gpio.alreadyset");
            if (!$("#node-input-out").val()) { $("#node-input-out").val("out"); }

            $.getJSON('rpi-pins/'+this.id,function(data) {
                pinsInUse = data || {};
                $('#pin-tip').html(pintip + Object.keys(data));
            });

            $("#node-input-pin").change(function() {
                if ($("#node-input-pin").val()) {
                    $("#pinform input[value="+$("#node-input-pin").val()+"]").prop('checked', true);
                }
                var pinnew = $("#node-input-pin").val();
                if ((pinnew) && (pinnew !== pinnow)) {
                    if (pinsInUse.hasOwnProperty(pinnew)) {
                        RED.notify(pinname+" "+pinnew+" "+alreadyuse,"warn");
                    }
                    pinnow = pinnew;
                }
            });

            $("#node-input-out").change(function() {
                var newtype = $("#node-input-out").val();
                if ((pinsInUse.hasOwnProperty(pinnow)) && (pinsInUse[pinnow] !== newtype)) {
                    RED.notify(pinname+" "+pinnow+" "+alreadyset+" "+pinsInUse[pinnow],"error");
                }
            });

            var hidestate = function () {
                if ($("#node-input-out").val() === "pwm") {
                    $('#node-set-tick').hide();
                    $('#node-set-state').hide();
                    $('#node-input-set').prop('checked', false);
                    $("#dig-tip").hide();
                    $("#pwm-tip").show();
                    $('#node-set-freq').show();
                }
                else {
                    $('#node-set-tick').show();
                    $("#dig-tip").show();
                    $("#pwm-tip").hide();
                    $('#node-set-freq').hide();
                }
            };
            $("#node-input-out").change(function () { hidestate(); });
            hidestate();

            var setstate = function () {
                if ($('#node-input-set').is(":checked")) {
                    $("#node-set-state").show();
                } else {
                    $("#node-set-state").hide();
                }
            };
            $("#node-input-set").change(function () { setstate(); });
            setstate();

            $('#pinform input').on('change', function() {
                this.pin = $("#pinform input[type='radio']:checked").val();
                $("#node-input-pin").val(this.pin);
            });
        }
    });
</script>

<script type="text/x-red" data-template-name="rpi-mouse">
    <div class="form-row">
        <label for="node-input-butt"><i class="fa fa-circle"></i> <span data-i18n="rpi-gpio.label.button"></span></label>
        <select type="text" id="node-input-butt" style="width: 250px;">
            <option value="1" data-i18n="rpi-gpio.left"></option>
            <option value="2" data-i18n="rpi-gpio.right"></option>
            <option value="4" data-i18n="rpi-gpio.middle"></option>
            <option value="7" data-i18n="rpi-gpio.any"></option>
         </select>
    </div>
    <br/>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('rpi-mouse',{
        category: 'Raspberry Pi',
        color:"#c6dbef",
        defaults: {
            name: { value:"" },
            butt: { value:"1",required:true }
        },
        inputs:0,
        outputs:1,
        icon: "rpi.png",
        label: function() {
            var na = this._("rpi-gpio.label.pimouse");
            if (this.butt === "1") { na += " "+this._("rpi-gpio.label.left"); }
            if (this.butt === "2") { na += " "+this._("rpi-gpio.label.right"); }
            if (this.butt === "4") { na += " "+this._("rpi-gpio.label.middle"); }
            return this.name||na;
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        }
    });
</script>

<script type="text/x-red" data-template-name="rpi-keyboard">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('rpi-keyboard',{
        category: 'Raspberry Pi',
        color:"#c6dbef",
        defaults: {
            name: { value:"" }
        },
        inputs:0,
        outputs:1,
        icon: "rpi.png",
        label: function() {
            return this.name || this._("rpi-gpio.label.pikeyboard");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="rpi-gpio in">
    <p>Raspberry Pi input node. Generates a <code>msg.payload</code> with either a
    0 or 1 depending on the state of the input pin.</p>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">number</span></dt>
        <dd>the payload will be a 1 or a 0.</dd>
        <dt>topic <span class="property-type">string</span></dt>
        <dd>the topic will be set to <code>pi/{the pin number}</code>.</dd>
    </dl>
    <h3>Details</h3>
    <p>You may also enable the input pullup resistor or the pulldown resistor.</p>
    <p>Requires the RPi.GPIO python library version 0.5.10 (or better) in order to work.</p>
</script>

<script type="text/x-red" data-help-name="rpi-gpio out">
    <p>Raspberry Pi output node. Can be used in Digital or PWM modes.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">number | string | boolean</span></dt>
    </dl>
    <h3>Details</h3>
    <p>Digital mode - expects a <code>msg.payload</code> with either a 0 or 1 (or true or false),
    and will set the selected physical pin high or low depending on the value passed in.</p>
    <p>The initial value of the pin at deploy time can also be set to 0 or 1.</p>
    <p>PWM mode - expects an input value of a number 0 - 100. It can be floating point.</p>
    <p>PWM mode can be used to drive a servo using input values between 10 and 20 only,
    but will accept floating point values.
    The GPIO2 pin is best for this as it uses hardware to do the PWM. For better servo support
    consider the alternative node-red-node-pi-gpiod node.</p>
    <p>Requires the RPi.GPIO python library version 0.5.10 (or better) in order to work.</p>
</script>

<script type="text/x-red" data-help-name="rpi-mouse">
    <p>Raspberry Pi mouse button node. Requires a USB mouse.</p>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">number</span></dt>
        <dd>1 or 0 when the selected mouse button is pressed and released.</dd>
        <dt>button <span class="property-type">number</span></dt>
        <dd>1, 2, 4 corresponding to left, right and middle buttons, so you
        can work out which button or combination was pressed.</dd>
        <dt>topic <span class="property-type">string</span></dt>
        <dd>set to <code>pi/mouse</code></dd>
    </dl>
</script>

<script type="text/x-red" data-help-name="rpi-keyboard">
    <p>Raspberry Pi keyboard handling node. Requires a USB keyboard.</p>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">number</span></dt>
        <dd>contains the keycode value</dd>
        <dt>action <span class="property-type">string</span></dt>
        <dd>set to "up", "down", or "repeat"</dd>
        <dt>topic <span class="property-type">string</span></dt>
        <dd>set to <code>pi/key</code></dd>
    </dl>
</script>

</div><div><!-- --- [red-module:node-red/tls] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="tls-config">
    <div class="form-row" class="hide" id="node-config-row-uselocalfiles">
        <input type="checkbox" id="node-config-input-uselocalfiles" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-config-input-uselocalfiles" style="width: 70%;"><span data-i18n="tls.label.use-local-files"></label>
    </div>
    <div class="form-row">
        <label style="width: 120px;"><i class="fa fa-file-text-o"></i> <span data-i18n="tls.label.cert"></span></label>
        <span class="tls-config-input-data">
            <label class="editor-button" for="node-config-input-certfile"><i class="fa fa-upload"></i> <span data-i18n="tls.label.upload"></span></label>
            <input class="hide" type="file" id="node-config-input-certfile">
            <span id="tls-config-certname" style="width: calc(100% - 280px); overflow: hidden; line-height:34px; height:34px; text-overflow: ellipsis; white-space: nowrap; display: inline-block; vertical-align: middle;"> </span>
            <button class="editor-button editor-button-small" id="tls-config-button-cert-clear" style="margin-left: 10px"><i class="fa fa-times"></i></button>
        </span>
        <input type="hidden" id="node-config-input-certname">
        <input type="hidden" id="node-config-input-certdata">
        <input class="hide tls-config-input-path" style="width: calc(100% - 170px);" type="text" id="node-config-input-cert" data-i18n="[placeholder]tls.placeholder.cert">
    </div>
    <div class="form-row">
        <label style="width: 120px;" for="node-config-input-key"><i class="fa fa-file-text-o"></i> <span data-i18n="tls.label.key"></span></label>
        <span class="tls-config-input-data">
            <label class="editor-button" for="node-config-input-keyfile"><i class="fa fa-upload"></i> <span data-i18n="tls.label.upload"></span></label>
            <input class="hide" type="file" id="node-config-input-keyfile">
            <span id="tls-config-keyname" style="width: calc(100% - 280px); overflow: hidden; line-height:34px; height:34px; text-overflow: ellipsis; white-space: nowrap; display: inline-block; vertical-align: middle;"> </span>
            <button class="editor-button editor-button-small" id="tls-config-button-key-clear" style="margin-left: 10px"><i class="fa fa-times"></i></button>
        </span>
        <input type="hidden" id="node-config-input-keyname">
        <input type="hidden" id="node-config-input-keydata">
        <input class="hide tls-config-input-path" style="width: calc(100% - 170px);" type="text" id="node-config-input-key" data-i18n="[placeholder]tls.placeholder.key">
    </div>
    <div class="form-row">
        <label style="width: 100px; margin-left: 20px;" for="node-config-input-passphrase"> <span data-i18n="tls.label.passphrase"></span></label>
        <input type="password" style="width: calc(100% - 170px);" id="node-config-input-passphrase" data-i18n="[placeholder]tls.placeholder.passphrase">
    </div>
    <div class="form-row">
        <label style="width: 120px;" for="node-config-input-ca"><i class="fa fa-file-text-o"></i> <span data-i18n="tls.label.ca"></span></label>
        <span class="tls-config-input-data">
            <label class="editor-button" for="node-config-input-cafile"><i class="fa fa-upload"></i> <span data-i18n="tls.label.upload"></span></label>
            <input class="hide" type="file" title=" " id="node-config-input-cafile">
            <span id="tls-config-caname" style="width: calc(100% - 280px); overflow: hidden; line-height:34px; height:34px; text-overflow: ellipsis; white-space: nowrap; display: inline-block; vertical-align: middle;"> </span>
            <button class="editor-button editor-button-small" id="tls-config-button-ca-clear" style="margin-left: 10px"><i class="fa fa-times"></i></button>
        </span>
        <input type="hidden" id="node-config-input-caname">
        <input type="hidden" id="node-config-input-cadata">
        <input class="hide tls-config-input-path" style="width: calc(100% - 170px);" type="text" id="node-config-input-ca" data-i18n="[placeholder]tls.placeholder.ca">
    </div>
    <div class="form-row">
        <input type="checkbox" id="node-config-input-verifyservercert" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-config-input-verifyservercert" style="width: calc(100% - 170px);" data-i18n="tls.label.verify-server-cert"></label>
    </div>
    <div class="form-row">
        <label style="width: 120px;" for="node-config-input-servername"><i class="fa fa-server"></i> <span data-i18n="tls.label.servername"></span></label>
        <input style="width: calc(100% - 170px);" type="text" id="node-config-input-servername" data-i18n="[placeholder]tls.placeholder.servername">
    </div>
    <hr>
    <div class="form-row">
        <label style="width: 120px;" for="node-config-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input style="width: calc(100% - 170px);" type="text" id="node-config-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('tls-config',{
        category: 'config',
        defaults: {
            name: {value:""},
            cert: {value:"", validate: function(v) {
                var currentKey = $("#node-config-input-key").val();
                if (currentKey === undefined) {
                    currentKey = this.key;
                }
                return currentKey === '' || v != '';
            }},
            key: {value:"", validate: function(v) {
                var currentCert = $("#node-config-input-cert").val();
                if (currentCert === undefined) {
                    currentCert = this.cert;
                }
                return currentCert === '' || v != '';
            }},
            ca: {value:""},
            certname: {value:""},
            keyname: {value:""},
            caname: {value:""},
            servername: {value:""},
            verifyservercert: {value: true}
        },
        credentials: {
            certdata: {type:"text"},
            keydata: {type:"text"},
            cadata: {type:"text"},
            passphrase: {type:"password"}
        },
        label: function() {
            return this.name || this._("tls.tls");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            function updateFileUpload() {
                if ($("#node-config-input-uselocalfiles").is(':checked')) {
                    $(".tls-config-input-path").show();
                    $(".tls-config-input-data").hide();
                } else {
                    $(".tls-config-input-data").show();
                    $(".tls-config-input-path").hide();
                }
            }
            $("#node-config-input-uselocalfiles").on("click",function() {
                updateFileUpload();
            });

            function saveFile(property, file) {
                var dataInputId = "#node-config-input-"+property+"data";
                var filenameInputId = "#node-config-input-"+property+"name";
                var filename = file.name;
                var reader = new FileReader();
                reader.onload = function(event) {
                    $("#tls-config-"+property+"name").text(filename);
                    $(filenameInputId).val(filename);
                    $(dataInputId).val(event.target.result);
                }
                reader.readAsText(file,"UTF-8");
            }
            $("#node-config-input-certfile" ).change(function() {
                saveFile("cert", this.files[0]);
            });
            $("#node-config-input-keyfile" ).change(function() {
                saveFile("key", this.files[0]);
            });
            $("#node-config-input-cafile" ).change(function() {
                saveFile("ca", this.files[0]);
            });

            function clearNameData(prop) {
                $("#tls-config-"+prop+"name").text("");
                $("#node-config-input-"+prop+"data").val("");
                $("#node-config-input-"+prop+"name").val("");
            }
            $("#tls-config-button-cert-clear").click(function() {
                clearNameData("cert");
            });
            $("#tls-config-button-key-clear").click(function() {
                clearNameData("key");
            });
            $("#tls-config-button-ca-clear").click(function() {
                clearNameData("ca");
            });

            if (RED.settings.tlsConfigDisableLocalFiles) {
                $("#node-config-row-uselocalfiles").hide();
            } else {
                $("#node-config-row-uselocalfiles").show();
            }
            // in case paths were set from old TLS config
            if(this.cert || this.key || this.ca) {
                $("#node-config-input-uselocalfiles").prop('checked',true);
            }
            $("#tls-config-certname").text(this.certname);
            $("#tls-config-keyname").text(this.keyname);
            $("#tls-config-caname").text(this.caname);
            updateFileUpload();
        },
        oneditsave: function() {
            if ($("#node-config-input-uselocalfiles").is(':checked')) {
                clearNameData("ca");
                clearNameData("cert");
                clearNameData("key");
            } else {
                $("#node-config-input-ca").val("");
                $("#node-config-input-cert").val("");
                $("#node-config-input-key").val("");
            }
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="tls-config">
    <p>Configuration options for TLS connections.</p>
</script>

</div><div><!-- --- [red-module:node-red/httpproxy] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="http proxy">
    <div class="form-row">
        <label for="node-config-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-config-input-name">
    </div>
    <div class="form-row">
        <label for="node-config-input-url"><i class="fa fa-globe"></i> <span data-i18n="httpin.label.url"></span></label>
        <input type="text" id="node-config-input-url" placeholder="http://hostname:port">
    </div>
    <div class="form-row">
        <input type="checkbox" id="node-config-input-useAuth" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-config-input-useAuth" style="width: 70%;"><span data-i18n="httpin.use-proxyauth"></span></label>
        <div style="margin-left: 20px" class="node-config-input-useAuth-row hide">
            <div class="form-row">
                <label for="node-config-input-username"><i class="fa fa-user"></i> <span data-i18n="common.label.username"></span></label>
                <input type="text" id="node-config-input-username">
            </div>
            <div class="form-row">
                <label for="node-config-input-password"><i class="fa fa-lock"></i> <span data-i18n="common.label.password"></span></label>
                <input type="password" id="node-config-input-password">
            </div>
        </div>
    </div>
    <div class="form-row" style="margin-bottom:0;">
        <label><i class="fa fa-list"></i> <span data-i18n="httpin.noproxy-hosts"></span></label>
    </div>
    <div class="form-row node-config-input-noproxy-container-row">
        <ol id="node-config-input-noproxy-container"></ol>
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('http proxy', {
        category: 'config',
        defaults: {
            name: {value:''},
            url: {value:'',validate:function(v) { return (v && (v.indexOf('://') !== -1) && (v.trim().indexOf('http') === 0)); }},
            noproxy: {value:[]}
        },
        credentials: {
            username: {type:'text'},
            password: {type:'password'}
        },
        label: function() {
            return this.name || this.url || ('http proxy:' + this.id);
        },
        oneditprepare: function() {
            $('#node-config-input-useAuth').change(function() {
                if ($(this).is(":checked")) {
                    $('.node-config-input-useAuth-row').show();
                } else {
                    $('.node-config-input-useAuth-row').hide();
                    $('#node-config-input-username').val('');
                    $('#node-config-input-password').val('');
                }
            });
            if (this.credentials.username || this.credentials.has_password) {
                $('#node-config-input-useAuth').prop('checked', true);
            } else {
                $('#node-config-input-useAuth').prop('checked', false);
            }
            $('#node-config-input-useAuth').change();

            var hostList = $('#node-config-input-noproxy-container')
                .css({'min-height':'150px','min-width':'450px'})
                .editableList({
                    addItem: function(container, index, data) {
                        var row = $('<div></div>')
                            .css({overflow: 'hidden',whiteSpace: 'nowrap'})
                            .appendTo(container);

                        var hostField = $('<input/>',{class:'node-config-input-host',type:'text',placeholder:'hostname'})
                            .css({width:'100%'})
                            .appendTo(row);
                        if (data.host) {
                            hostField.val(data.host);
                        }
                    },
                    removable: true
                });
            if (this.noproxy) {
                for (var i in this.noproxy) {
                    hostList.editableList('addItem', {host:this.noproxy[i]});
                }
            }
            if (hostList.editableList('items').length == 0) {
                hostList.editableList('addItem', {host:''});
            }
        },
        oneditsave: function() {
            var hosts = $('#node-config-input-noproxy-container').editableList('items');
            var node = this;
            node.noproxy = [];
            hosts.each(function(i) {
                var host = $(this).find('.node-config-input-host').val().trim();
                if (host) {
                    node.noproxy.push(host);
                }
            });
        },
        oneditresize: function(size) {
            var rows = $('#node-config-dialog-edit-form>div:not(.node-config-input-noproxy-container-row)');
            var height = size.height;
            for (var i = 0; i < rows.size(); i++) {
                height -= $(rows[i]).outerHeight(true);
            }

            var editorRow = $('#node-config-dialog-edit-form>div.node-config-input-noproxy-container-row');
            height -= (parseInt(editorRow.css('margin-top')) + parseInt(editorRow.css('margin-bottom')));
            $('#node-config-input-noproxy-container').editableList('height',height);
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="http proxy">
    <p>Configuration options for HTTP proxy.</p>

    <h3>Details</h3>
    <p>When accessing to the host in the ignored host list, no proxy will be used.</p>
</script>

</div><div><!-- --- [red-module:node-red/mqtt] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
  http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="mqtt in">
    <div class="form-row">
        <label for="node-input-broker"><i class="fa fa-globe"></i> <span data-i18n="mqtt.label.broker"></span></label>
        <input type="text" id="node-input-broker">
    </div>
    <div class="form-row">
        <label for="node-input-topic"><i class="fa fa-tasks"></i> <span data-i18n="common.label.topic"></span></label>
        <input type="text" id="node-input-topic" data-i18n="[placeholder]common.label.topic">
    </div>
    <div class="form-row">
        <label for="node-input-qos"><i class="fa fa-empire"></i> <span data-i18n="mqtt.label.qos"></span></label>
        <select id="node-input-qos" style="width:125px !important">
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-datatype"><i class="fa fa-sign-out"></i> <span data-i18n="mqtt.label.output"></span></label>
        <select id="node-input-datatype" style="width:70%;">
            <option value="auto" data-i18n="mqtt.output.auto"></option>
            <option value="buffer" data-i18n="mqtt.output.buffer"></option>
            <option value="utf8" data-i18n="mqtt.output.string"></option>
            <option value="json" data-i18n="mqtt.output.json"></option>
            <option value="base64" data-i18n="mqtt.output.base64"></option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('mqtt in',{
        category: 'input',
        defaults: {
            name: {value:""},
            topic: {value:"",required:true,validate: RED.validators.regex(/^(#$|(\+|[^+#]*)(\/(\+|[^+#]*))*(\/(\+|#|[^+#]*))?$)/)},
            qos: {value: "2"},
            datatype: {value:"auto",required:true},
            broker: {type:"mqtt-broker", required:true}
        },
        color:"#d8bfd8",
        inputs:0,
        outputs:1,
        icon: "bridge.png",
        label: function() {
            return this.name||this.topic||"mqtt";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (this.qos === undefined) {
                $("#node-input-qos").val("2");
            }
            if (this.datatype === undefined) {
                $("#node-input-datatype").val("auto");
            }
        }
    });
</script>

<script type="text/x-red" data-template-name="mqtt out">
    <div class="form-row">
        <label for="node-input-broker"><i class="fa fa-globe"></i> <span data-i18n="mqtt.label.broker"></span></label>
        <input type="text" id="node-input-broker">
    </div>
    <div class="form-row">
        <label for="node-input-topic"><i class="fa fa-tasks"></i> <span data-i18n="common.label.topic"></span></label>
        <input type="text" id="node-input-topic" data-i18n="[placeholder]common.label.topic">
    </div>
    <div class="form-row">
        <label for="node-input-qos"><i class="fa fa-empire"></i> <span data-i18n="mqtt.label.qos"></span></label>
        <select id="node-input-qos" style="width:125px !important">
            <option value=""></option>
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
        </select>
        &nbsp;&nbsp;<i class="fa fa-history"></i>&nbsp;<span data-i18n="mqtt.retain"></span> &nbsp;<select id="node-input-retain" style="width:125px !important">
            <option value=""></option>
            <option value="false" data-i18n="mqtt.false"></option>
            <option value="true" data-i18n="mqtt.true"></option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-tips"><span data-i18n="mqtt.tip"></span></div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('mqtt out',{
        category: 'output',
        defaults: {
            name: {value:""},
            topic: {value:""},
            qos: {value:""},
            retain: {value:""},
            broker: {type:"mqtt-broker", required:true}
        },
        color:"#d8bfd8",
        inputs:1,
        outputs:0,
        icon: "bridge.png",
        align: "right",
        label: function() {
            return this.name||this.topic||"mqtt";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        }
    });
</script>

<script type="text/x-red" data-template-name="mqtt-broker">
    <div class="form-row">
        <label for="node-config-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-config-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-row">
        <ul style="background: #fff; min-width: 600px; margin-bottom: 20px;" id="node-config-mqtt-broker-tabs"></ul>
    </div>
    <div id="node-config-mqtt-broker-tabs-content" style="min-height: 170px;">
        <div id="mqtt-broker-tab-connection" style="display:none">
            <div class="form-row node-input-broker">
                <label for="node-config-input-broker"><i class="fa fa-globe"></i> <span data-i18n="mqtt.label.broker"></span></label>
                <input class="input-append-left" type="text" id="node-config-input-broker" style="width:40%;" data-i18n="[placeholder]mqtt.label.example">
                <label for="node-config-input-port" style="margin-left:20px; width:43px; "> <span data-i18n="mqtt.label.port"></span></label>
                <input type="text" id="node-config-input-port" data-i18n="[placeholder]mqtt.label.port" style="width:55px">
            </div>
            <div class="form-row">
                <input type="checkbox" id="node-config-input-usetls" style="display: inline-block; width: auto; vertical-align: top;">
                <label for="node-config-input-usetls" style="width: auto" data-i18n="mqtt.label.use-tls"></label>
                <div id="node-config-row-tls" class="hide">
                    <label style="width: auto; margin-left: 20px; margin-right: 10px;" for="node-config-input-tls"><span data-i18n="mqtt.label.tls-config"></span></label><input style="width: 300px;" type="text" id="node-config-input-tls">
                </div>
            </div>
            <div class="form-row">
                <label for="node-config-input-clientid"><i class="fa fa-tag"></i> <span data-i18n="mqtt.label.clientid"></span></label>
                <input type="text" id="node-config-input-clientid" data-i18n="[placeholder]mqtt.placeholder.clientid">
            </div>
            <div class="form-row">
                <label for="node-config-input-keepalive" style="width: auto"><i class="fa fa-clock-o"></i> <span data-i18n="mqtt.label.keepalive"></span></label>
                <input type="text" id="node-config-input-keepalive" style="width: 50px">
                <input type="checkbox" id="node-config-input-cleansession" style="margin-left: 30px; height: 1em;display: inline-block; width: auto; vertical-align: middle;">
                <label for="node-config-input-cleansession" style="width: auto;" data-i18n="mqtt.label.cleansession"></label>
            </div>
            <div class="form-row">
                <input type="checkbox" id="node-config-input-compatmode" style="display: inline-block; width: auto; vertical-align: top;">
                <label for="node-config-input-compatmode" style="width: auto;" data-i18n="mqtt.label.compatmode"></label>
            </div>
        </div>
        <div id="mqtt-broker-tab-security" style="display:none">
            <div class="form-row">
                <label for="node-config-input-user"><i class="fa fa-user"></i> <span data-i18n="common.label.username"></span></label>
                <input type="text" id="node-config-input-user">
            </div>
            <div class="form-row">
                <label for="node-config-input-password"><i class="fa fa-lock"></i> <span data-i18n="common.label.password"></span></label>
                <input type="password" id="node-config-input-password">
            </div>
        </div>
        <div id="mqtt-broker-tab-messages" style="display:none">
            <div id="mqtt-broker-section-birth">
                <div class="palette-header">
                    <i class="fa fa-angle-down"></i><span data-i18n="mqtt.sections-label.birth-message"></span>
                </div>
                <div class="section-content" style="padding:10px 0 0 10px">
                    <div class="form-row">
                        <label style="width: 100px !important;" for="node-config-input-birthTopic"><i class="fa fa-tasks"></i> <span data-i18n="common.label.topic"></span></label>
                        <input style="width: calc(100% - 300px) !important" type="text" id="node-config-input-birthTopic" data-i18n="[placeholder]mqtt.placeholder.birth-topic">
                        <label style="margin-left: 10px; width: 90px !important;" for="node-config-input-birthRetain"><i class="fa fa-history"></i> <span data-i18n="mqtt.label.retain"></span></label>
                        <select id="node-config-input-birthRetain" style="width:75px !important">
                            <option value="false" data-i18n="mqtt.false"></option>
                            <option value="true" data-i18n="mqtt.true"></option>
                        </select>
                    </div>
                    <div class="form-row">
                        <label style="width: 100px !important;" for="node-config-input-birthPayload"><i class="fa fa-envelope"></i> <span data-i18n="common.label.payload"></span></label>
                        <input style="width: calc(100% - 300px) !important" type="text" id="node-config-input-birthPayload" style="width:300px" data-i18n="[placeholder]common.label.payload">
                        <label style="margin-left: 10px; width: 90px !important;" for="node-config-input-birthQos"><i class="fa fa-empire"></i> <span data-i18n="mqtt.label.qos"></span></label>
                        <select id="node-config-input-birthQos" style="width:75px !important">
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                        </select>
                    </div>
                </div>
            </div>
            <div id="mqtt-broker-section-close">
                <div class="palette-header">
                    <i class="fa fa-angle-down"></i><span data-i18n="mqtt.sections-label.close-message"></span>
                </div>
                <div class="section-content" style="padding:10px 0 0 10px">
                    <div class="form-row">
                        <label style="width: 100px !important;" for="node-config-input-closeTopic"><i class="fa fa-tasks"></i> <span data-i18n="common.label.topic"></span></label>
                        <input style="width: calc(100% - 300px) !important" type="text" id="node-config-input-closeTopic" style="width:300px" data-i18n="[placeholder]mqtt.placeholder.close-topic">
                        <label style="margin-left: 10px; width: 90px !important;" for="node-config-input-closeRetain"><i class="fa fa-history"></i> <span data-i18n="mqtt.label.retain"></span></label>
                        <select id="node-config-input-closeRetain" style="width:75px !important">
                            <option value="false" data-i18n="mqtt.false"></option>
                            <option value="true" data-i18n="mqtt.true"></option>
                        </select>
                    </div>
                    <div class="form-row">
                        <label style="width: 100px !important;" for="node-config-input-closePayload"><i class="fa fa-envelope"></i> <span data-i18n="common.label.payload"></span></label>
                        <input style="width: calc(100% - 300px) !important" type="text" id="node-config-input-closePayload" style="width:300px" data-i18n="[placeholder]common.label.payload">
                        <label style="margin-left: 10px; width: 90px !important;" for="node-config-input-closeQos"><i class="fa fa-empire"></i> <span data-i18n="mqtt.label.qos"></span></label>
                        <select id="node-config-input-closeQos" style="width:75px !important">
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                        </select>
                    </div>
                </div>
            </div>
            <div id="mqtt-broker-section-will">
                <div class="palette-header">
                    <i class="fa fa-angle-down"></i><span data-i18n="mqtt.sections-label.will-message"></span>
                </div>
                <div class="section-content" style="padding:10px 0 0 10px">
                    <div class="form-row">
                        <label style="width: 100px !important;" for="node-config-input-willTopic"><i class="fa fa-tasks"></i> <span data-i18n="common.label.topic"></span></label>
                        <input style="width: calc(100% - 300px) !important" type="text" id="node-config-input-willTopic" style="width:300px" data-i18n="[placeholder]mqtt.placeholder.will-topic">
                        <label style="margin-left: 10px; width: 90px !important;" for="node-config-input-willRetain"><i class="fa fa-history"></i> <span data-i18n="mqtt.label.retain"></span></label>
                        <select id="node-config-input-willRetain" style="width:75px !important">
                            <option value="false" data-i18n="mqtt.false"></option>
                            <option value="true" data-i18n="mqtt.true"></option>
                        </select>
                    </div>
                    <div class="form-row">
                        <label style="width: 100px !important;" for="node-config-input-willPayload"><i class="fa fa-envelope"></i> <span data-i18n="common.label.payload"></span></label>
                        <input style="width: calc(100% - 300px) !important" type="text" id="node-config-input-willPayload" style="width:300px" data-i18n="[placeholder]common.label.payload">
                        <label style="margin-left: 10px; width: 90px !important;" for="node-config-input-willQos"><i class="fa fa-empire"></i> <span data-i18n="mqtt.label.qos"></span></label>
                        <select id="node-config-input-willQos" style="width:75px !important">
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('mqtt-broker',{
        category: 'config',
        defaults: {
            name: {value:""},
            broker: {value:"",required:true},
            port: {value:1883,required:false,validate:RED.validators.number(true)},
            tls: {type:"tls-config",required: false},
            clientid: {value:"", validate: function(v) {
                if ($("#node-config-input-clientid").length) {
                    // Currently editing the node
                    return $("#node-config-input-cleansession").is(":checked") || (v||"").length > 0;
                } else {
                    return (this.cleansession===undefined || this.cleansession) || (v||"").length > 0;
                }
            }},
            usetls: {value: false},
            verifyservercert: { value: false},
            compatmode: { value: true},
            keepalive: {value:60,validate:RED.validators.number()},
            cleansession: {value: true},
            birthTopic: {value:""},
            birthQos: {value:"0"},
            birthRetain: {value:false},
            birthPayload: {value:""},
            closeTopic: {value:""},
            closeQos: {value:"0"},
            closeRetain: {value:false},
            closePayload: {value:""},
            willTopic: {value:""},
            willQos: {value:"0"},
            willRetain: {value:false},
            willPayload: {value:""}
        },
        credentials: {
            user: {type:"text"},
            password: {type: "password"}
        },
        label: function() {
            if (this.name) {
                return this.name;
            }
            var b = this.broker;
            if (b === "") { b = "undefined"; }
            var lab = "";
            lab = (this.clientid?this.clientid+"@":"")+b;
            if (b.indexOf("://") === -1){
                if (!this.port){ lab = lab + ":1883"; }
                else { lab = lab + ":" + this.port; }
            }
            return lab;
        },
        oneditprepare: function () {
            var tabs = RED.tabs.create({
                id: "node-config-mqtt-broker-tabs",
                onchange: function(tab) {
                    $("#node-config-mqtt-broker-tabs-content").children().hide();
                    $("#" + tab.id).show();
                }
            });
            tabs.addTab({
                id: "mqtt-broker-tab-connection",
                label: this._("mqtt.tabs-label.connection")
            });
            tabs.addTab({
                id: "mqtt-broker-tab-security",
                label: this._("mqtt.tabs-label.security")
            });

            tabs.addTab({
                id: "mqtt-broker-tab-messages",
                label: this._("mqtt.tabs-label.messages")
            });

            function setUpSection(sectionId, isExpanded) {
                var birthMessageSection = $(sectionId);
                var paletteHeader = birthMessageSection.find('.palette-header');
                var twistie = paletteHeader.find('i');
                var sectionContent = birthMessageSection.find('.section-content');

                function toggleSection(expanded) {
                    twistie.toggleClass('expanded', expanded);
                    sectionContent.toggle(expanded);
                }
                paletteHeader.click(function(e) {
                    e.preventDefault();
                    var isExpanded = twistie.hasClass('expanded');
                    toggleSection(!isExpanded);
                });
                toggleSection(isExpanded);
            }

            // show first section if none are set so the user gets the idea
            var showBirthSection = this.birthTopic !== ""
                || this.willTopic === ""
                && this.birthTopic === ""
                && this.closeTopic == "";
            setUpSection('#mqtt-broker-section-birth', showBirthSection);
            setUpSection('#mqtt-broker-section-close', this.closeTopic !== "");
            setUpSection('#mqtt-broker-section-will', this.willTopic !== "");

            setTimeout(function() { tabs.resize(); },0);
            if (typeof this.cleansession === 'undefined') {
                this.cleansession = true;
                $("#node-config-input-cleansession").prop("checked",true);
            }
            if (typeof this.usetls === 'undefined') {
                this.usetls = false;
                $("#node-config-input-usetls").prop("checked",false);
            }
            if (typeof this.compatmode === 'undefined') {
                this.compatmode = true;
                $("#node-config-input-compatmode").prop('checked', true);
            }
            if (typeof this.keepalive === 'undefined') {
                this.keepalive = 15;
                $("#node-config-input-keepalive").val(this.keepalive);
            }
            if (typeof this.birthQos === 'undefined') {
                this.birthQos = "0";
                $("#node-config-input-birthQos").val("0");
            }
            if (typeof this.closeQos === 'undefined') {
                this.willQos = "0";
                $("#node-config-input-willQos").val("0");
            }
            if (typeof this.willQos === 'undefined') {
                this.willQos = "0";
                $("#node-config-input-willQos").val("0");
            }

            function updateTLSOptions() {
                if ($("#node-config-input-usetls").is(':checked')) {
                    $("#node-config-row-tls").show();
                } else {
                    $("#node-config-row-tls").hide();
                }
            }
            updateTLSOptions();
            $("#node-config-input-usetls").on("click",function() {
                updateTLSOptions();
            });
            var node = this;
            function updateClientId() {
                if ($("#node-config-input-cleansession").is(":checked")) {
                    $("#node-config-input-clientid").attr("placeholder",node._("mqtt.placeholder.clientid"));
                } else {
                    $("#node-config-input-clientid").attr("placeholder",node._("mqtt.placeholder.clientid-nonclean"));
                }
                $("#node-config-input-clientid").change();
            }
            setTimeout(updateClientId,0);
            $("#node-config-input-cleansession").on("click",function() {
                updateClientId();
            });

            function updatePortEntry(){
                var disabled = $("#node-config-input-port").prop("disabled");
                if ($("#node-config-input-broker").val().indexOf("://") === -1){
                    if (disabled){
                        $("#node-config-input-port").prop("disabled", false);
                    }
                }
                else {
                    if (!disabled){
                        $("#node-config-input-port").prop("disabled", true);
                    }
                }
            }
            $("#node-config-input-broker").change(function() {
                updatePortEntry();
            });
            $("#node-config-input-broker").on( "keyup", function() {
                updatePortEntry();
            });
            setTimeout(updatePortEntry,50);

        },
        oneditsave: function() {
            if (!$("#node-config-input-usetls").is(':checked')) {
                $("#node-config-input-tls").val("");
            }
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
  http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="mqtt in">
<p>Connects to a MQTT broker and subscribes to messages from the specified topic.</p>
    <h3>Outputs</h3>
    <dl class="message-properties">
       <dt>payload <span class="property-type">string | buffer</span></dt>
       <dd>a string unless detected as a binary buffer.</dd>
       <dt>topic <span class="property-type">string</span></dt>
       <dd>the MQTT topic, uses / as a hierarchy separator.</dd>
       <dt>qos <span class="property-type">number</span> </dt>
       <dd>0, fire and forget - 1, at least once - 2, once and once only.</dd>
       <dt>retain <span class="property-type">boolean</span></dt>
       <dd>true indicates the message was retained and may be old.</dd>
    </dl>
    <h3>Details</h3>
    The subscription topic can include MQTT wildcards, + for one level, # for multiple levels.</p>
    <p>This node requires a connection to a MQTT broker to be configured. This is configured by clicking
    the pencil icon.</p>
    <p>Several MQTT nodes (in or out) can share the same broker connection if required.</p>
</script>

<script type="text/x-red" data-help-name="mqtt out">
    <p>Connects to a MQTT broker and publishes messages.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
       <dt>payload <span class="property-type">string | buffer</span></dt>
       <dd> most users prefer simple text payloads, but binary buffers can also be published.</dd>

       <dt class="optional">topic <span class="property-type">string</span></dt>
       <dd> the MQTT topic to publish to.</dd>

       <dt class="optional">qos <span class="property-type">number</span></dt>
       <dd>0, fire and forget - 1, at least once - 2, once and once only. Default 0.</dd>

       <dt class="optional">retain <span class="property-type">boolean</span></dt>
       <dd>set to true to retain the message on the broker. Default false.</dd>
    </dl>
    <h3>Details</h3>
    <code>msg.payload</code> is used as the payload of the published message.
    If it contains an Object it will be converted to a JSON string before being sent.
    If it contains a binary Buffer the message will be published as-is.</p>
    <p>The topic used can be configured in the node or, if left blank, can be set by <code>msg.topic</code>.</p>
    <p>Likewise the QoS and retain values can be configured in the node or, if left
    blank, set by <code>msg.qos</code> and <code>msg.retain</code> respectively. To clear a previously
    retained topic from the broker, send a blank message to that topic with the retain flag set.</p>
    <p>This node requires a connection to a MQTT broker to be configured. This is configured by clicking
    the pencil icon.</p>
    <p>Several MQTT nodes (in or out) can share the same broker connection if required.</p>
</script>

<script type="text/x-red" data-help-name="mqtt-broker">
    <p>Configuration for a connection to an MQTT broker.</p>
    <p>This configuration will create a single connection to the broker which can
       then be reused by <code>MQTT In</code> and <code>MQTT Out</code> nodes.</p>
    <p>The node will generate a random Client ID if one is not set and the
       node is configured to use a Clean Session connection. If a Client ID is set,
       it must be unique to the broker you are connecting to.</p>
    <h4>Birth Message</h4>
    <p>This is a message that will be published on the configured topic whenever the
       connection is established.</p>
    <h4>Close Message</h4>
    <p>This is a message that will be published on the configured topic before the
       connection is closed normally, either by re-deploying the node, or by shutting down.</p>
    <h4>Will Message</h4>
    <p>This is a message that will be published by the broker in the event the node
       unexpectedly loses its connection.</p>
    <h4>WebSockets</h4>
    <p>The node can be configured to use a WebSocket connection. To do so, the Server
       field should be configured with a full URI for the connection. For example:</p>
    <pre>ws://example.com:4000/mqtt</pre>

</script>

</div><div><!-- --- [red-module:node-red/httpin] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="http in">
    <div class="form-row">
        <label for="node-input-method"><i class="fa fa-tasks"></i> <span data-i18n="httpin.label.method"></span></label>
        <select type="text" id="node-input-method" style="width:70%;">
        <option value="get">GET</option>
        <option value="post">POST</option>
        <option value="put">PUT</option>
        <option value="delete">DELETE</option>
        <option value="patch">PATCH</option>
        </select>
    </div>
    <div class="form-row form-row-http-in-upload hide">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-upload" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-upload" style="width: 70%;" data-i18n="httpin.label.upload"></label>
    </div>
    <div class="form-row">
        <label for="node-input-url"><i class="fa fa-globe"></i> <span data-i18n="httpin.label.url"></span></label>
        <input id="node-input-url" type="text" placeholder="/url">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-row row-swagger-doc">
        <label for="node-input-swaggerDoc"><i class="fa fa-file-text-o"></i> <span data-i18n="httpin.label.doc"></span></label>
        <input type="text" id="node-input-swaggerDoc">
    </div>
    <div id="node-input-tip" class="form-tips"><span data-i18n="httpin.tip.in"></span><code><span id="node-input-path"></span></code>.</div>
</script>

<script type="text/x-red" data-template-name="http response">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-row">
        <label for="node-input-statusCode"><i class="fa fa-long-arrow-left"></i> <span data-i18n="httpin.label.status"></span></label>
        <input type="text" id="node-input-statusCode" placeholder="msg.statusCode">
    </div>
    <div class="form-row" style="margin-bottom:0;">
        <label><i class="fa fa-list"></i> <span data-i18n="httpin.label.headers"></span></label>
    </div>
    <div class="form-row node-input-headers-container-row">
        <ol id="node-input-headers-container"></ol>
    </div>
    <div class="form-tips"><span data-i18n="[html]httpin.tip.res"></span></div>
</script>

<script type="text/javascript">
(function() {
    RED.nodes.registerType('http in',{
        category: 'input',
        color:"rgb(231, 231, 174)",
        defaults: {
            name: {value:""},
            url: {value:"",required:true},
            method: {value:"get",required:true},
            upload: {value:false},
            swaggerDoc: {type:"swagger-doc", required:false}
        },
        inputs:0,
        outputs:1,
        icon: "white-globe.png",
        label: function() {
            if (this.name) {
                return this.name;
            } else if (this.url) {
                var root = RED.settings.httpNodeRoot;
                if (root.slice(-1) != "/") {
                    root = root+"/";
                }
                if (this.url.charAt(0) == "/") {
                    root += this.url.slice(1);
                } else {
                    root += this.url;
                }
                return "["+this.method+"] "+root;
            } else {
                return "http";
            }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var root = RED.settings.httpNodeRoot;
            if (root.slice(-1) == "/") {
                root = root.slice(0,-1);
            }
            if (root == "") {
                $("#node-input-tip").hide();
            } else {
                $("#node-input-path").html(root);
                $("#node-input-tip").show();
            }
            if(!RED.nodes.getType("swagger-doc")){
                $('.row-swagger-doc').hide();
            }
            $("#node-input-method").change(function() {
                if ($(this).val() === "post") {
                    $(".form-row-http-in-upload").show();
                } else {
                    $(".form-row-http-in-upload").hide();
                }
            }).change();


        }

    });
    var headerTypes = [
        {value:"content-type",label:"Content-Type",hasValue: false},
        {value:"location",label:"Location",hasValue: false},
        {value:"other",label:RED._("node-red:httpin.label.other"),icon:"red/images/typedInput/az.png"}
       ]
    var contentTypes = [
        {value:"application/json",label:"application/json",hasValue: false},
        {value:"application/xml",label:"application/xml",hasValue: false},
        {value:"text/css",label:"text/css",hasValue: false},
        {value:"text/html",label:"text/html",hasValue: false},
        {value:"text/plain",label:"text/plain",hasValue: false},
        {value:"image/gif",label:"image/gif",hasValue: false},
        {value:"image/png",label:"image/png",hasValue: false},
        {value:"other",label:RED._("node-red:httpin.label.other"),icon:"red/images/typedInput/az.png"}
    ];

    RED.nodes.registerType('http response',{
        category: 'output',
        color:"rgb(231, 231, 174)",
        defaults: {
            name: {value:""},
            statusCode: {value:"",validate: RED.validators.number(true)},
            headers: {value:{}}
        },
        inputs:1,
        outputs:0,
        align: "right",
        icon: "white-globe.png",
        label: function() {
            return this.name||("http"+(this.statusCode?" ("+this.statusCode+")":""));
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            function resizeRule(rule) {
                var newWidth = rule.width();
                rule.find('.red-ui-typedInput').typedInput("width",(newWidth-15)/2);
            }
            var headerList = $("#node-input-headers-container").css('min-height','150px').css('min-width','450px').editableList({
                addItem: function(container,i,header) {
                    var row = $('<div></div>').css({
                        overflow: 'hidden',
                        whiteSpace: 'nowrap'
                    }).appendTo(container);

                    var propertyName = $('<input/>',{class:"node-input-header-name",type:"text"})
                        .appendTo(row)
                        .typedInput({types:headerTypes});

                    var propertyValue = $('<input/>',{class:"node-input-header-value",type:"text",style:"margin-left: 10px"})
                        .appendTo(row)
                        .typedInput({types:
                            header.h === 'content-type'?contentTypes:[{value:"other",label:"other",icon:"red/images/typedInput/az.png"}]
                        });

                    var matchedType = headerTypes.filter(function(ht) {
                        return ht.value === header.h
                    });
                    if (matchedType.length === 0) {
                        propertyName.typedInput('type','other');
                        propertyName.typedInput('value',header.h);
                        propertyValue.typedInput('value',header.v);
                    } else {
                        propertyName.typedInput('type',header.h);

                        if (header.h === "content-type") {
                            matchedType = contentTypes.filter(function(ct) {
                                return ct.value === header.v;
                            });
                            if (matchedType.length === 0) {
                                propertyValue.typedInput('type','other');
                                propertyValue.typedInput('value',header.v);
                            } else {
                                propertyValue.typedInput('type',header.v);
                            }
                        } else {
                            propertyValue.typedInput('value',header.v);
                        }
                    }

                    matchedType = headerTypes.filter(function(ht) {
                        return ht.value === header.h
                    });
                    if (matchedType.length === 0) {
                        propertyName.typedInput('type','other');
                        propertyName.typedInput('value',header.h);
                    } else {
                        propertyName.typedInput('type',header.h);
                    }

                    propertyName.on('change',function(event) {
                        var type = propertyName.typedInput('type');
                        if (type === 'content-type') {
                            propertyValue.typedInput('types',contentTypes);
                        } else {
                            propertyValue.typedInput('types',[{value:"other",label:"other",icon:"red/images/typedInput/az.png"}]);
                        }
                    });



                    resizeRule(container);
                },
                resizeItem: resizeRule,
                removable: true
            });

            if (this.headers) {
                for (var key in this.headers) {
                    if (this.headers.hasOwnProperty(key)) {
                        headerList.editableList('addItem',{h:key,v:this.headers[key]});
                    }
                }
            }
        },
        oneditsave: function() {
            var headers = $("#node-input-headers-container").editableList('items');
            var node = this;
            node.headers = {};
            headers.each(function(i) {
                var header = $(this);
                var keyType = header.find(".node-input-header-name").typedInput('type');
                var keyValue = header.find(".node-input-header-name").typedInput('value');
                var valueType = header.find(".node-input-header-value").typedInput('type');
                var valueValue = header.find(".node-input-header-value").typedInput('value');
                var key = keyType;
                var value = valueType;
                if (keyType === 'other') {
                    key = keyValue;
                }
                if (valueType === 'other') {
                    value = valueValue;
                }
                if (key !== '') {
                    node.headers[key] = value;
                }
            });
        },
        oneditresize: function(size) {
            var rows = $("#dialog-form>div:not(.node-input-headers-container-row)");
            var height = size.height;
            for (var i=0; i<rows.size(); i++) {
                height -= $(rows[i]).outerHeight(true);
            }
            var editorRow = $("#dialog-form>div.node-input-headers-container-row");
            height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));

            $("#node-input-headers-container").editableList('height',height);
        }
    });
})();
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="http in">
    <p>Creates an HTTP end-point for creating web services.</p>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload</dt>
        <dd>For a GET request, contains an object of any query string parameters.
            Otherwise, contains the body of the HTTP request.</dd>
        <dt>req<span class="property-type">object</span></dt>
        <dd>An HTTP request object. This object contains multiple properties that
            provide information about the request.
            <ul>
             <li><code>body</code> - the body of the incoming request. The format
                 will depend on the request.</li>
             <li><code>headers</code> - an object containing the HTTP request headers.</li>
             <li><code>query</code> - an object containing any query string parameters.</li>
             <li><code>params</code> - an object containing any route parameters.</li>
             <li><code>cookies</code> - an object containing the cookies for the request.</li>
             <li><code>files</code> - if enabled within the node, an object containing
                 any files uploaded as part of a POST request.</li>
            </ul>
        </dd>
        <dt>res<span class="property-type">object</span></dt>
        <dd>An HTTP response object. This property should not be used directly;
            the <code>HTTP Response</code> node documents how to respond to a request.
            This property must remain attached to the message passed to the response node.</dd>
    </dl>
    <h3>Details</h3>
    <p>The node will listen on the configured path for requests of a particular type.
       The path can be fully specified, such as <code>/user</code>, or include
       named parameters that accept any value, such as <code>/user/:name</code>.
       When named parameters are used, their actual value in a request can be accessed under <code>msg.req.params</code>.</p>
    <p>For requests that include a body, such as a POST or PUT, the contents of
       the request is made available as <code>msg.payload</code>.</p>
    <p>If the content type of the request can be determined, the body will be parsed to
       any appropriate type. For example, <code>application/json</code> will be parsed to
       its JavaScript object representation.</p>
    <p><b>Note:</b> this node does not send any response to the request. The flow
       must include an HTTP Response node to complete the request.</p>
</script>

<script type="text/x-red" data-help-name="http response">
    <p>Sends responses back to requests received from an HTTP Input node.</p>

    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">string</span></dt>
        <dd>The body of the response.</dd>
        <dt class="optional">statusCode <span class="property-type">number</span></dt>
        <dd>If set, this is used as the response status code. Default: 200.</dd>
        <dt class="optional">headers <span class="property-type">object</span></dt>
        <dd>If set, provides HTTP headers to include in the response.</dd>
        <dt class="optional">cookies <span class="property-type">object</span></dt>
        <dd>If set, can be used to set or delete cookies.</dd>
    </dl>
    <h3>Details</h3>
    <p>The <code>statusCode</code> and <code>headers</code> can also be set within
    the node itself. If a property is set within the node, it cannot be overridden
    by the corresponding message property.</p>
    <h4>Cookie handling</h4>
    <p>The <code>cookies</code> property must be an object of name/value pairs.
    The value can be either a string to set the value of the cookie with default
    options, or it can be an object of options.<p>
    <p>The following example sets two cookies - one called <code>name</code> with
    a value of <code>nick</code>, the other called <code>session</code> with a
    value of <code>1234</code> and an expiry set to 15 minutes.</p>
    <pre>
msg.cookies = {
    name: 'nick',
    session: {
        value: '1234',
        maxAge: 900000
    }
}</pre>
    <p>The valid options include:</p>
    <ul>
    <li><code>domain</code> - (String) domain name for the cookie</li>
    <li><code>expires</code> - (Date) expiry date in GMT. If not specified or set to 0, creates a session cookie</li>
    <li><code>maxAge</code> - (String) expiry date as relative to the current time in milliseconds</li>
    <li><code>path</code> - (String) path for the cookie. Defaults to /</li>
    <li><code>value</code> - (String) the value to use for the cookie</li>
    </ul>
    <p>To delete a cookie, set its <code>value</code> to <code>null</code>.</p>

</script>

</div><div><!-- --- [red-module:node-red/httprequest] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="http request">
    <div class="form-row">
        <label for="node-input-method"><i class="fa fa-tasks"></i> <span data-i18n="httpin.label.method"></span></label>
        <select type="text" id="node-input-method" style="width:70%;">
        <option value="GET">GET</option>
        <option value="POST">POST</option>
        <option value="PUT">PUT</option>
        <option value="DELETE">DELETE</option>
        <option value="use" data-i18n="httpin.setby"></option>
        </select>
    </div>

    <div class="form-row">
        <label for="node-input-url"><i class="fa fa-globe"></i> <span data-i18n="httpin.label.url"></span></label>
        <input id="node-input-url" type="text" placeholder="http://">
    </div>

    <div class="form-row node-input-paytoqs-row">
        <input type="checkbox" id="node-input-paytoqs" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-paytoqs" style="width: auto" data-i18n="httpin.label.paytoqs"></label>
    </div>

    <div class="form-row">
        <input type="checkbox" id="node-input-usetls" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-usetls" style="width: auto" data-i18n="httpin.use-tls"></label>
        <div id="node-row-tls" class="hide">
            <label style="width: auto; margin-left: 20px; margin-right: 10px;" for="node-input-tls"><span data-i18n="httpin.tls-config"></span></label><input type="text" style="width: 300px" id="node-input-tls">
        </div>
    </div>

    <div class="form-row">
        <input type="checkbox" id="node-input-useAuth" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-useAuth" style="width: 70%;"><span data-i18n="httpin.basicauth"></span></label>
        <div style="margin-left: 20px" class="node-input-useAuth-row hide">
            <div class="form-row">
                <label for="node-input-authType-select"><i class="fa fa-user-secret "></i> <span data-i18n="httpin.label.authType"></span></label>
                <select type="text" id="node-input-authType-select" style="width:70%;">
                    <option value="basic"  data-i18n="httpin.basic"></option>
                    <option value="digest" data-i18n="httpin.digest"></option>
                    <option value="bearer" data-i18n="httpin.bearer"></option>
                </select>
                <input type="hidden" id="node-input-authType">
            </div>
            <div class="form-row node-input-basic-row">
                <label for="node-input-user"><i class="fa fa-user"></i> <span data-i18n="common.label.username"></span></label>
                <input type="text" id="node-input-user">
            </div>
            <div class="form-row">
                <label for="node-input-password"> <i class="fa fa-lock"></i> <span data-i18n="common.label.password" id="node-span-password"></span><span data-i18n="httpin.label.bearerToken" id="node-span-token" style="display:none"></span></label>
                <input type="password" id="node-input-password">
            </div>
        </div>
    </div>

    <div class="form-row">
        <input type="checkbox" id="node-input-useProxy" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-useProxy" style="width: auto;"><span data-i18n="httpin.use-proxy"></span></label>
        <div id="node-input-useProxy-row" class="hide">
            <label style="width: auto; margin-left: 20px; margin-right: 10px;" for="node-input-proxy"><i class="fa fa-globe"></i> <span data-i18n="httpin.proxy-config"></span></label><input type="text" style="width: 270px" id="node-input-proxy">
        </div>
    </div>

    <div class="form-row">
        <label for="node-input-ret"><i class="fa fa-arrow-left"></i> <span data-i18n="httpin.label.return"></span></label>
        <select type="text" id="node-input-ret" style="width:70%;">
        <option value="txt" data-i18n="httpin.utf8"></option>
        <option value="bin" data-i18n="httpin.binary"></option>
        <option value="obj" data-i18n="httpin.json"></option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-tips" id="tip-json" hidden><span data-i18n="httpin.tip.req"></span></div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('http request',{
        category: 'function',
        color:"rgb(231, 231, 174)",
        defaults: {
            name: {value:""},
            method:{value:"GET"},
            ret: {value:"txt"},
            paytoqs: {value: false},
            url:{value:"",validate:function(v) { return (v.trim().length === 0) || (v.indexOf("://") === -1) || (v.trim().indexOf("http") === 0)} },
            tls: {type:"tls-config",required: false},
            proxy: {type:"http proxy",required: false},
            authType: {value: ""}
        },
        credentials: {
            user: {type:"text"},
            password: {type: "password"}
        },
        inputs:1,
        outputs:1,
        outputLabels: function(i) {
            return ({
                txt: this._("httpin.label.utf8String"),
                bin: this._("httpin.label.binaryBuffer"),
                obj: this._("httpin.label.jsonObject")
            }[this.ret]);
        },
        icon: "white-globe.png",
        label: function() {
            return this.name||this._("httpin.httpreq");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            $("#node-input-useAuth").change(function() {
                if ($(this).is(":checked")) {
                    $(".node-input-useAuth-row").show();
                    // Nodes (< version 0.20.x) with credentials but without authentication type, need type 'basic'
                    if (!$('#node-input-authType').val()) {
                        $("#node-input-authType-select").val('basic').trigger("change");
                    }
                } else {
                    $(".node-input-useAuth-row").hide();
                    $('#node-input-authType').val('');
                    $('#node-input-user').val('');
                    $('#node-input-password').val('');
                }
            });
            $("#node-input-authType-select").change(function() {
                var val = $(this).val();
                $("#node-input-authType").val(val);
                if (val === "basic" || val === "digest") {
                    $(".node-input-basic-row").show();
                    $('#node-span-password').show();
                    $('#node-span-token').hide();
                } else if (val === "bearer") {
                    $(".node-input-basic-row").hide();
                    $('#node-span-password').hide();
                    $('#node-span-token').show();
                    $('#node-input-user').val('');
                }
            });
            $("#node-input-method").change(function() {
                if ($(this).val() == "GET") {
                    $(".node-input-paytoqs-row").show();
                } else {
                    $(".node-input-paytoqs-row").hide();
                }
            });
            if (this.authType) {
                $('#node-input-useAuth').prop('checked', true);
                $("#node-input-authType-select").val(this.authType);
            } else {
                $('#node-input-useAuth').prop('checked', false);
            }
            $("#node-input-useAuth").change();

            function updateTLSOptions() {
                if ($("#node-input-usetls").is(':checked')) {
                    $("#node-row-tls").show();
                } else {
                    $("#node-row-tls").hide();
                }
            }
            if (this.tls) {
                $('#node-input-usetls').prop('checked', true);
            } else {
                $('#node-input-usetls').prop('checked', false);
            }
            updateTLSOptions();
            $("#node-input-usetls").on("click",function() {
                updateTLSOptions();
            });

            function updateProxyOptions() {
                if ($("#node-input-useProxy").is(":checked")) {
                    $("#node-input-useProxy-row").show();
                } else {
                    $("#node-input-useProxy-row").hide();
                }
            }
            if (this.proxy) {
                $("#node-input-useProxy").prop("checked", true);
            } else {
                $("#node-input-useProxy").prop("checked", false);
            }
            updateProxyOptions();
            $("#node-input-useProxy").on("click", function() {
                updateProxyOptions();
            });

            $("#node-input-ret").change(function() {
                if ($("#node-input-ret").val() === "obj") {
                    $("#tip-json").show();
                } else {
                    $("#tip-json").hide();
                }
            });
        },
        oneditsave: function() {
            if (!$("#node-input-usetls").is(':checked')) {
                $("#node-input-tls").val("_ADD_");
            }
            if (!$("#node-input-useProxy").is(":checked")) {
                $("#node-input-proxy").val("_ADD_");
            }
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="http request">
    <p>Sends HTTP requests and returns the response.</p>

    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt class="optional">url <span class="property-type">string</span></dt>
        <dd>If not configured in the node, this optional property sets the url of the request.</dd>
        <dt class="optional">method <span class="property-type">string</span></dt>
        <dd>If not configured in the node, this optional property sets the HTTP method of the request.
            Must be one of <code>GET</code>, <code>PUT</code>, <code>POST</code>, <code>PATCH</code> or <code>DELETE</code>.</dd>
        <dt class="optional">headers <span class="property-type">object</span></dt>
        <dd>Sets the HTTP headers of the request.</dd>
        <dt class="optional">cookies <span class="property-type">object</span></dt>
        <dd>If set, can be used to send cookies with the request.</dd>
        <dt class="optional">payload</dt>
        <dd>Sent as the body of the request.</dd>
        <dt class="optional">rejectUnauthorized</dt>
        <dd>If set to <code>false</code>, allows requests to be made to https sites that use
            self signed certificates.</dd>
        <dt class="optional">followRedirects</dt>
        <dd>If set to <code>false</code> prevent following Redirect (HTTP 301).<code>true</code> by default</dd>
        <dt class="optional">requestTimeout</dt>
        <dd>If set to a positive number, will override the globally set <code>httpRequestTimeout</code> parameter.</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">string | object | buffer</span></dt>
        <dd>The body of the response. The node can be configured to return the body
             as a string, attempt to parse it as a JSON string or leave it as a
             binary buffer.</dd>
        <dt>statusCode <span class="property-type">number</span></dt>
        <dd>The status code of the response, or the error code if the request could not be completed.</dd>
        <dt>headers <span class="property-type">object</span></dt>
        <dd>An object containing the response headers.</dd>
        <dt>responseUrl <span class="property-type">string</span></dt>
        <dd>In case any redirects occurred while processing the request, this property is the final redirected url.
            Otherwise, the url of the original request.</dd>
        <dt>responseCookies <span class="property-type">object</span></dt>
        <dd>If the response includes cookies, this propery is an object of name/value pairs for each cookie.</dd>
        <dt>redirectList <span class="property-type">array</span></dt>
        <dd>If the request was redirected one or more times, the accumulated information will be added to this property. `location` is the next redirect destination. `cookies` is the cookies returned from the redirect source.</dd>
    </dl>
    <h3>Details</h3>
    <p>When configured within the node, the URL property can contain <a href="http://mustache.github.io/mustache.5.html" target="_blank">mustache-style</a> tags. These allow the
    url to be constructed using values of the incoming message. For example, if the url is set to
    <code>example.com/{{{topic}}}</code>, it will have the value of <code>msg.topic</code> automatically inserted.
    Using {{{...}}} prevents mustache from escaping characters like / & etc.</p>
    <p>The node can optionally automatically encode <code>msg.payload</code> as query string parameters for a GET request, in which case <code>msg.payload</code> has to be an object.</p>
    <p><b>Note</b>: If running behind a proxy, the standard <code>http_proxy=...</code> environment variable should be set and Node-RED restarted, or use Proxy Configuration. If Proxy Configuration was set, the configuration take precedence over environment variable.</p>
    <h4>Using multiple HTTP Request nodes</h4>
    <p>In order to use more than one of these nodes in the same flow, care must be taken with
    the <code>msg.headers</code> property. The first node will set this property with
    the response headers. The next node will then use those headers for its request - this
    is not usually the right thing to do. If <code>msg.headers</code> property is left unchanged
    between nodes, it will be ignored by the second node. To set custom headers, <code>msg.headers</code>
    should first be deleted or reset to an empty object: <code>{}</code>.
    <h4>Cookie handling</h4>
    <p>The <code>cookies</code> property passed to the node must be an object of name/value pairs.
    The value can be either a string to set the value of the cookie or it can be an
    object with a single <code>value</code> property.<p>
    <p>Any cookies returned by the request are passed back under the <code>responseCookies</code> property.</p>
    <h4>Content type handling</h4>
    <p>If <code>msg.payload</code> is an Object, the node will automatically set the content type
    of the request to <code>application/json</code> and encode the body as such.</p>
    <p>To encode the request as form data, <code>msg.headers["content-type"]</code> should be set to <code>application/x-www-form-urlencoded</code>.</p>
    <h4>File Upload</h4>
    <p>To perform a file upload, <code>msg.headers["content-type"]</code> should be set to <code>multipart/form-data</code>
        and the <code>msg.payload</code> passed to the node must be an object with the following structure:</p>
    <pre><code>{
    "KEY": {
        "value": FILE_CONTENTS,
        "options": {
            "filename": "FILENAME"
        }
    }
}</code></pre>
    <p>The values of <code>KEY</code>, <code>FILE_CONTENTS</code> and <code>FILENAME</code>
    should be set to the appropriate values.</p>

</script>

</div><div><!-- --- [red-module:node-red/websocket] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<!-- WebSocket Input Node -->
<script type="text/x-red" data-template-name="websocket in">
    <div class="form-row">
        <label for="node-input-mode"><i class="fa fa-dot-circle-o"></i> <span data-i18n="websocket.label.type"></span></label>
        <select id="node-input-mode">
            <option value="server" data-i18n="websocket.listenon"></option>
            <option value="client" data-i18n="websocket.connectto"></option>
        </select>
    </div>
    <div class="form-row" id="websocket-server-row">
        <label for="node-input-server"><i class="fa fa-bookmark"></i> <span data-i18n="websocket.label.path"></span></label>
        <input type="text" id="node-input-server">
    </div>
    <div class="form-row" id="websocket-client-row">
        <label for="node-input-client"><i class="fa fa-bookmark"></i> <span data-i18n="websocket.label.url"></span></label>
        <input type="text" id="node-input-client">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>

<script type="text/javascript">

(function() {

    function ws_oneditprepare() {
        $("#websocket-client-row").hide();
        $("#node-input-mode").change(function() {
            if ( $("#node-input-mode").val() === 'client') {
                $("#websocket-server-row").hide();
                $("#websocket-client-row").show();
            }
            else {
                $("#websocket-server-row").show();
                $("#websocket-client-row").hide();
            }
        });

        if (this.client) {
            $("#node-input-mode").val('client').change();
        }
        else {
            $("#node-input-mode").val('server').change();
        }
    }

    function ws_oneditsave() {
        if ($("#node-input-mode").val() === 'client') {
            $("#node-input-server").append('<option value="">Dummy</option>');
            $("#node-input-server").val('');
        }
        else {
            $("#node-input-client").append('<option value="">Dummy</option>');
            $("#node-input-client").val('');
        }
    }

    function ws_label() {
        var nodeid = (this.client)?this.client:this.server;
        var wsNode = RED.nodes.node(nodeid);
        return this.name||(wsNode?"[ws] "+wsNode.label():"websocket");
    }

    function ws_validateserver() {
        if ($("#node-input-mode").val() === 'client' || (this.client && !this.server)) {
            return true;
        }
        else {
            return RED.nodes.node(this.server) != null;
        }
    }

    function ws_validateclient() {
        if ($("#node-input-mode").val() === 'client' || (this.client && !this.server)) {
            return RED.nodes.node(this.client) != null;
        }
        else {
            return true;
        }
    }

    RED.nodes.registerType('websocket in',{
        category: 'input',
        defaults: {
            name: {value:""},
            server: {type:"websocket-listener", validate: ws_validateserver},
            client: {type:"websocket-client", validate: ws_validateclient}
        },
        color:"rgb(215, 215, 160)",
        inputs:0,
        outputs:1,
        icon: "white-globe.png",
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        label: ws_label,
        oneditsave: ws_oneditsave,
        oneditprepare: ws_oneditprepare
    });

    RED.nodes.registerType('websocket out',{
        category: 'output',
        defaults: {
            name: {value:""},
            server: {type:"websocket-listener", validate: ws_validateserver},
            client: {type:"websocket-client", validate: ws_validateclient}
        },
        color:"rgb(215, 215, 160)",
        inputs:1,
        outputs:0,
        icon: "white-globe.png",
        align: "right",
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        label: ws_label,
        oneditsave: ws_oneditsave,
        oneditprepare: ws_oneditprepare
    });

    RED.nodes.registerType('websocket-listener',{
        category: 'config',
        defaults: {
            path: {value:"",required:true,validate:RED.validators.regex(/^((?!\/debug\/ws).)*$/)},
            wholemsg: {value:"false"}
        },
        inputs:0,
        outputs:0,
        label: function() {
            var root = RED.settings.httpNodeRoot;
            if (root.slice(-1) != "/") {
                root = root+"/";
            }
            if (this.path.charAt(0) == "/") {
                root += this.path.slice(1);
            } else {
                root += this.path;
            }
            return root;
        },
        oneditprepare: function() {
            var root = RED.settings.httpNodeRoot;
            if (root.slice(-1) == "/") {
                root = root.slice(0,-1);
            }
            if (root === "") {
                $("#node-config-ws-tip").hide();
            } else {
                $("#node-config-ws-path").html(root);
                $("#node-config-ws-tip").show();
            }
        }
    });

    RED.nodes.registerType('websocket-client',{
        category: 'config',
        defaults: {
            path: {value:"",required:true,validate:RED.validators.regex(/^((?!\/debug\/ws).)*$/)},
            tls: {type:"tls-config",required: false},
            wholemsg: {value:"false"}
        },
        inputs:0,
        outputs:0,
        label: function() {
            return this.path;
        },
        oneditprepare: function() {
            $("#node-config-input-path").on("change keyup paste",function() {
                $(".node-config-row-tls").toggle(/^wss:/i.test($(this).val()))
            });
            $("#node-config-input-path").change();
        },
        oneditsave: function() {
            if (!/^wss:/i.test($("#node-config-input-path").val())) {
                $("#node-config-input-tls").val("_ADD_");
            }
        }
    });

})();
</script>

<!-- WebSocket out Node -->
<script type="text/x-red" data-template-name="websocket out">
    <div class="form-row">
        <label for="node-input-mode"><i class="fa fa-dot-circle-o"></i> <span data-i18n="websocket.label.type"></span></label>
        <select id="node-input-mode">
            <option value="server" data-i18n="websocket.listenon"></option>
            <option value="client" data-i18n="websocket.connectto"></option>
        </select>
    </div>
    <div class="form-row" id="websocket-server-row">
        <label for="node-input-server"><i class="fa fa-bookmark"></i> <span data-i18n="websocket.label.path"></span></label>
        <input type="text" id="node-input-server">
    </div>
    <div class="form-row" id="websocket-client-row">
        <label for="node-input-client"><i class="fa fa-bookmark"></i> <span data-i18n="websocket.label.url"></span></label>
        <input type="text" id="node-input-client">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>

<!-- WebSocket Server configuration node -->
<script type="text/x-red" data-template-name="websocket-listener">
    <div class="form-row">
        <label for="node-config-input-path"><i class="fa fa-bookmark"></i> <span data-i18n="websocket.label.path"></span></label>
        <input id="node-config-input-path" type="text" placeholder="/ws/example">
    </div>
    <div class="form-row">
        <label for="node-config-input-wholemsg" data-i18n="websocket.sendrec"></label>
        <select type="text" id="node-config-input-wholemsg" style="width: 70%;">
            <option value="false" data-i18n="websocket.payload"></option>
            <option value="true" data-i18n="websocket.message"></option>
        </select>
    </div>
    <div class="form-tips">
        <span data-i18n="[html]websocket.tip.path1"></span>
        <p id="node-config-ws-tip"><span data-i18n="[html]websocket.tip.path2"></span><code><span id="node-config-ws-path"></span></code>.</p>
    </div>
</script>

<!-- WebSocket Client configuration node -->
<script type="text/x-red" data-template-name="websocket-client">
    <div class="form-row">
        <label for="node-config-input-path"><i class="fa fa-bookmark"></i> <span data-i18n="websocket.label.url"></span></label>
        <input id="node-config-input-path" type="text" placeholder="ws://example.com/ws">
    </div>
    <div class="form-row node-config-row-tls hide">
        <label for="node-config-input-tls" data-i18n="httpin.tls-config"></label>
        <input type="text" id="node-config-input-tls">
    </div>

    <div class="form-row">
        <label for="node-config-input-wholemsg" data-i18n="websocket.sendrec"></label>
        <select type="text" id="node-config-input-wholemsg" style="width: 70%;">
            <option value="false" data-i18n="websocket.payload"></option>
            <option value="true" data-i18n="websocket.message"></option>
        </select>
    </div>
    <div class="form-tips">
        <p><span data-i18n="[html]websocket.tip.url1"></span></p>
        <span data-i18n="[html]websocket.tip.url2"></span>
    </div>
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="websocket in">
    <p>WebSocket input node.</p>
    <p>By default, the data received from the WebSocket will be in <code>msg.payload</code>.
    The socket can be configured to expect a properly formed JSON string, in which
    case it will parse the JSON and send on the resulting object as the entire message.</p>
</script>

<script type="text/x-red" data-help-name="websocket out">
    <p>WebSocket out node.</p>
    <p>By default, <code>msg.payload</code> will be sent over the WebSocket. The socket
    can be configured to encode the entire <code>msg</code> object as a JSON string and send that
    over the WebSocket.</p>

    <p>If the message arriving at this node started at a WebSocket In node, the message
    will be sent back to the client that triggered the flow. Otherwise, the message
    will be broadcast to all connected clients.</p>
    <p>If you want to broadcast a message that started at a WebSocket In node, you
    should delete the <code>msg._session</code> property within the flow.</p>
</script>

<script type="text/x-red" data-help-name="websocket-listener">
   <p>This configuration node creates a WebSocket Server endpoint using the specified path.</p>
</script>

<script type="text/x-red" data-help-name="websocket-client">
   <p>This configuration node connects a WebSocket client to the specified URL.</p>
</script>

</div><div><!-- --- [red-module:node-red/watch] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="watch">
    <div class="form-row node-input-filename">
         <label for="node-input-files"><i class="fa fa-file"></i> <span data-i18n="watch.label.files"></span></label>
         <input id="node-input-files" type="text" tabindex="1" data-i18n="[placeholder]watch.placeholder.files">
    </div>
    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-recursive" style="display:inline-block; width:auto; vertical-align:top;">
        <label for="node-input-recursive" style="width:70%;"> <span data-i18n="watch.label.recursive"></span></label>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
     <div id="node-input-tip" class="form-tips"><span data-i18n="watch.tip"></span></div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('watch',{
        category: 'advanced-input',
        defaults: {
            name: {value:""},
            files: {value:"",required:true},
            recursive: {value:""}
        },
        color:"BurlyWood",
        inputs:0,
        outputs:1,
        icon: "watch.png",
        label: function() {
            return this.name||this.files||this._("watch.watch");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="watch">
    <p>Watches a directory or file for changes.</p>
    <p>You can enter a list of comma separated directories and/or files. You will
    need to put quotes "..." around any that have spaces in.</p>
    <p>On Windows you must use double back-slashes \\ in any directory names.</p>
    <p>The full filename of the file that actually changed is put into <code>msg.payload</code> and <code>msg.filename</code>,
    while a stringified version of the watch list is returned in <code>msg.topic</code>.</p>
    <p><code>msg.file</code> contains just the short filename of the file that changed.
    <code>msg.type</code> has the type of thing changed, usually <i>file</i> or <i>directory</i>,
    while <code>msg.size</code> holds the file size in bytes.</p>
    <p>Of course in Linux, <i>everything</i> is a file and thus can be watched...</p>
    <p><b>Note: </b>The directory or file must exist in order to be watched. If the file
    or directory gets deleted it may no longer be monitored even if it gets re-created.</p>
</script>

</div><div><!-- --- [red-module:node-red/tcpin] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="tcp in">
    <div class="form-row">
        <label for="node-input-server"><i class="fa fa-dot-circle-o"></i> <span data-i18n="tcpin.label.type"></span></label>
        <select id="node-input-server" style="width:120px; margin-right:5px;">
            <option value="server" data-i18n="tcpin.type.listen"></option>
            <option value="client" data-i18n="tcpin.type.connect"></option>
        </select>
        <span data-i18n="tcpin.label.port"></span> <input type="text" id="node-input-port" style="width:65px">
    </div>
    <div class="form-row hidden" id="node-input-host-row" style="padding-left: 110px;">
        <span data-i18n="tcpin.label.host"></span> <input type="text" id="node-input-host" placeholder="localhost" style="width: 60%;">
    </div>

    <div class="form-row">
        <label><i class="fa fa-sign-out"></i> <span data-i18n="tcpin.label.output"></span></label>
        <select id="node-input-datamode" style="width:110px;">
            <option value="stream" data-i18n="tcpin.output.stream"></option>
            <option value="single" data-i18n="tcpin.output.single"></option>
        </select>
        <select id="node-input-datatype" style="width:140px;">
            <option value="buffer" data-i18n="tcpin.output.buffer"></option>
            <option value="utf8" data-i18n="tcpin.output.string"></option>
            <option value="base64" data-i18n="tcpin.output.base64"></option>
        </select>
        <span data-i18n="tcpin.label.payload"></span>
    </div>

    <div id="node-row-newline" class="form-row hidden" style="padding-left:110px;">
        <span data-i18n="tcpin.label.delimited"></span> <input type="text" id="node-input-newline" style="width:110px;">
    </div>

    <div class="form-row">
        <label for="node-input-topic"><i class="fa fa-tasks"></i> <span data-i18n="common.label.topic"></span></label>
        <input type="text" id="node-input-topic" data-i18n="[placeholder]common.label.topic">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('tcp in',{
        category: 'input',
        color:"Silver",
        defaults: {
            name: {value:""},
            server: {value:"server",required:true},
            host: {value:"",validate:function(v) { return (this.server == "server")||v.length > 0;} },
            port: {value:"",required:true,validate:RED.validators.number()},
            datamode:{value:"stream"},
            datatype:{value:"buffer"},
            newline:{value:""},
            topic: {value:""},
            base64: {/*deprecated*/ value:false,required:true}
        },
        inputs:0,
        outputs:1,
        icon: "bridge-dash.png",
        label: function() {
            return this.name || "tcp:"+(this.host?this.host+":":"")+this.port;
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var updateOptions = function() {
                var sockettype = $("#node-input-server").val();
                if (sockettype == "client") {
                    $("#node-input-host-row").show();
                } else {
                    $("#node-input-host-row").hide();
                }
                var datamode = $("#node-input-datamode").val();
                var datatype = $("#node-input-datatype").val();
                if (datamode == "stream") {
                    if (datatype == "utf8") {
                        $("#node-row-newline").show();
                    } else {
                        $("#node-row-newline").hide();
                    }
                } else {
                    $("#node-row-newline").hide();
                }
            };
            updateOptions();
            $("#node-input-server").change(updateOptions);
            $("#node-input-datatype").change(updateOptions);
            $("#node-input-datamode").change(updateOptions);
        }
    });
</script>


<script type="text/x-red" data-template-name="tcp out">
    <div class="form-row">
        <label for="node-input-beserver"><i class="fa fa-dot-circle-o"></i> <span data-i18n="tcpin.label.type"></span></label>
        <select id="node-input-beserver" style="width:150px; margin-right:5px;">
            <option value="server" data-i18n="tcpin.type.listen"></option>
            <option value="client" data-i18n="tcpin.type.connect"></option>
            <option value="reply" data-i18n="tcpin.type.reply"></option>
        </select>
        <span id="node-input-port-row"><span data-i18n="tcpin.label.port"></span> <input type="text" id="node-input-port" style="width: 65px"></span>
    </div>

    <div class="form-row hidden" id="node-input-host-row" style="padding-left: 110px;">
        <span data-i18n="tcpin.label.host"></span> <input type="text" id="node-input-host" style="width: 60%;">
    </div>

    <div class="form-row hidden" id="node-input-end-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-end" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-end" style="width: 70%;"><span data-i18n="tcpin.label.close-connection"></span></label>
    </div>

    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-base64" placeholder="base64" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-base64" style="width: 70%;"><span data-i18n="tcpin.label.decode-base64"></span></label>
    </div>

    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('tcp out',{
        category: 'output',
        color:"Silver",
        defaults: {
            host: {value:"",validate:function(v) { return (this.beserver != "client")||v.length > 0;} },
            port: {value:"",validate:function(v) { return (this.beserver == "reply")||RED.validators.number()(v); } },
            beserver: {value:"client",required:true},
            base64: {value:false,required:true},
            end: {value:false,required:true},
            name: {value:""}
        },
        inputs:1,
        outputs:0,
        icon: "bridge-dash.png",
        align: "right",
        label: function() {
            return this.name || "tcp:"+(this.host?this.host+":":"")+this.port;
        },
        labelStyle: function() {
            return (this.name)?"node_label_italic":"";
        },
        oneditprepare: function() {
            var updateOptions = function() {
                var sockettype = $("#node-input-beserver").val();
                if (sockettype == "reply") {
                    $("#node-input-port-row").hide();
                    $("#node-input-host-row").hide();
                    $("#node-input-end-row").hide();
                } else {
                    $("#node-input-port-row").show();
                    $("#node-input-end-row").show();
                }

                if (sockettype == "client") {
                    $("#node-input-host-row").show();
                } else {
                    $("#node-input-host-row").hide();
                }
            };
            updateOptions();
            $("#node-input-beserver").change(updateOptions);
        }
    });
</script>


<script type="text/x-red" data-template-name="tcp request">
    <div class="form-row">
        <label for="node-input-server"><i class="fa fa-globe"></i> <span data-i18n="tcpin.label.server"></span></label>
        <input type="text" id="node-input-server" placeholder="ip.address" style="width:45%">
        <span data-i18n="tcpin.label.port"></span>
        <input type="text" id="node-input-port" style="width:60px">
    </div>
    <div class="form-row">
        <label for="node-input-out"><i class="fa fa-sign-out"></i> <span data-i18n="tcpin.label.return"></span></label>
        <select type="text" id="node-input-out" style="width:54%;">
            <option value="time" data-i18n="tcpin.return.timeout"></option>
            <option value="char" data-i18n="tcpin.return.character"></option>
            <option value="count" data-i18n="tcpin.return.number"></option>
            <option value="sit" data-i18n="tcpin.return.never"></option>
            <option value="immed" data-i18n="tcpin.return.immed"></option>
        </select>
        <input type="text" id="node-input-splitc" style="width:50px;">
        <span id="node-units"></span>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('tcp request',{
        category: 'function',
        color:"Silver",
        defaults: {
            server: {value:""},
            port: {value:"",validate:RED.validators.regex(/^(\d*|)$/)},
            out: {value:"time",required:true},
            splitc: {value:"0",required:true},
            name: {value:""}
        },
        inputs:1,
        outputs:1,
        icon: "bridge-dash.png",
        label: function() {
            return this.name || "tcp:"+(this.server?this.server+":":"")+this.port;
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var previous = null;
            $("#node-input-out").on('focus', function () { previous = this.value; }).change(function() {
                if (previous === null) { previous = $("#node-input-out").val(); }
                if ($("#node-input-out").val() == "char") {
                    if (previous != "char") { $("#node-input-splitc").val("\\n"); }
                    $("#node-units").text("");
                }
                else if ($("#node-input-out").val() == "time") {
                    if (previous != "time") { $("#node-input-splitc").val("0"); }
                    $("#node-units").text(RED._("node-red:tcpin.label.ms"));
                }
                else if ($("#node-input-out").val() == "immed") {
                    if (previous != "immed") { $("#node-input-splitc").val(" "); }
                    $("#node-units").text("");
                }
                else if ($("#node-input-out").val() == "count") {
                    if (previous != "count") { $("#node-input-splitc").val("12"); }
                    $("#node-units").text(RED._("node-red:tcpin.label.chars"));
                }
                else {
                    if (previous != "sit") { $("#node-input-splitc").val(" "); }
                    $("#node-units").text("");
                }
            });
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="tcp in">
    <p>Provides a choice of TCP inputs. Can either connect to a remote TCP port,
       or accept incoming connections.</p>
    <p><b>Note: </b>On some systems you may need root or administrator access
    to access ports below 1024.</p>
</script>

<script type="text/x-red" data-help-name="tcp out">
    <p>Provides a choice of TCP outputs. Can either connect to a remote TCP port,
    accept incoming connections, or reply to messages received from a TCP In node.</p>
    <p>Only the <code>msg.payload</code> is sent.</p>
    <p>If <code>msg.payload</code> is a string containing a Base64 encoding of binary
    data, the Base64 decoding option will cause it to be converted back to binary
    before being sent.</p>
    <p>If <code>msg._session</code> is not present the payload is
    sent to <b>all</b> connected clients.</p>
    <p><b>Note: </b>On some systems you may need root or administrator access
    to access ports below 1024.</p>
</script>

<script type="text/x-red" data-help-name="tcp request">
    <p>A simple TCP request node - sends the <code>msg.payload</code> to a server tcp port and expects a response.</p>
    <p>Connects, sends the "request", and reads the "response". It can either count a number of
    returned characters into a fixed buffer, match a specified character before returning,
    wait a fixed timeout from first reply and then return, sit and wait for data, or send then close the connection
    immediately, without waiting for a reply.</p>
    <p>The response will be output in <code>msg.payload</code> as a buffer, so you may want to .toString() it.</p>
    <p>If you leave tcp host or port blank they must be set by using the <code>msg.host</code> and <code>msg.port</code> properties.</p>
</script>

</div><div><!-- --- [red-module:node-red/udp] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<!--  The Input Node  -->
<script type="text/x-red" data-template-name="udp in">
    <div class="form-row">
        <label for="node-input-port"><i class="fa fa-sign-in"></i> <span data-i18n="udp.label.listen"></span></label>
        <select id="node-input-multicast" style='width:70%'>
          <option value="false" data-i18n="udp.udpmsgs"></option>
          <option value="true" data-i18n="udp.mcmsgs"></option>
        </select>
    </div>
    <div class="form-row node-input-group">
        <label for="node-input-group"><i class="fa fa-list"></i> <span data-i18n="udp.label.group"></span></label>
        <input type="text" id="node-input-group" placeholder="225.0.18.83">
    </div>
    <div class="form-row node-input-iface">
        <label for="node-input-iface"><i class="fa fa-random"></i> <span data-i18n="udp.label.interface"></span></label>
        <input type="text" id="node-input-iface" data-i18n="[placeholder]udp.placeholder.interfaceprompt">
    </div>
    <div class="form-row">
        <label for="node-input-port"><i class="fa fa-sign-in"></i> <span data-i18n="udp.label.onport"></span></label>
        <input type="text" id="node-input-port" style="width:80px">
        &nbsp;&nbsp;<span data-i18n="udp.label.using"></span> <select id="node-input-ipv" style="width:80px">
          <option value="udp4">ipv4</option>
          <option value="udp6">ipv6</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-datatype"><i class="fa fa-sign-out"></i> <span data-i18n="udp.label.output"></span></label>
        <select id="node-input-datatype" style="width:70%;">
            <option value="buffer" data-i18n="udp.output.buffer"></option>
            <option value="utf8" data-i18n="udp.output.string"></option>
            <option value="base64" data-i18n="udp.output.base64"></option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-tips"><span data-i18n="udp.tip.in"></span></div>
    <div class="form-tips" id="udpporttip"><span data-i18n="[html]udp.tip.port"></span></div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('udp in',{
        category: 'input',
        color:"Silver",
        defaults: {
            name: {value:""},
            iface: {value:""},
            port: {value:"",required:true,validate:RED.validators.number()},
            ipv: {value:"udp4"},
            multicast: {value:"false"},
            group: {value:"",validate:function(v) { return (this.multicast !== "true")||v.length > 0;} },
            datatype: {value:"buffer",required:true}
        },
        inputs:0,
        outputs:1,
        icon: "bridge-dash.png",
        label: function() {
            if (this.multicast=="false") {
                return this.name||"udp "+this.port;
            }
            else {
                return this.name||"udp "+(this.group+":"+this.port);
            }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            $("#node-input-multicast").change(function() {
                var id = $("#node-input-multicast").val();
                if (id == "false") {
                    $(".node-input-group").hide();
                    $(".node-input-iface").hide();
                }
                else {
                    $(".node-input-group").show();
                    $(".node-input-iface").show();
                }
            });
            $("#node-input-multicast").change();

            var porttip = this._("udp.tip.port");
            var alreadyused = this._("udp.errors.alreadyused");
            var portsInUse = {};
            $.getJSON('udp-ports/'+this.id,function(data) {
                portsInUse = data || {};
                $('#udpporttip').html(porttip + data);
            });
            $("#node-input-port").change(function() {
                var portnew = $("#node-input-port").val();
                if (portsInUse.hasOwnProperty($("#node-input-port").val())) {
                    RED.notify(alreadyused+" "+$("#node-input-port").val(),"warn");
                }
            });
        }
    });
</script>


<!--  The Output Node  -->
<script type="text/x-red" data-template-name="udp out">
    <div class="form-row">
        <label for="node-input-port"><i class="fa fa-envelope"></i> <span data-i18n="udp.label.send"></span></label>
        <select id="node-input-multicast" style="width:40%">
          <option value="false" data-i18n="udp.udpmsg"></option>
          <option value="broad" data-i18n="udp.bcmsg"></option>
          <option value="multi" data-i18n="udp.mcmsg"></option>
        </select>
        <span data-i18n="udp.label.toport"></span> <input type="text" id="node-input-port" style="width:70px">
    </div>
    <div class="form-row node-input-addr">
        <label for="node-input-addr" id="node-input-addr-label"><i class="fa fa-list"></i> <span data-i18n="udp.label.address"></span></label>
        <input type="text" id="node-input-addr" data-i18n="[placeholder]udp.placeholder.address" style="width:50%;">
        <select id="node-input-ipv" style="width:70px">
          <option value="udp4">ipv4</option>
          <option value="udp6">ipv6</option>
        </select>
    </div>
    <div class="form-row node-input-iface">
        <label for="node-input-iface"><i class="fa fa-random"></i> <span data-i18n="udp.label.interface"></span></label>
        <input type="text" id="node-input-iface" data-i18n="[placeholder]udp.placeholder.interface">
    </div>
    <div class="form-row">
        <label for="node-input-outport-type">&nbsp;</label>
        <select id="node-input-outport-type">
          <option id="node-input-outport-type-random" value="random" data-i18n="udp.bind.random"></option>
          <option value="fixed" data-i18n="udp.bind.local"></option>
        </select>
        <input type="text" id="node-input-outport" style="width:70px;">
    </div>
    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-base64" style="display:inline-block; width:auto; vertical-align:top;">
        <label for="node-input-base64" style="width:70%;"><span data-i18n="udp.label.decode-base64"></span></label>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-tips"><span data-i18n="[html]udp.tip.out"></span></div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('udp out',{
        category: 'output',
        color:"Silver",
        defaults: {
            name: {value:""},
            addr: {value:""},
            iface: {value:""},
            port: {value:""},
            ipv: {value:"udp4"},
            outport: {value:""},
            base64: {value:false,required:true},
            multicast: {value:"false"}
        },
        inputs:1,
        outputs:0,
        icon: "bridge-dash.png",
        align: "right",
        label: function() {
            return this.name||"udp "+(this.addr+":"+this.port);
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var addresslabel = this._("udp.label.address");
            var addressph = this._("udp.placeholder.address");
            var grouplabel = this._("udp.label.group");
            var bindrandom = this._("udp.bind.random");
            var bindtarget = this._("udp.bind.target");

            var type = this.outport===""?"random":"fixed";
            $("#node-input-outport-type").val(type);

            $("#node-input-outport-type").change(function() {
                var type = $(this).val();
                if (type == "random") {
                    $("#node-input-outport").val("").hide();
                } else {
                    $("#node-input-outport").show();
                }
            });
            $("#node-input-outport-type").change();

            $("#node-input-multicast").change(function() {
                var id = $("#node-input-multicast").val();
                if (id === "multi") {
                    $(".node-input-iface").show();
                    $("#node-input-addr-label").html('<i class="fa fa-list"></i> ' + grouplabel);
                    $("#node-input-addr")[0].placeholder = '225.0.18.83';
                }
                else if (id === "broad") {
                    $(".node-input-iface").hide();
                    $("#node-input-addr-label").html('<i class="fa fa-list"></i> ' + addresslabel);
                    $("#node-input-addr")[0].placeholder = '255.255.255.255';
                }
                else {
                    $(".node-input-iface").hide();
                    $("#node-input-addr-label").html('<i class="fa fa-list"></i> ' + addresslabel);
                    $("#node-input-addr")[0].placeholder = addressph;
                }
                var type = $(this).val();
                if (type == "false") {
                    $("#node-input-outport-type-random").html(bindrandom);
                } else {
                    $("#node-input-outport-type-random").html(bindtarget);
                }
            });
            $("#node-input-multicast").change();
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="udp in">
    <p>A UDP input node, that produces a <code>msg.payload</code> containing a
    Buffer, string, or base64 encoded string. Supports multicast.</p>
    <p>It also provides <code>msg.ip</code> and <code>msg.port</code> set to the
    ip address and port from which the message was received.</p>
    <p><b>Note</b>: On some systems you may need root or administrator access to use
    ports below 1024 and/or broadcast.</p>
</script>

<script type="text/x-red" data-help-name="udp out">
    <p>This node sends <code>msg.payload</code> to the designated UDP host and port. Supports multicast.</p>
    <p>You may also use <code>msg.ip</code> and <code>msg.port</code> to set the destination values, but the statically configured values have precedence.</p>
    <p>If you select broadcast either set the address to the local broadcast ip address, or maybe try 255.255.255.255, which is the global broadcast address.</p>
    <p><b>Note</b>: On some systems you may need to be root to use ports below 1024 and/or broadcast.</p>
</script>

</div><div><!-- --- [red-module:node-red/switch] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="switch">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-row">
        <label for="node-input-property"><i class="fa fa-ellipsis-h"></i> <span data-i18n="switch.label.property"></span></label>
        <input type="text" id="node-input-property" style="width: 70%"/>
        <input type="hidden" id="node-input-outputs"/>
    </div>
    <div class="form-row node-input-rule-container-row">
        <ol id="node-input-rule-container"></ol>
    </div>
    <div class="form-row">
        <select id="node-input-checkall" style="width:100%; margin-right:5px;">
            <option value="true" data-i18n="switch.checkall"></option>
            <option value="false" data-i18n="switch.stopfirst"></option>
        </select>
    </div>
    <div class="form-row">
        <input type="checkbox" id="node-input-repair" style="display: inline-block; width: auto; vertical-align: top;">
        <label style="width: auto;" for="node-input-repair"><span data-i18n="switch.label.repair"></span></label></input>
    </div>
</script>

<script type="text/javascript">
(function() {
    var operators = [
        {v:"eq",t:"==",kind:'V'},
        {v:"neq",t:"!=",kind:'V'},
        {v:"lt",t:"<",kind:'V'},
        {v:"lte",t:"<=",kind:'V'},
        {v:"gt",t:">",kind:'V'},
        {v:"gte",t:">=",kind:'V'},
        {v:"btwn",t:"switch.rules.btwn",kind:'V'},
        {v:"cont",t:"switch.rules.cont",kind:'V'},
        {v:"regex",t:"switch.rules.regex",kind:'V'},
        {v:"true",t:"switch.rules.true",kind:'V'},
        {v:"false",t:"switch.rules.false",kind:'V'},
        {v:"null",t:"switch.rules.null",kind:'V'},
        {v:"nnull",t:"switch.rules.nnull",kind:'V'},
        {v:"istype",t:"switch.rules.istype",kind:'V'},
        {v:"empty",t:"switch.rules.empty",kind:'V'},
        {v:"nempty",t:"switch.rules.nempty",kind:'V'},
        {v:"head",t:"switch.rules.head",kind:'S'},
        {v:"index",t:"switch.rules.index",kind:'S'},
        {v:"tail",t:"switch.rules.tail",kind:'S'},
        {v:"jsonata_exp",t:"switch.rules.exp",kind:'O'},
        {v:"else",t:"switch.rules.else",kind:'O'}
    ];

    function clipValueLength(v) {
        if (v.length > 15) {
            return v.substring(0,15)+"...";
        }
        return v;
    }
    function prop2name(key) {
        var result = RED.utils.parseContextKey(key);
        return result.key;
    }
    function getValueLabel(t,v) {
        if (t === 'str') {
            return '"'+clipValueLength(v)+'"';
        } else if (t === 'msg') {
            return t+"."+clipValueLength(v);
        } else if (t === 'flow' || t === 'global') {
            return t+"."+clipValueLength(prop2name(v));
        }
        return clipValueLength(v);
    }
    RED.nodes.registerType('switch', {
        color: "#E2D96E",
        category: 'function',
        defaults: {
            name: {value:""},
            property: {value:"payload", required:true, validate: RED.validators.typedInput("propertyType")},
            propertyType: { value:"msg" },
            rules: {value:[{t:"eq", v:"", vt:"str"}]},
            checkall: {value:"true", required:true},
            repair: {value:false},
            outputs: {value:1}
        },
        inputs: 1,
        outputs: 1,
        outputLabels: function(index) {
            var rule = this.rules[index];
            var label = "";
            if (rule) {
                for (var i=0;i<operators.length;i++) {
                    if (operators[i].v === rule.t) {
                        label = /^switch/.test(operators[i].t)?this._(operators[i].t):operators[i].t;
                        break;
                    }
                }
                if ((rule.t === 'btwn') || (rule.t === 'index')) {
                    label += " "+getValueLabel(rule.vt,rule.v)+" & "+getValueLabel(rule.v2t,rule.v2);
                } else if (rule.t !== 'true' && rule.t !== 'false' && rule.t !== 'null' && rule.t !== 'nnull' && rule.t !== 'empty' && rule.t !== 'nempty' && rule.t !== 'else' ) {
                    label += " "+getValueLabel(rule.vt,rule.v);
                }
                return label;
            }
        },
        icon: "switch.png",
        label: function() {
            return this.name||this._("switch.switch");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var node = this;
            var previousValueType = {value:"prev",label:this._("inject.previous"),hasValue:false};

            $("#node-input-property").typedInput({default:this.propertyType||'msg',types:['msg','flow','global','jsonata']});
            var outputCount = $("#node-input-outputs").val("{}");

            var andLabel = this._("switch.and");
            var caseLabel = this._("switch.ignorecase");

            function resizeRule(rule) {
                var newWidth = rule.width();
                var selectField = rule.find("select");
                var type = selectField.val()||"";
                var valueField = rule.find(".node-input-rule-value");
                var typeField = rule.find(".node-input-rule-type-value");
                var numField = rule.find(".node-input-rule-num-value");
                var expField = rule.find(".node-input-rule-exp-value");
                var btwnField1 = rule.find(".node-input-rule-btwn-value");
                var btwnField2 = rule.find(".node-input-rule-btwn-value2");
                var selectWidth;
                if (type.length < 4) {
                    selectWidth = 60;
                } else if (type === "regex") {
                    selectWidth = 147;
                } else {
                    selectWidth = 120;
                }
                selectField.width(selectWidth);
                if ((type === "btwn") || (type === "index")) {
                    btwnField1.typedInput("width",(newWidth-selectWidth-70));
                    btwnField2.typedInput("width",(newWidth-selectWidth-70));
                } else if ((type === "head") || (type === "tail")) {
                    numField.typedInput("width",(newWidth-selectWidth-70));
                } else if (type === "jsonata_exp") {
                    expField.typedInput("width",(newWidth-selectWidth-70));
                } else if (type === "istype") {
                    typeField.typedInput("width",(newWidth-selectWidth-70));
                } else {
                    if (type === "true" || type === "false" || type === "null" || type === "nnull" || type === "empty" || type === "nempty" || type === "else") {
                        // valueField.hide();
                    } else {
                        valueField.typedInput("width",(newWidth-selectWidth-70));
                    }
                }
            }

            $("#node-input-rule-container").css('min-height','250px').css('min-width','450px').editableList({
                addItem: function(container,i,opt) {
                    if (!opt.hasOwnProperty('r')) {
                        opt.r = {};
                    }
                    var rule = opt.r;
                    if (!rule.hasOwnProperty('t')) {
                        rule.t = 'eq';
                    }
                    if (!opt.hasOwnProperty('i')) {
                        opt._i = Math.floor((0x99999-0x10000)*Math.random()).toString();
                    }
                    container.css({
                        overflow: 'hidden',
                        whiteSpace: 'nowrap'
                    });
                    var row = $('<div></operators>').appendTo(container);
                    var row2 = $('<div></div>',{style:"padding-top: 5px; padding-left: 175px;"}).appendTo(container);
                    var row3 = $('<div></div>',{style:"padding-top: 5px; padding-left: 102px;"}).appendTo(container);
                    var selectField = $('<select></select>',{style:"width:120px; margin-left: 5px; text-align: center;"}).appendTo(row);
                    var group0 = $('<optgroup></optgroup>', { label: "value rules" }).appendTo(selectField);
                    for (var d in operators) {
                        if(operators[d].kind === 'V') {
                            group0.append($("<option></option>").val(operators[d].v).text(/^switch/.test(operators[d].t)?node._(operators[d].t):operators[d].t));
                        }
                    }
                    var group1 = $('<optgroup></optgroup>', { label: "sequence rules" }).appendTo(selectField);
                    for (var d in operators) {
                        if(operators[d].kind === 'S') {
                            group1.append($("<option></option>").val(operators[d].v).text(/^switch/.test(operators[d].t)?node._(operators[d].t):operators[d].t));
                        }
                    }
                    for (var d in operators) {
                        if(operators[d].kind === 'O') {
                            selectField.append($("<option></option>").val(operators[d].v).text(/^switch/.test(operators[d].t)?node._(operators[d].t):operators[d].t));
                        }
                    }
                    var valueField = $('<input/>',{class:"node-input-rule-value",type:"text",style:"margin-left: 5px;"}).appendTo(row).typedInput({default:'str',types:['msg','flow','global','str','num','jsonata','env',previousValueType]});
                    var numValueField = $('<input/>',{class:"node-input-rule-num-value",type:"text",style:"margin-left: 5px;"}).appendTo(row).typedInput({default:'num',types:['flow','global','num','jsonata','env']});
                    var expValueField = $('<input/>',{class:"node-input-rule-exp-value",type:"text",style:"margin-left: 5px;"}).appendTo(row).typedInput({default:'jsonata',types:['jsonata']});
                    var btwnValueField = $('<input/>',{class:"node-input-rule-btwn-value",type:"text",style:"margin-left: 5px;"}).appendTo(row).typedInput({default:'num',types:['msg','flow','global','str','num','jsonata','env',previousValueType]});
                    var btwnAndLabel = $('<span></span>',{class:"node-input-rule-btwn-label"}).text(" "+andLabel+" ").appendTo(row3);
                    var btwnValue2Field = $('<input/>',{class:"node-input-rule-btwn-value2",type:"text",style:"margin-left:2px;"}).appendTo(row3).typedInput({default:'num',types:['msg','flow','global','str','num','jsonata','env',previousValueType]});
                    var typeValueField = $('<input/>',{class:"node-input-rule-type-value",type:"text",style:"margin-left: 5px;"}).appendTo(row)
                        .typedInput({default:'string',types:[
                            {value:"string",label:"string",hasValue:false},
                            {value:"number",label:"number",hasValue:false},
                            {value:"boolean",label:"boolean",hasValue:false},
                            {value:"array",label:"array",hasValue:false},
                            {value:"buffer",label:"buffer",hasValue:false},
                            {value:"object",label:"object",hasValue:false},
                            {value:"json",label:"JSON string",hasValue:false},
                            {value:"undefined",label:"undefined",hasValue:false},
                            {value:"null",label:"null",hasValue:false}
                        ]});
                    var finalspan = $('<span></span>',{style:"float: right;margin-top: 6px;"}).appendTo(row);
                    finalspan.append(' &#8594; <span class="node-input-rule-index">'+(i+1)+'</span> ');
                    var caseSensitive = $('<input/>',{id:"node-input-rule-case-"+i,class:"node-input-rule-case",type:"checkbox",style:"width:auto;vertical-align:top"}).appendTo(row2);
                    $('<label></label>',{for:"node-input-rule-case-"+i,style:"margin-left: 3px;"}).text(caseLabel).appendTo(row2);
                    selectField.change(function() {
                        resizeRule(container);
                        var type = selectField.val();
                        if ((type === "btwn") || (type === "index")) {
                            valueField.typedInput('hide');
                            expValueField.typedInput('hide');
                            numValueField.typedInput('hide');
                            typeValueField.typedInput('hide');
                            btwnValueField.typedInput('show');
                        } else if ((type === "head") || (type === "tail")) {
                            btwnValueField.typedInput('hide');
                            btwnValue2Field.typedInput('hide');
                            expValueField.typedInput('hide');
                            numValueField.typedInput('show');
                            typeValueField.typedInput('hide');
                            valueField.typedInput('hide');
                        } else if (type === "jsonata_exp") {
                            btwnValueField.typedInput('hide');
                            btwnValue2Field.typedInput('hide');
                            expValueField.typedInput('show');
                            numValueField.typedInput('hide');
                            typeValueField.typedInput('hide');
                            valueField.typedInput('hide');
                        } else {
                            btwnValueField.typedInput('hide');
                            expValueField.typedInput('hide');
                            numValueField.typedInput('hide');
                            typeValueField.typedInput('hide');
                            valueField.typedInput('hide');
                            if (type === "true" || type === "false" || type === "null" || type === "nnull" || type === "empty" || type === "nempty" || type === "else") {
                                valueField.typedInput('hide');
                                typeValueField.typedInput('hide');
                            }
                            else
                            if (type === "istype") {
                                valueField.typedInput('hide');
                                typeValueField.typedInput('show');
                            }
                            else {
                                typeValueField.typedInput('hide');
                                valueField.typedInput('show');
                            }
                        }
                        if (type === "regex") {
                            row2.show();
                            row3.hide();
                        } else if ((type === "btwn") || (type === "index")) {
                            row2.hide();
                            row3.show();
                            btwnValue2Field.typedInput('show');
                        } else {
                            row2.hide();
                            row3.hide();
                        }
                    });
                    selectField.val(rule.t);
                    if ((rule.t == "btwn") || (rule.t == "index")) {
                        btwnValueField.typedInput('value',rule.v);
                        btwnValueField.typedInput('type',rule.vt||'num');
                        btwnValue2Field.typedInput('value',rule.v2);
                        btwnValue2Field.typedInput('type',rule.v2t||'num');
                    } else if ((rule.t === "head") || (rule.t === "tail")) {
                        numValueField.typedInput('value',rule.v);
                        numValueField.typedInput('type',rule.vt||'num');
                    } else if (rule.t === "istype") {
                        typeValueField.typedInput('value',rule.vt);
                        typeValueField.typedInput('type',rule.vt);
                    } else if (rule.t === "jsonata_exp") {
                        expValueField.typedInput('value',rule.v);
                        expValueField.typedInput('type',rule.vt||'jsonata');
                    } else if (typeof rule.v != "undefined") {
                        valueField.typedInput('value',rule.v);
                        valueField.typedInput('type',rule.vt||'str');
                    }
                    if (rule.case) {
                        caseSensitive.prop('checked',true);
                    } else {
                        caseSensitive.prop('checked',false);
                    }
                    selectField.change();

                    var currentOutputs = JSON.parse(outputCount.val()||"{}");
                    currentOutputs[opt.hasOwnProperty('i')?opt.i:opt._i] = i;
                    outputCount.val(JSON.stringify(currentOutputs));
                },
                removeItem: function(opt) {
                    var currentOutputs = JSON.parse(outputCount.val()||"{}");
                    if (opt.hasOwnProperty('i')) {
                        currentOutputs[opt.i] = -1;
                    } else {
                        delete currentOutputs[opt._i];
                    }
                    var rules = $("#node-input-rule-container").editableList('items');
                    rules.each(function(i) {
                        $(this).find(".node-input-rule-index").html(i+1);
                        var data = $(this).data('data');
                        currentOutputs[data.hasOwnProperty('i')?data.i:data._i] = i;
                    });
                    outputCount.val(JSON.stringify(currentOutputs));
                },
                resizeItem: resizeRule,
                sortItems: function(rules) {
                    var currentOutputs = JSON.parse(outputCount.val()||"{}");
                    var rules = $("#node-input-rule-container").editableList('items');
                    rules.each(function(i) {
                        $(this).find(".node-input-rule-index").html(i+1);
                        var data = $(this).data('data');
                        currentOutputs[data.hasOwnProperty('i')?data.i:data._i] = i;
                    });
                    outputCount.val(JSON.stringify(currentOutputs));
                },
                sortable: true,
                removable: true
            });

            for (var i=0;i<this.rules.length;i++) {
                var rule = this.rules[i];
                $("#node-input-rule-container").editableList('addItem',{r:rule,i:i});
            }
        },
        oneditsave: function() {
            var rules = $("#node-input-rule-container").editableList('items');
            var ruleset;
            var node = this;
            node.rules = [];
            rules.each(function(i) {
                var ruleData = $(this).data('data');
                var rule = $(this);
                var type = rule.find("select").val();
                var r = {t:type};
                if (!(type === "true" || type === "false" || type === "null" || type === "nnull" || type === "empty" || type === "nempty" || type === "else")) {
                    if ((type === "btwn") || (type === "index")) {
                        r.v = rule.find(".node-input-rule-btwn-value").typedInput('value');
                        r.vt = rule.find(".node-input-rule-btwn-value").typedInput('type');
                        r.v2 = rule.find(".node-input-rule-btwn-value2").typedInput('value');
                        r.v2t = rule.find(".node-input-rule-btwn-value2").typedInput('type');
                    } else if ((type === "head") || (type === "tail")) {
                        r.v = rule.find(".node-input-rule-num-value").typedInput('value');
                        r.vt = rule.find(".node-input-rule-num-value").typedInput('type');
                    } else if (type === "istype") {
                        r.v = rule.find(".node-input-rule-type-value").typedInput('type');
                        r.vt = rule.find(".node-input-rule-type-value").typedInput('type');
                    } else if (type === "jsonata_exp") {
                        r.v = rule.find(".node-input-rule-exp-value").typedInput('value');
                        r.vt = rule.find(".node-input-rule-exp-value").typedInput('type');
                    } else {
                        r.v = rule.find(".node-input-rule-value").typedInput('value');
                        r.vt = rule.find(".node-input-rule-value").typedInput('type');
                    }
                    if (type === "regex") {
                        r.case = rule.find(".node-input-rule-case").prop("checked");
                    }
                }
                node.rules.push(r);
            });
            this.propertyType = $("#node-input-property").typedInput('type');
        },
        oneditresize: function(size) {
            var rows = $("#dialog-form>div:not(.node-input-rule-container-row)");
            var height = size.height;
            for (var i=0;i<rows.size();i++) {
                height -= $(rows[i]).outerHeight(true);
            }
            var editorRow = $("#dialog-form>div.node-input-rule-container-row");
            height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));
            $("#node-input-rule-container").editableList('height',height);
        }
    });
})();
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="switch">
    <p>Route messages based on their property values or sequence position.</p>
    <h3>Details</h3>
    <p>When a message arrives, the node will evaluate each of the defined rules
    and forward the message to the corresponding outputs of any matching rules.</p>
    <p>Optionally, the node can be set to stop evaluating rules once it finds one
    that matches.</p>
    <p>The rules can be evaluated against an individual message property, a flow or global
    context property or the result of a JSONata expression.</p>
    <h4>Rules</h4>
    <p>There are four types of rule:</p>
    <ol>
        <li><b>Value</b> rules are evaluated against the configured property</li>
        <li><b>Sequence</b> rules can be used on message sequences, such as those
            generated by the Split node</li>
        <li>A JSONata <b>Expression</b> can be provided that will be evaluated
            against the whole message and will match if the expression returns
            a true value.</li>
        <li>An <b>Otherwise</b> rule can be used to match if none of the preceeding
            rules have matched.</li>
    </ol>
    <h4>Notes</h4>
    <p>The <code>is true/false</code> and <code>is null</code> rules perform strict
       comparisons against those types. They do not convert between types.</p>
    <p>The <code>is empty</code> rule passes for Strings, Arrays and Buffers that have
       a length of 0, or Objects that have no properties. It does not pass for <code>null</code>
       or <code>undefined</code> values.</p>
    <h4>Handling message sequences</h4>
    <p>By default, the node does not modify the <code>msg.parts</code> property of messages
       that are part of a sequence.</p>
    <p>The <b>recreate message sequences</b> option can be enabled to generate new message sequences
       for each rule that matches. In this mode, the node will buffer the entire incoming
       sequence before sending the new sequences on. The runtime setting <code>nodeMessageBufferMaxLength</code>
       can be used to limit how many messages nodes will buffer.</p>
</script>

</div><div><!-- --- [red-module:node-red/change] --- -->

<script type="text/x-red" data-template-name="change">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-row" style="margin-bottom:0;">
        <label><i class="fa fa-list"></i> <span data-i18n="change.label.rules"></span></label>
    </div>
    <div class="form-row node-input-rule-container-row">
        <ol id="node-input-rule-container"></ol>
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('change', {
        color: "#E2D96E",
        category: 'function',
        defaults: {
            name: {value:""},
            rules:{value:[{t:"set",p:"payload",pt:"msg",to:"",tot:"str"}]},
            // legacy
            action: {value:""},
            property: {value:""},
            from: {value:""},
            to: {value:""},
            reg: {value:false}
        },
        inputs: 1,
        outputs: 1,
        icon: "swap.png",
        label: function() {
            function prop2name(type, key) {
                var result = RED.utils.parseContextKey(key);
                return type +"." +result.key;
            }
            if (this.name) {
                return this.name;
            }
            if (!this.rules) {
                if (this.action === "replace") {
                    return this._("change.label.set",{property:"msg."+this.property});
                } else if (this.action === "change") {
                    return this._("change.label.change",{property:"msg."+this.property});
                } else if (this.action === "move") {
                    return this._("change.label.move",{property:"msg."+this.property});
                } else {
                    return this._("change.label.delete",{property:"msg."+this.property});
                }
            } else {
                if (this.rules.length == 1) {
                    if (this.rules[0].t === "set") {
                        return this._("change.label.set",{property:prop2name((this.rules[0].pt||"msg"), this.rules[0].p)});
                    } else if (this.rules[0].t === "change") {
                        return this._("change.label.change",{property:prop2name((this.rules[0].pt||"msg"), this.rules[0].p)});
                    } else if (this.rules[0].t === "move") {
                        return this._("change.label.move",{property:prop2name((this.rules[0].pt||"msg"), this.rules[0].p)});
                    } else {
                        return this._("change.label.delete",{property:prop2name((this.rules[0].pt||"msg"), this.rules[0].p)});
                    }
                } else {
                    return this._("change.label.changeCount",{count:this.rules.length});
                }
            }
        },
        labelStyle: function() {
            return this.name ? "node_label_italic" : "";
        },
        oneditprepare: function() {
            var set = this._("change.action.set");
            var change = this._("change.action.change");
            var del = this._("change.action.delete");
            var move = this._("change.action.move");
            var to = this._("change.action.to");
            var search = this._("change.action.search");
            var replace = this._("change.action.replace");
            var regex = this._("change.label.regex");

            function resizeRule(rule) {
                var newWidth = rule.width();
                rule.find('.red-ui-typedInput').typedInput("width",newWidth-130);

            }
            $('#node-input-rule-container').css('min-height','300px').css('min-width','450px').editableList({
                addItem: function(container,i,opt) {
                    var rule = opt;
                    if (!rule.hasOwnProperty('t')) {
                        rule = {t:"set",p:"payload",to:"",tot:"str"};
                    }
                    if (rule.t === "change" && rule.re) {
                        rule.fromt = 're';
                        delete rule.re;
                    }
                    if (rule.t === "set" && !rule.tot) {
                        if (rule.to.indexOf("msg.") === 0 && !rule.tot) {
                            rule.to = rule.to.substring(4);
                            rule.tot = "msg";
                        } else {
                            rule.tot = "str";
                        }
                    }
                    if (rule.t === "move" && !rule.tot) {
                        rule.tot = "msg";
                    }
                    container.css({
                        overflow: 'hidden',
                        whiteSpace: 'nowrap'
                    });
                    var row1 = $('<div></div>').appendTo(container);
                    var row2 = $('<div></div>',{style:"margin-top:8px;"}).appendTo(container);
                    var row3 = $('<div></div>',{style:"margin-top:8px;"}).appendTo(container);
                    var row4 = $('<div></div>',{style:"margin-top:8px;"}).appendTo(container);

                    var selectField = $('<select></select>',{class:"node-input-rule-type",style:"width:110px; margin-right:10px;"}).appendTo(row1);
                    var selectOptions = [{v:"set",l:set},{v:"change",l:change},{v:"delete",l:del},{v:"move",l:move}];
                    for (var i=0; i<4; i++) {
                        selectField.append($("<option></option>").val(selectOptions[i].v).text(selectOptions[i].l));
                    }

                    var propertyName = $('<input/>',{class:"node-input-rule-property-name",type:"text"})
                        .appendTo(row1)
                        .typedInput({types:['msg','flow','global']});

                    $('<div></div>',{style:"display:inline-block;text-align:right; width:120px; padding-right:10px; box-sizing:border-box;"})
                        .text(to)
                        .appendTo(row2);
                    var propertyValue = $('<input/>',{class:"node-input-rule-property-value",type:"text"})
                        .appendTo(row2)
                        .typedInput({default:'str',types:['msg','flow','global','str','num','bool','json','bin','date','jsonata','env']});

                    var row3_1 = $('<div></div>').appendTo(row3);
                    $('<div></div>',{style:"display:inline-block;text-align:right; width:120px; padding-right:10px; box-sizing:border-box;"})
                        .text(search)
                        .appendTo(row3_1);
                    var fromValue = $('<input/>',{class:"node-input-rule-property-search-value",type:"text"})
                        .appendTo(row3_1)
                        .typedInput({default:'str',types:['msg','flow','global','str','re','num','bool','env']});

                    var row3_2 = $('<div></div>',{style:"margin-top:8px;"}).appendTo(row3);
                    $('<div></div>',{style:"display:inline-block;text-align:right; width:120px; padding-right:10px; box-sizing:border-box;"})
                        .text(replace)
                        .appendTo(row3_2);
                    var toValue = $('<input/>',{class:"node-input-rule-property-replace-value",type:"text"})
                        .appendTo(row3_2)
                        .typedInput({default:'str',types:['msg','flow','global','str','num','bool','json','bin','env']});

                    $('<div></div>',{style:"display:inline-block;text-align:right; width:120px; padding-right:10px; box-sizing:border-box;"})
                        .text(to)
                        .appendTo(row4);
                    var moveValue = $('<input/>',{class:"node-input-rule-property-move-value",type:"text"})
                        .appendTo(row4)
                        .typedInput({default:'msg',types:['msg','flow','global']});

                    selectField.change(function() {
                        var width = $("#node-input-rule-container").width();
                        var type = $(this).val();
                        if (type == "set") {
                            row2.show();
                            row3.hide();
                            row4.hide();
                        } else if (type == "change") {
                            row2.hide();
                            row3.show();
                            row4.hide();
                        } else if (type == "delete") {
                            row2.hide();
                            row3.hide();
                            row4.hide();
                        } else if (type == "move") {
                            row2.hide();
                            row3.hide();
                            row4.show();
                        }
                        resizeRule(container);
                    });

                    selectField.val(rule.t);
                    propertyName.typedInput('value',rule.p);
                    propertyName.typedInput('type',rule.pt);
                    propertyValue.typedInput('value',rule.to);
                    propertyValue.typedInput('type',rule.tot);
                    moveValue.typedInput('value',rule.to);
                    moveValue.typedInput('type',rule.tot);
                    fromValue.typedInput('value',rule.from);
                    fromValue.typedInput('type',rule.fromt);
                    toValue.typedInput('value',rule.to);
                    toValue.typedInput('type',rule.tot);
                    selectField.change();

                    var newWidth = $("#node-input-rule-container").width();
                    resizeRule(container);
                },
                resizeItem: resizeRule,
                removable: true,
                sortable: true
            });

            if (!this.rules) {
                var rule = {
                    t:(this.action=="replace"?"set":this.action),
                    p:this.property,
                    pt:"msg"
                };

                if ((rule.t === "set")||(rule.t === "move")) {
                    rule.to = this.to;
                } else if (rule.t === "change") {
                    rule.from = this.from;
                    rule.to = this.to;
                    rule.re = this.reg;
                }

                delete this.to;
                delete this.from;
                delete this.reg;
                delete this.action;
                delete this.property;

                this.rules = [rule];
            }

            for (var i=0; i<this.rules.length; i++) {
                var rule = this.rules[i];
                $("#node-input-rule-container").editableList('addItem',rule);
            }
        },
        oneditsave: function() {
            var rules = $("#node-input-rule-container").editableList('items');
            var ruleset;
            var node = this;
            node.rules= [];
            rules.each(function(i) {
                var rule = $(this);
                var type = rule.find(".node-input-rule-type").val();
                var r = {
                    t:type,
                    p:rule.find(".node-input-rule-property-name").typedInput('value'),
                    pt:rule.find(".node-input-rule-property-name").typedInput('type')
                };
                if (type === "set") {
                    r.to = rule.find(".node-input-rule-property-value").typedInput('value');
                    r.tot = rule.find(".node-input-rule-property-value").typedInput('type');
                } else if (type === "move") {
                    r.to = rule.find(".node-input-rule-property-move-value").typedInput('value');
                    r.tot = rule.find(".node-input-rule-property-move-value").typedInput('type');
                } else if (type === "change") {
                    r.from = rule.find(".node-input-rule-property-search-value").typedInput('value');
                    r.fromt = rule.find(".node-input-rule-property-search-value").typedInput('type');
                    r.to = rule.find(".node-input-rule-property-replace-value").typedInput('value');
                    r.tot = rule.find(".node-input-rule-property-replace-value").typedInput('type');
                }
                node.rules.push(r);
            });
        },
        oneditresize: function(size) {
            var rows = $("#dialog-form>div:not(.node-input-rule-container-row)");
            var height = size.height;
            for (var i=0; i<rows.size(); i++) {
                height -= $(rows[i]).outerHeight(true);
            }
            var editorRow = $("#dialog-form>div.node-input-rule-container-row");
            height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));

            $("#node-input-rule-container").editableList('height',height);
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="change">
    <p>Set, change, delete or move properties of a message, flow context or global context.</p>
    <p>The node can specify multiple rules that will be applied in the order they are defined.</p>
    <h3>Details</h3>
    <p>The available operations are:</p>
    <dl class="message-properties">
    <dt>Set</dt>
    <dd>set a property. The value can be a variety of different types, or
            can be taken from an existing message or context property.</dd>
    <dt>Change</dt>
    <dd>search &amp; replace parts of the property. If regular expressions
        are enabled, the "replace with" property can include capture groups, for
        example <code>$1</code>. Replace will only change the type if there
        is a complete match.</dd>
    <dt>Delete</dt>
    <dd>delete a property.</dd>
    <dt>Move</dt>
    <dd>move or rename a property.</dd>
    </dl>
    <p>The "expression" type uses the <a href="http://jsonata.org/" target="_new">JSONata</a>
    query and expression language.
    </p>
</script>

</div><div><!-- --- [red-module:node-red/range] --- -->

<script type="text/x-red" data-template-name="range">
    <div class="form-row">
        <label for="node-input-property"><i class="fa fa-ellipsis-h"></i> <span data-i18n="common.label.property"></span></label>
        <input type="text" id="node-input-property" style="width:calc(70% - 1px)"/>
    </div>
    <div class="form-row">
        <label for="node-input-action"><i class="fa fa-dot-circle-o"></i> <span data-i18n="range.label.action"></span></label>
        <select id="node-input-action" style="width:70%;">
            <option value="scale" data-i18n="range.scale.payload"></option>
            <option value="clamp" data-i18n="range.scale.limit"></option>
            <option value="roll" data-i18n="range.scale.wrap"></option>
        </select>
    </div>
    <br/>
    <div class="form-row"><i class="fa fa-sign-in"></i> <span data-i18n="range.label.inputrange"></span>:</div>
    <div class="form-row"><label></label>
        <span data-i18n="range.label.from"></span>: <input type="text" id="node-input-minin" data-i18n="[placeholder]range.placeholder.min" style="width:100px;"/>
        &nbsp;&nbsp;<span data-i18n="range.label.to"></span>: <input type="text" id="node-input-maxin" data-i18n="[placeholder]range.placeholder.maxin" style="width:100px;"/>
    </div>
    <div class="form-row"><i class="fa fa-sign-out"></i> <span data-i18n="range.label.resultrange"></span>:</div>
    <div class="form-row"><label></label>
        <span data-i18n="range.label.from"></span>: <input type="text" id="node-input-minout" data-i18n="[placeholder]range.placeholder.min" style="width:100px;"/>
        &nbsp;&nbsp;<span data-i18n="range.label.to"></span>: <input type="text" id="node-input-maxout" data-i18n="[placeholder]range.placeholder.maxout" style="width:100px;"/>
    </div>
    <br/>
    <div class="form-row"><label></label>
        <input type="checkbox" id="node-input-round" style="display: inline-block; width: auto; vertical-align: top;">
        <label style="width: auto;" for="node-input-round"><span data-i18n="range.label.roundresult"></span></label></input>
    </div>
    <br/>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-tips" id="node-tip"><span data-i18n="range.tip"></span></div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('range', {
        color: "#E2D96E",
        category: 'function',
        defaults: {
            minin: {value:"",required:true,validate:RED.validators.number()},
            maxin: {value:"",required:true,validate:RED.validators.number()},
            minout: {value:"",required:true,validate:RED.validators.number()},
            maxout: {value:"",required:true,validate:RED.validators.number()},
            action: {value:"scale"},
            round: {value:false},
            property: {value:"payload",required:true},
            name: {value:""}
        },
        inputs: 1,
        outputs: 1,
        icon: "range.png",
        label: function() {
            if (this.minout !== "" && this.maxout !== "") { return this.name||this.minout + " - " + this.maxout; }
            else { return this.name||this._("range.range"); }
        },
        labelStyle: function() {
            return this.name ? "node_label_italic" : "";
        },
        oneditprepare: function() {
            if (this.property === undefined) {
                $("#node-input-property").val("payload");
            }
            $("#node-input-property").typedInput({default:'msg',types:['msg']});
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="range">
    <p>Maps a numeric value to a different range.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">number</span></dt>
        <dd>The payload <i>must</i> be a number. Anything else will try to be
        parsed into a number and rejected if that fails.</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">number</span></dt>
        <dd>The value mapped to the new range.</dd>
    </dl>
    <h3>Details</h3>
    <p>This node will linearly scale the received value. By default, the result
       is not constrained to the range defined in the node.</p>
    <p><i>Scale and limit to target range</i> means that the result will never be outside
    the range specified within the result range.</p>
    <p><i>Scale and wrap within the target range</i> means that the result will
    be wrapped within the result range.</p>
</script>

</div><div><!-- --- [red-module:node-red/split] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="split">
    <div class="form-row"><span data-i18n="[html]split.intro"></span></div>
    <div class="form-row"><span data-i18n="[html]split.strBuff"></span></div>
    <div class="form-row">
        <label for="node-input-splt" style="padding-left:10px; margin-right:-10px;" data-i18n="split.splitUsing"></label>
        <input type="text" id="node-input-splt" style="width:70%">
        <input type="hidden" id="node-input-spltType">
    </div>
    <div class="form-row">
        <input type="checkbox" id="node-input-stream" style="margin-left:10px; vertical-align:top; width:auto;">
        <label for="node-input-stream" style="width:auto;" data-i18n="split.stream"></label>
    </div>
    <div class="form-row"><span data-i18n="[html]split.array"></span></div>
    <div class="form-row">
        <label for="node-input-arraySplt" style="padding-left:10px; margin-right:-10px;" data-i18n="split.splitUsing"></label>
        <input type="text" id="node-input-arraySplt" style="width:70%">
        <input type="hidden" id="node-input-arraySpltType">
    </div>
    <div class="form-row"><span data-i18n="[html]split.object"></span></div>
    <div class="form-row" style="padding-left: 10px"><span data-i18n="[html]split.objectSend"></span></div>
    <div class="form-row">
        <input type="checkbox" id="node-input-addname-cb" style="margin-left:10px; vertical-align:baseline; width:auto;">
        <label for="node-input-addname-cb" style="width:auto;" data-i18n="split.addname"></label>
        <input type="text" id="node-input-addname" style="width:70%">
    </div>
    <hr/>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('split',{
        category: 'function',
        color:"#E2D96E",
        defaults: {
            name: {value:""},
            splt: {value:"\\n"},
            spltType: {value:"str"},
            arraySplt: {value:1},
            arraySpltType: {value:"len"},
            stream: {value:false},
            addname: {value:""}
        },
        inputs:1,
        outputs:1,
        icon: "split.png",
        label: function() {
            return this.name||this._("split.split");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            $("#node-input-splt").typedInput({
                default: 'str',
                typeField: $("#node-input-spltType"),
                types:[
                    'str',
                    'bin',
                    {value:"len", label:RED._("node-red:split.splitLength"),validate:/^\d+$/}
                ]
            });
            if (this.arraySplt === undefined) {
                $("#node-input-arraySplt").val(1);
            }
            $("#node-input-arraySplt").typedInput({
                default: 'len',
                typeField: $("#node-input-arraySpltType"),
                types:[
                    {value:"len", label:RED._("node-red:split.splitLength"),validate:/^\d+$/}
                ]
            });
            $("#node-input-addname").typedInput({
                typeField: $("#node-input-fnameType"),
                types:['msg']
            });

            $("#node-input-addname-cb").change(function() {
                $("#node-input-addname").prop('disabled',!this.checked);
            })
            if (this.addname === "") {
                $("#node-input-addname-cb").prop('checked',false);
                $("#node-input-addname").val('topic');
            } else {
                $("#node-input-addname-cb").prop('checked',true);
            }
            $("#node-input-addname-cb").change();
        },
        oneditsave: function() {
            if (!$("#node-input-addname-cb").prop('checked')) {
                $("#node-input-addname").val('');
            }
        }
    });
</script>


<script type="text/x-red" data-template-name="join">
    <div class="form-row">
        <label data-i18n="join.mode.mode"></label>
        <select id="node-input-mode" style="width:200px;">
            <option value="auto" data-i18n="join.mode.auto"></option>
            <option value="custom" data-i18n="join.mode.custom"></option>
            <option value="reduce" data-i18n="join.mode.reduce"></option>
        </select>
    </div>
    <div class="node-row-custom">
        <div class="form-row node-row-property">
            <label data-i18n="join.combine"> </label>
            <input type="text" id="node-input-property" style="width:70%;">
            <input type="hidden" id="node-input-propertyType">
        </div>
        <div class="form-row">
            <label data-i18n="join.create"></label>
            <select id="node-input-build" style="width:70%;">
                <option value="string" data-i18n="join.type.string"></option>
                <option value="buffer" data-i18n="join.type.buffer"></option>
                <option value="array" data-i18n="join.type.array"></option>
                <option value="object" data-i18n="join.type.object"></option>
                <option value="merged" data-i18n="join.type.merged"></option>
            </select>
        </div>
        <div class="form-row node-row-key">
            <label style="vertical-align:top; margin-top:7px; width:auto; margin-right: 5px;" data-i18n="join.using"></label>
            <div style="display:inline-block">
                <input type="text" id="node-input-key" style="width:220px;"> <span data-i18n="join.key"></span>
            </div>
        </div>
        <div class="form-row node-row-joiner">
            <label for="node-input-joiner" data-i18n="join.joinedUsing"></label>
            <input type="text" id="node-input-joiner" style="width:70%">
            <input type="hidden" id="node-input-joinerType">
        </div>
        <div class="form-row node-row-trigger" id="trigger-row">
            <label style="width:auto;" data-i18n="join.send"></label>
            <ul>
                <li>
                    <label style="width:280px;" for="node-input-count" data-i18n="join.afterCount"></label> <input id="node-input-count" data-i18n="[placeholder]join.count" type="text" style="width:75px;">
                </li>
                <li class="node-row-accumulate" style="list-style-type:none;">
                    <input type="checkbox" id="node-input-accumulate" style="display:inline-block; width:20px; margin-left:20px; vertical-align:top;">  <label style="width: auto" for="node-input-accumulate" data-i18n="join.subsequent"></label>
                </li>
                <li>
                    <label style="width:280px;" for="node-input-timeout" data-i18n="join.afterTimeout"></label> <input id="node-input-timeout" data-i18n="[placeholder]join.seconds" type="text" style="width:75px;">
                </li>
                <li>
                    <label style="width:auto; padding-top:6px;" data-i18n="[html]join.complete"></label>
                </li>
            </ul>
        </div>
    </div>
    <div class="node-row-reduce">
        <div class="form-row">
            <label for="node-input-reduceExp" data-i18n="join.reduce.exp" style="margin-left:10px;"></label>
            <input type="text" id="node-input-reduceExp" data-i18n="[placeholder]join.reduce.exp-value" style="width:65%">
        </div>
        <div class="form-row">
            <label for="node-input-reduceInit" data-i18n="join.reduce.init" style="margin-left:10px;"></label>
            <input type="text" id="node-input-reduceInit" data-i18n="[placeholder]join.reduce.init" style="width:65%">
            <input type="hidden" id="node-input-reduceInitType">
        </div>
        <div class="form-row">
            <label for="node-input-reduceFixup" data-i18n="join.reduce.fixup" style="margin-left:10px;"></label>
            <input type="text" id="node-input-reduceFixup" data-i18n="[placeholder]join.reduce.exp-value" style="width:65%">
        </div>
        <div class="form-row">
            <label>&nbsp;</label>
            <input type="checkbox" id="node-input-reduceRight" style="display:inline-block; width:auto; vertical-align:top; margin-left:10px;">
            <label for="node-input-reduceRight" style="width:70%;" data-i18n="join.reduce.right" style="margin-left:10px;"></label>
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-tips form-tips-auto hide" data-i18n="[html]join.tip"></div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('join',{
        category: 'function',
        color:"#E2D96E",
        defaults: {
            name: {value:""},
            mode: {value:"auto"},
            build: { value:"string"},
            property: { value:"payload", validate:RED.validators.typedInput("propertyType")},
            propertyType: { value:"msg"},
            key: {value:"topic"},
            joiner: { value:"\\n"},
            joinerType: { value:"str"},
            accumulate: { value:"false" },
            timeout: {value:""},
            count: {value:""},
            reduceRight: {value:false},
            reduceExp: {value:undefined},
            reduceInit: {value:undefined},
            reduceInitType: {value:undefined},
            reduceFixup: {value:undefined}
        },
        inputs:1,
        outputs:1,
        icon: "join.png",
        label: function() {
            return this.name||this._("join.join");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var node = this;

            $("#node-input-mode").change(function(e) {
                var val = $(this).val();
                $(".node-row-custom").toggle(val==='custom');
                $(".node-row-reduce").toggle(val==='reduce');
                $(".form-tips-auto").toggle((val==='auto') || (val==='reduce'));
                if (val === "auto") {
                    $("#node-input-accumulate").attr('checked', false);
                }
                else if (val === "custom") {
                    $("#node-input-build").change();
                }
                else if (val === "reduce") {
                    var jsonata_or_empty = {
                        value: "jsonata",
                        label: "expression",
                        icon: "red/images/typedInput/expr.png",
                        validate: function(v) {
                            try{
                                if(v !== "") {
                                    jsonata(v);
                                }
                                return true;
                            }
                            catch(e){
                                return false;
                            }
                        },
                        expand:function() {
                            var that = this;
                            RED.editor.editExpression({
                                value: this.value().replace(/\t/g,"\n"),
                                complete: function(v) {
                                    that.value(v.replace(/\n/g,"\t"));
                                }
                            })
                        }
                    };
                    $("#node-input-reduceExp").typedInput({types:[jsonata_or_empty]});
                    $("#node-input-reduceInit").typedInput({
                        default: 'num',
                        types:['flow','global','str','num','bool','json','bin','date','jsonata','env'],
                        typeField: $("#node-input-reduceInitType")
                    });
                    $("#node-input-reduceFixup").typedInput({types:[jsonata_or_empty]});
                }
            });

            $("#node-input-build").change(function(e) {
                var val = $(this).val();
                $(".node-row-key").toggle(val==='object');
                $(".node-row-accumulate").toggle(val==='object' || val==='merged');
                $(".node-row-joiner").toggle(val==='string' || val==='buffer');
                $(".node-row-trigger").toggle(val!=='auto');
                if (val === 'string' || val==='buffer') {
                    $("#node-input-property").typedInput('types',['msg']);
                    $("#node-input-joiner").typedInput("show");
                } else {
                    $("#node-input-property").typedInput('types',['msg', {value:"full",label:"complete message",hasValue:false}]);
                }
            });

            $("#node-input-joiner").typedInput({
                default: 'str',
                typeField: $("#node-input-joinerType"),
                types:['str', 'bin']
            });

            $("#node-input-property").typedInput({
                typeField: $("#node-input-propertyType"),
                types:['msg', {value:"full", label:"complete message", hasValue:false}]
            });

            $("#node-input-key").typedInput({
                types:['msg']
            });

            $("#node-input-build").change();
            $("#node-input-mode").change();
        },
        oneditsave: function() {
            var build = $("#node-input-build").val();
            if (build !== 'object' && build !== 'merged') {
                $("#node-input-accumulate").prop("checked",false);
            }
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="split">
    <p>Splits a message into a sequence of messages.</p>

    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | string | array | buffer</span></dt>
        <dd>The behaviour of the node is determined by the type of <code>msg.payload</code>:
            <ul>
                <li><b>string</b>/<b>buffer</b> - the message is split using the specified character (default: <code>\n</code>), buffer sequence or into fixed lengths.</li>
                <li><b>array</b> - the message is split into either individual array elements, or arrays of a fixed-length.</li>
                <li><b>object</b> - a message is sent for each key/value pair of the object.</li>
            </ul>
        </dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>parts<span class="property-type">object</span></dt>
        <dd>This property contains information about how the message was split from
        the original message. If passed to the <b>join</b> node, the sequence can be
        reassembled into a single message. The property has the following properties:
        <ul>
            <li><code>id</code> - an identifier for the group of messages</li>
            <li><code>index</code> - the position within the group</li>
            <li><code>count</code> - if known, the total number of messages in the group. See 'streaming mode' below.</li>
            <li><code>type</code> - the type of message - string/array/object/buffer</li>
            <li><code>ch</code> - for a string or buffer, the data used to the split the message as either the string or an array of bytes</li>
            <li><code>key</code> - for an object, the key of the property this message was created from. The node can be configured to also copy this value to another message properties, such as <code>msg.topic</code>.</li>
            <li><code>len</code> - the length of each message when split using a fixed length value</li>
        </ul>
        </dd>
    </dl>
    <h3>Details</h3>
    <p>This node makes it easy to create a flow that performs common actions across
    a sequence of messages before, using the <b>join</b> node, recombining the
    sequence into a single message.</p>
    <p>It uses the <code>msg.parts</code> property to track the individual parts
    of a sequence.</p>
    <h4>Streaming mode</h4>
    <p>The node can also be used to reflow a stream of messages. For example, a
    serial device that sends newline-terminated commands may deliver a single message
    with a partial command at its end. In 'streaming mode', this node will split
    a message and send each complete segment. If there is a partial segment at the end,
    the node will hold on to it and prepend it to the next message that is received.
    </p>
    <p>When operating in this mode, the node will not set the <code>msg.parts.count</code>
    property as it does not know how many messages to expect in the stream. This
    means it cannot be used with the <b>join</b> node in its automatic mode</p>
</script>

<script type="text/x-red" data-help-name="join">
    <p>Joins sequences of messages into a single message.</p>
    <p>There are three modes available:</p>
    <dl>
        <dt>automatic</dt>
        <dd>When paired with the <b>split</b> node, it will automatically join the messages to reverse the split that was performed.</dd>
        <dt>manual</dt>
        <dd>Join sequences of messages in a variety of ways.</dd>
        <dt>reduce sequence</dt>
        <dd>Apply an expression against all messages in a sequence to reduce it to a single message.</dd>
    </dl>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt class="optional">parts<span class="property-type">object</span></dt>
        <dd>To automatically join a sequence of messages, they should all have
        this property set. The <b>split</b> node generates this property but it
        can be manually created. It has the following properties:
        <ul>
            <li><code>id</code> - an identifier for the group of messages</li>
            <li><code>index</code> - the position within the group</li>
            <li><code>count</code> - the total number of messages in the group</li>
            <li><code>type</code> - the type of message - string/array/object/buffer</li>
            <li><code>ch</code> - for a string or buffer, the data used to the split the message as either the string or an array of bytes</li>
            <li><code>key</code> - for an object, the key of the property this message was created from</li>
            <li><code>len</code> - the length of each message when split using a fixed length value</li>
        </ul>
        </dd>
        <dt class="optional">complete</dt>
        <dd>If set, the node will send its output message in its current state.</dd>
    </dl>
    <h3>Details</h3>

    <h4>Automatic mode</h4>
    <p>Automatic mode uses the <code>parts</code> property of incoming messages to
       determine how the sequence should be joined. This allows it to automatically
       reverse the action of a <b>split</b> node.

    <h4>Manual mode</h4>
    <p>When configured to join in manual mode, the node is able to join sequences
     of messages into a number of different results:</p>
    <ul>
        <li>a <b>string</b> or <b>buffer</b> - created by joining the selected property of each message with the specified join characters or buffer.</li>
        <li>an <b>array</b> - created by adding each selected property, or entire message, to the output array.</li>
        <li>a <b>key/value object</b> - created by using a property of each message to determine the key under which
        the required value is stored.</li>
        <li>a <b>merged object</b> - created by merging the property of each message under a single object.</li>
    </ul>
    <p>The other properties of the output message are taken from the last message received before the result is sent.</p>
    <p>A <i>count</i> can be set for how many messages should be received before generating the output message.
    For object outputs, once this count has been reached, the node can be configured to send a message for each subsequent message
    received.</p>
    <p>A <i>timeout</i> can be set to trigger sending the new message using whatever has been received so far.</p>
    <p>If a message is received with the <b>msg.complete</b> property set, the output message is finalised and sent.
    This resets any part counts.</p>
    <p>If a message is received with the <b>msg.reset</b> property set, the partly complete message is deleted and not sent.
    This resets any part counts.</p>

    <h4>Reduce Sequence mode</h4>
    <p>When configured to join in reduce mode, an expression is applied to each
       message in a sequence and the result accumulated to produce a single message.</p>

    <dl class="message-properties">
        <dt>Initial value</dt>
        <dd>The initial value of the accumulated value (<code>$A</code>).</dd>
        <dt>Reduce expression</dt>
        <dd>A JSONata expression that is called for each message in the sequence.
            The result is passed to the next call of the expression as the accumulated value.
            In the expression, the following special variables can be used:
            <ul>
                <li><code>$A</code>: the accumulated value, </li>
                <li><code>$I</code>: index of the message in the sequence, </li>
                <li><code>$N</code>: number of messages in the sequence.</li>
            </ul>
        </dd>
        <dt>Fix-up expression</dt>
        <dd>An optional JSONata expression that is applied after the reduce expression
            has been applied to all messages in the sequence.
            In the expression, following special variables can be used:
            <ul>
                <li><code>$A</code>: the accumulated value, </li>
                <li><code>$N</code>: number of messages in the sequence.</li>
            </ul>
        </dd>
        <p>By default, the reduce expression is applied in order, from the first
           to the last message of the sequence. It can optionally be applied in
           reverse order.</p>
    </dl>
    <p><b>Example:</b> the following settings, given a sequence of numeric values,
       calculates the average value:
        <ul>
            <li><b>Reduce expression</b>: <code>$A+payload</code></li>
            <li><b>Initial value</b>: <code>0</code></li>
            <li><b>Fix-up expression</b>: <code>$A/$N</code></li>
        </ul>
    </p>
    <h4>Storing messages</h4>
    <p>This node will buffer messages internally in order to work across sequences. The
       runtime setting <code>nodeMessageBufferMaxLength</code> can be used to limit how many messages nodes
       will buffer.</p>
</script>

</div><div><!-- --- [red-module:node-red/sort] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="sort">

    <div class="form-row">
        <label for="node-input-target"><i class="fa fa-dot-circle-o"></i> <span data-i18n="sort.target"></span></label>
        <input type="text" id="node-input-target" style="width:70%;">
        <input type="hidden" id="node-input-targetType">
    </div>

    <div class="node-row-sort-msg-key">
        <div class="form-row">
            <label for="node-input-msgKey"><i class="fa fa-filter"></i> <span data-i18n="sort.key"></span></label>
            <input type="text" id="node-input-msgKey" style="width:70%;">
            <input type="hidden" id="node-input-msgKeyType">
        </div>
    </div>

    <div class="node-row-sort-seq-key">
        <div class="form-row">
            <label for="node-input-seqKey"><i class="fa fa-filter"></i> <span data-i18n="sort.key"></span></label>
            <input type="text" id="node-input-seqKey" style="width:70%;">
            <input type="hidden" id="node-input-seqKeyType">
        </div>
    </div>

    <div class="form-row">
        <label><i class="fa fa-random"></i>  <span data-i18n="sort.order"></span></label>
        <select id="node-input-order" style="width:200px;">
            <option value="ascending" data-i18n="sort.ascending"></option>
            <option value="descending" data-i18n="sort.descending"></option>
        </select>
    </div>

    <div class="form-row" id="node-as_num">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-as_num" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-as_num" style="width: 70%;" data-i18n="sort.as-number"></label>
    </div>

    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('sort',{
        category: 'function',
        color:"#E2D96E",
        defaults: {
            name: { value:"" },
            order: { value:"ascending" },
            as_num: { value:false },
            target: { value:"payload" },
            targetType: { value:"msg" },
            msgKey: { value:"payload" },
            msgKeyType: { value:"elem" },
            seqKey: { value:"payload" },
            seqKeyType: { value:"msg" }
        },
        inputs:1,
        outputs:1,
        icon: "sort.png",
        label: function() {
            return this.name||this._("sort.sort");
        },
        labelStyle: function() {
            return this.name ? "node_label_italic" : "";
        },
        oneditprepare: function() {
            var seq = {
                value: "seq",
                label: RED._("node-red:sort.seq"),
                hasValue: false
            };
            var elem = {
                value: "elem",
                label: RED._("node-red:sort.elem"),
                hasValue: false
            };
            $("#node-input-target").typedInput({
                default:'msg',
                typeField: $("#node-input-targetType"),
                types:['msg', seq]
            });
            $("#node-input-msgKey").typedInput({
                default:'elem',
                typeField: $("#node-input-msgKeyType"),
                types:[elem, 'jsonata']
            });
            $("#node-input-seqKey").typedInput({
                default:'msg',
                typeField: $("#node-input-seqKeyType"),
                types:['msg', 'jsonata']
            });
            $("#node-input-target").change(function(e) {
                var val = $("#node-input-target").typedInput('type');
                $(".node-row-sort-msg-key").toggle(val === "msg");
                $(".node-row-sort-seq-key").toggle(val === "seq");
            });
            $("#node-input-target").change();
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="sort">
    <p>A function that sorts message property or a sequence of messages.</p>
    <p>When configured to sort message property, the node sorts array data pointed to by specified message property.</p>
    <p>When configured to sort a sequence of messages, it will reorder the messages.</p>
    <p>The sorting order can be:</p>
    <ul>
        <li><b>ascending</b>,</li>
        <li><b>descending</b>.</li>
    </ul>
    <p>For numbers, numerical ordering can be specified by a checkbox.</p>
    <p>Sort key can be element value or JSONata expression for sorting property value, or message property or JSONata expression for sorting a message sequence.<p>
    <p>When sorting a message sequence, the sort node relies on the received messages to have <code>msg.parts</code> set.  The split node generates this property, but can be manually created.  It has the following properties:</p>
    <p>
        <ul>
            <li><code>id</code> - an identifier for the group of messages</li>
            <li><code>index</code> - the position within the group</li>
            <li><code>count</code> - the total number of messages in the group</li>
        </ul>
    </p>
    <p><b>Note:</b> This node internally keeps messages for its operation.  In order to prevent unexpected memory usage, maximum number of messages kept can be specified.  Default is no limit on number of messages.
        <ul>
            <li><code>nodeMessageBufferMaxLength</code> property set in <b>settings.js</b>.</li>
        </ul>
    </p>
</script>

</div><div><!-- --- [red-module:node-red/batch] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="batch">
    <div class="form-row">
        <label for="node-input-mode"><span data-i18n="batch.mode.label"></span></label>
        <select type="text" id="node-input-mode" style="width: 300px;">
            <option value="count" data-i18n="batch.mode.num-msgs"></option>
            <option value="interval" data-i18n="batch.mode.interval"></option>
            <option value="concat" data-i18n="batch.mode.concat"></option>
        </select>
    </div>

    <div class="node-row-msg-count">
        <div class="form-row node-row-count">
            <label style="margin-left: 10px; width: 175px;" for="node-input-count" data-i18n="batch.count.label"></label>
            <input type="text" id="node-input-count" style="width: 50px;">
        </div>
    </div>

    <div class="node-row-msg-overlap">
        <div class="form-row node-row-overlap">
            <label style="margin-left: 10px; width: 175px;" for="node-input-overlap" data-i18n="batch.count.overlap"></label>
            <input type="text" id="node-input-overlap" style="width: 50px;">
        </div>
    </div>

    <div class="node-row-msg-interval">
        <div class="form-row node-row-interval">
            <label style="margin-left: 10px; width: 175px;" for="node-input-interval"> <span data-i18n="batch.interval.label"></span></label>
            <input type="text" id="node-input-interval" style="width: 50px;">
            <span data-i18n="batch.interval.seconds"></span>
        </div>
        <div class="form-row">
            <input type="checkbox" id="node-input-allowEmptySequence" style="margin-left:20px; margin-right: 10px; vertical-align:top; width:auto;">
            <label for="node-input-allowEmptySequence" style="width:auto;" data-i18n="batch.interval.empty"></label>
	</div>
    </div>

    <div class="node-row-msg-concat">
        <div class="form-row">
            <label data-i18n="batch.concat.topics-label"></label>
            <div class="form-row node-input-topics-container-row">
                <ol id="node-input-topics-container"></ol>
            </div>
        </div>
    </div>

    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name">
    </div>

</script>

<script type="text/javascript">
    RED.nodes.registerType("batch",{
        category: "function",
        color:"#E2D96E",
        defaults: {
            name: {value:""},
            mode: {value:"count"},
            count: {value:10,validate:function(v) { return RED.validators.number(v) && (v >= 1); }},
            overlap: {value:0,validate:function(v) { return RED.validators.number(v) && (v >= 0); }},
            interval: {value:10,validate:function(v) { return RED.validators.number(v) && (v >= 1); }},
            allowEmptySequence: {value:false},
            topics: {value:[{topic:""}]}
        },
        inputs:1,
        outputs:1,
        icon: "batch.png",
        label: function() {
            return this.name||this._("batch.batch");;
        },
        labelStyle: function() {
            return this.name ? "node_label_italic" : "";
        },
        oneditprepare: function() {
            var node = this;
            var topic_str = node._("batch.concat.topic");

            function resizeTopics(topic) {
                var newWidth = topic.width();
                topic.find('.red-ui-typedInput')
                     .typedInput("width",newWidth-15);
            }

            $("#node-input-topics-container")
                .css('min-height','200px').css('min-width','430px')
                .editableList({
                    addItem: function(container, i, opt) {
                        if (!opt.hasOwnProperty('topic')) {
                            opt.topic = "";
                        }
                        var row = $('<div></div>').appendTo(container);
                        var valueField = $('<input/>',{
                            class:"node-input-topic-value",
                            type:"text",
                            style:"margin-left: 5px;"
                        }).appendTo(row)
                        .typedInput({default:'str', types:['str']});
                        valueField.typedInput('value', opt.topic);
                        valueField.typedInput('type', 'str');
                        valueField.attr('placeholder', topic_str);
                        resizeTopics(container);
                    },
                    resizeItem: resizeTopics,
                    sortable: true,
                    removable: true
                });

            $("#node-input-count").spinner({min:1});
            $("#node-input-overlap").spinner({min:0});
            $("#node-input-interval").spinner({min:1});
            $("#node-input-mode").change(function(e) {
                var val = $(this).val();
                $(".node-row-msg-count").toggle(val==="count");
                $(".node-row-msg-overlap").toggle(val==="count");
                $(".node-row-msg-interval").toggle(val==="interval");
                $(".node-row-msg-concat").toggle(val==="concat");
                if (val==="concat") {
                    var topics = node.topics;
                    var container = $("#node-input-topics-container");
                    container.editableList('empty');
                    for (var i = 0; i < topics.length; i++) {
                        var topic = topics[i];
                        container.editableList('addItem', topic);
                    }
                }
            });
        },
        oneditsave: function() {
            var topics = $("#node-input-topics-container").editableList('items');
            var node = this;
            node.topics = [];
            topics.each(function(i) {
                var topicData = $(this).data('data');
                var topic = $(this);
                var vf = topic.find(".node-input-topic-value");
                var value = vf.typedInput('value');
                var type = vf.typedInput('type');
                var r = {topic:value};
                node.topics.push(r);
            });
        },
        oneditresize: function(size) {
            var rows = $("#dialog-form>div:not(.node-input-topics-container-row)");
            var height = size.height;
            for (var i = 0; i < rows.size(); i++) {
                height -= $(rows[i]).outerHeight(true);
            }
            var editorRow = $("#dialog-form>div.node-input-topics-container-row");
            height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));
            $("#node-input-topics-container").editableList('height',height);
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="batch">
    <p>Creates sequences of messages based on various rules.</p>
    <h3>Details</h3>
    <p>There are three modes for creating message sequences:</p>
    <dl>
        <dt>Number of messages</dt>
        <dd>groups messages into sequences of a given length. The <b>overlap</b>
        option specifies how many messages at the end of one sequence should be
        repeated at the start of the next sequence.</dd>

        <dt>Time interval</dt>
        <dd>groups messages that arrive within the specified interval. If no messages
            arrive within the interval, the node can optionally send on an empty message.</dd>

        <dt>Concatenate Sequences</dt>
        <dd>creates a message sequence by concatenating incoming sequences. Each message
            must have a <code>msg.topic</code> property and a <code>msg.parts</code> property
            identifying its sequence. The node is configured with a list of <code>topic</code>
            values to identify the order sequences are concatenated.
        </dd>
    </dl>
    <h4>Storing messages</h4>
    <p>This node will buffer messages internally in order to work across sequences. The
       runtime setting <code>nodeMessageBufferMaxLength</code> can be used to limit how many messages nodes
       will buffer.</p>
</script>

</div><div><!-- --- [red-module:node-red/CSV] --- -->

<script type="text/x-red" data-template-name="csv">
    <div class="form-row">
        <label for="node-input-temp"><i class="fa fa-list"></i> <span data-i18n="csv.label.columns"></span></label>
        <input type="text" id="node-input-temp" data-i18n="[placeholder]csv.placeholder.columns">
    </div>
    <div class="form-row">
        <label for="node-input-select-sep"><i class="fa fa-text-width"></i> <span data-i18n="csv.label.separator"></span></label>
            <select style="width:150px" id="node-input-select-sep">
                <option value="," data-i18n="csv.separator.comma"></option>
                <option value="\t" data-i18n="csv.separator.tab"></option>
                <option value=" " data-i18n="csv.separator.space"></option>
                <option value=";" data-i18n="csv.separator.semicolon"></option>
                <option value=":" data-i18n="csv.separator.colon"></option>
                <option value="#" data-i18n="csv.separator.hashtag"></option>
                <option value="" data-i18n="csv.separator.other"></option>
           </select>
           <input style="width:40px;" type="text" id="node-input-sep" pattern=".">
    </div>

    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <hr align="middle"/>
    <div class="form-row">
        <label style="width:100%; border-bottom:1px solid #eee;"><span data-i18n="csv.label.c2o"></span></label>
    </div>
    <div class="form-row" style="padding-left:20px;">
        <label><i class="fa fa-sign-in"></i> <span data-i18n="csv.label.input"></span></label>
        <span data-i18n="csv.label.skip-s"></span>&nbsp;<input type="text" id="node-input-skip" style="width:30px; height:25px;"/>&nbsp;<span data-i18n="csv.label.skip-e"></span><br/>
        <label>&nbsp;</label>
        <input style="width:20px; vertical-align:baseline; margin-right:5px;" type="checkbox" id="node-input-hdrin"><label style="width:auto; margin-top:7px;" for="node-input-hdrin"><span data-i18n="csv.label.firstrow"></span>
    </div>
    <div class="form-row" style="padding-left:20px;">
        <label><i class="fa fa-sign-out"></i> <span data-i18n="csv.label.output"></span></label>
        <select type="text" id="node-input-multi" style="width:250px;">
            <option value="one" data-i18n="csv.output.row"></option>
            <option value="mult" data-i18n="csv.output.array"></option>
        </select>
    </div>
    <div class="form-row" style="margin-top:20px">
        <label style="width:100%; border-bottom:1px solid #eee;"><span data-i18n="csv.label.o2c"></span></label>
    </div>
    <div class="form-row" style="padding-left:20px;">
        <label><i class="fa fa-sign-in"></i> <span data-i18n="csv.label.output"></span></label>
        <input style="width:20px; vertical-align:top; margin-right:5px;" type="checkbox" id="node-input-hdrout"><label style="width:auto;" for="node-input-hdrout"><span data-i18n="csv.label.includerow"></span></span>
    </div>
    <div class="form-row" style="padding-left:20px;">
        <label></label>
        <label style="width:auto; margin-right:10px;" for="node-input-ret"><span data-i18n="csv.label.newline"></span></label>
        <select style="width:150px;" id="node-input-ret">
            <option value='\n' data-i18n="csv.newline.linux"></option>
            <option value='\r' data-i18n="csv.newline.mac"></option>
            <option value='\r\n' data-i18n="csv.newline.windows"></option>
       </select>
    </div>
</script>


<script type="text/javascript">
    RED.nodes.registerType('csv',{
        category: 'function',
        color:"#DEBD5C",
        defaults: {
            name: {value:""},
            sep: {value:',',required:true,validate:RED.validators.regex(/^.{1,2}$/)},
            //quo: {value:'"',required:true},
            hdrin: {value:""},
            hdrout: {value:""},
            multi: {value:"one",required:true},
            ret: {value:'\\n'},
            temp: {value:""},
            skip: {value:"0"}
        },
        inputs:1,
        outputs:1,
        icon: "parser-csv.png",
        label: function() {
            return this.name||"csv";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            console.log(this.skip,$("#node-input-skip").val());
            if (this.skip === undefined) { this.skip = 0; $("#node-input-skip").val("0");}
            $("#node-input-skip").spinner({ min:0 });
            if (this.sep == "," || this.sep == "\\t" || this.sep == ";" || this.sep == ":" || this.sep == " " || this.sep == "#") {
                $("#node-input-select-sep").val(this.sep);
                $("#node-input-sep").hide();
            } else {
                $("#node-input-select-sep").val("");
                $("#node-input-sep").val(this.sep);
                $("#node-input-sep").show();
            }
            $("#node-input-select-sep").change(function() {
                var v = $("#node-input-select-sep").val();
                $("#node-input-sep").val(v);
                if (v == "") {
                    $("#node-input-sep").val("");
                    $("#node-input-sep").show().focus();
                } else {
                    $("#node-input-sep").hide();
                }
            });
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="csv">
    <p>Converts between a CSV formatted string and its JavaScript object representation, in either direction.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | array | string</span></dt>
        <dd>A JavaScript object, array or CSV string.</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | array | string</span></dt>
        <dd>
        <ul>
            <li>If the input is a string it tries to parse it as CSV and creates a JavaScript object of key/value pairs for each line.
                The node will then either send a message for each line, or a single message containing an array of objects.</li>
            <li>If the input is a JavaScript object it tries to build a CSV string.</li>
            <li>If the input is an array of simple values, it builds a single line CSV string.</li>
            <li>If the input is an array of arrays, or an array of objects, a multiple-line CSV string is created.</li>
        </ul>
        </dd>
    </dl>
    <h3>Details</h3>
    <p>The column template can contain an ordered list of column names. When converting CSV to an object, the column names
    will be used as the property names. Alternatively, the column names can be taken from the first row of the CSV.</p>
    <p>When converting to CSV, the column template is used to identify which properties to extract from the object and in what order.</p>
    <p>If the input is an array then the columns template is only used to optionally generate a row of column titles.</p>
    <p>The node can accept a multi-part input as long as the <code>parts</code> property is set correctly.</p>
    <p>If outputting multiple messages they will have their <code>parts</code> property set and form a complete message sequence.</p>
    <p><b>Note:</b> the column template must be comma separated - even if a different separator is chosen for the data.</p>
</script>

</div><div><!-- --- [red-module:node-red/HTML] --- -->

<script type="text/x-red" data-template-name="html">
    <div class="form-row">
        <label for="node-input-property"><i class="fa fa-ellipsis-h"></i> <span data-i18n="node-red:common.label.property"></span></label>
        <input type="text" id="node-input-property" style="width:70%">
    </div>
    <div class="form-row">
        <label for="node-input-tag"><i class="fa fa-filter"></i> <span data-i18n="html.label.select"></span></label>
        <input type="text" id="node-input-tag" placeholder="h1">
    </div>
    <div class="form-row">
        <label for="node-input-ret"><i class="fa fa-sign-out"></i> <span data-i18n="html.label.output"></span></label>
        <select id="node-input-ret" style="width:70%">
            <option value="html" data-i18n="html.output.html"></option>
            <option value="text" data-i18n="html.output.text"></option>
            <option value="attr" data-i18n="html.output.attr"></option>
            <!-- <option value="val">return the value from a form element</option> -->
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-as">&nbsp;</label>
        <select id="node-input-as" style="width:70%">
            <option value="single" data-i18n="html.format.single"></option>
            <option value="multi" data-i18n="html.format.multi"></option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-outproperty">&nbsp;</label>
        <span data-i18n="html.label.in" style="padding-left:8px; padding-right:2px; vertical-align:-1px;"></span> <input type="text" id="node-input-outproperty" style="width:64%">
    </div>
    <br/>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" style="width:70%" data-i18n="[placeholder]common.label.name">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('html',{
        category: 'function',
        color:"#DEBD5C",
        defaults: {
            name: {value:""},
            property: {value:"payload"},
            outproperty: {value:"payload"},
            tag: {value:""},
            ret: {value:"html"},
            as: {value:"single"}
        },
        inputs:1,
        outputs:1,
        icon: "parser-html.png",
        label: function() {
            return this.name||this.tag||"html";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            $("#node-input-property").typedInput({default:'msg',types:['msg']});
            $("#node-input-outproperty").typedInput({default:'msg',types:['msg']});
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="html">
    <p>Extracts elements from an html document held in <code>msg.payload</code> using a CSS selector.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
    <dt>payload <span class="property-type">string</span></dt>
    <dd>the html string from which to extract elements.</dd>
    <dt class="optional">select <span class="property-type">string</span></dt>
    <dd>if not configured in the edit panel the selector can be set as a property of msg.</dd>
</dl>
    <h3>Output</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">array | string</span></dt>
        <dd>the result can be either a single message with a payload containing an array of the matched elements, or multiple
           messages that each contain a matched element. If multiple messages are sent they will also have <code>parts</code> set.</dd>
    </dl>
    <h3>Details</h3>
    <p>This node supports a combination of CSS and jQuery selectors. See the
    <a href="https://github.com/fb55/CSSselect#user-content-supported-selectors" target="_blank">css-select documentation</a> for more information
    on the supported syntax.</p>
</script>

</div><div><!-- --- [red-module:node-red/JSON] --- -->

<script type="text/x-red" data-template-name="json">
    <div class="form-row">
        <label for="node-input-action"><i class="fa fa-dot-circle-o"></i> <span data-i18n="json.label.action"></span></label>
        <select style="width:70%" id="node-input-action">
            <option value=""    data-i18n="json.label.actions.toggle"></option>
            <option value="str" data-i18n="json.label.actions.str"></option>
            <option value="obj" data-i18n="json.label.actions.obj"></option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-property"><i class="fa fa-ellipsis-h"></i> <span data-i18n="json.label.property"></span></label>
        <input type="text" id="node-input-property" style="width:70%;"/>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <hr align="middle"/>
    <div class="form-row node-json-to-json-options">
        <label style="width:100%; border-bottom: 1px solid #eee;"><span data-i18n="json.label.o2j"></span></label>
    </div>
    <div class="form-row node-json-to-json-options" style="padding-left: 20px;">
        <input style="width:20px; vertical-align:top; margin-right: 5px;" type="checkbox" id="node-input-pretty"><label style="width: auto;" for="node-input-pretty" data-i18n="json.label.pretty"></span>
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('json',{
        category: 'function',
        color:"#DEBD5C",
        defaults: {
            name: {value:""},
            property: {value:"payload",required:true},
            action: {value:""},
            pretty: {value:false}
        },
        inputs:1,
        outputs:1,
        icon: "parser-json.png",
        label: function() {
            return this.name||"json";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (this.property === undefined) {
                $("#node-input-property").val("payload");
            }
            $("#node-input-property").typedInput({default:'msg',types:['msg']});
            $("#node-input-action").change(function() {
                if (this.value === "" || this.value === "str") {
                    $(".node-json-to-json-options").show();
                } else {
                    $(".node-json-to-json-options").hide();
                }
            });
            $("#node-input-action").change();
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="json">
    <p>Converts between a JSON string and its JavaScript object representation, in either direction.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | string</span></dt>
        <dd>A JavaScript object or JSON string.</dd>
        <dt>schema<span class="property-type">object</span></dt>
        <dd>An optional JSON Schema object to validate the payload against.
        The property will be deleted before the <code>msg</code> is sent to the next node.</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | string</span></dt>
        <dd>
            <ul>
                <li>If the input is a JSON string it tries to parse it to a JavaScript object.</li>
                <li>If the input is a JavaScript object it creates a JSON string. The string can optionally be well-formatted.</li>
            </ul>
        </dd>
        <dt>schemaError<span class="property-type">array</span></dt>
        <dd>If JSON schema validation fails, the catch node will have a <code>schemaError</code> property
            containing an array of errors.</dd>
    </dl>
    <h3>Details</h3>
    <p>By default, the node operates on <code>msg.payload</code>, but can be configured
       to convert any message property.</p>
    <p>The node can also be configured to ensure a particular encoding instead of toggling
       between the two. This can be used, for example, with the <code>HTTP In</code>
       node to ensure the payload is a parsed object even if an incoming request
       did not set its content-type correctly for the HTTP In node to do the conversion.</p>
    <p>If the node is configured to ensure the property is encoded as a String and it
       receives a String, no further checks will be made of the property. It will
       not check the String is valid JSON nor will it reformat it if the format option
       is selected.</p>
    <p>For more details about JSON Schema you can consult the specification
    <a href="http://json-schema.org/latest/json-schema-validation.html">here</a>.</p>
</script>

</div><div><!-- --- [red-module:node-red/XML] --- -->

<script type="text/x-red" data-template-name="xml">
    <div class="form-row">
        <label for="node-input-property"><i class="fa fa-ellipsis-h"></i> <span data-i18n="node-red:common.label.property"></span></label>
        <input type="text" id="node-input-property" style="width:70%;"/>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <hr align="middle"/>
    <div class="form-row">
        <label style="width:100%; border-bottom: 1px solid #eee;"><span data-i18n="xml.label.x2o"></span></label>
    </div>
    <div class="form-row" style="padding-left: 20px;">
        <label style="width:250px;" for="node-input-attr" data-i18n="xml.label.represent"></label> <input type="text" id="node-input-attr" style="text-align:center; width:40px" placeholder="$">
    </div>
    <div class="form-row" style="padding-left: 20px;">
        <label style="width:250px;" for="node-input-chr" data-i18n="xml.label.prefix"></label> <input type="text" id="node-input-chr" style="text-align:center; width:40px" placeholder="_">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('xml',{
        category: 'function',
        color:"#DEBD5C",
        defaults: {
            name: {value:""},
            property: {value:"payload",required:true},
            attr: {value:""},
            chr: {value:""}
        },
        inputs:1,
        outputs:1,
        icon: "parser-xml.png",
        label: function() {
            return this.name||"xml";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (this.property === undefined) {
                $("#node-input-property").val("payload");
            }
            $("#node-input-property").typedInput({default:'msg',types:['msg']});
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="xml">
    <p>Converts between an XML string and its JavaScript object representation, in either direction.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | string</span></dt>
        <dd>A JavaScript object or XML string.</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | string</span></dt>
        <dd>
            <ul>
                <li>If the input is a string it tries to parse it as XML and creates a JavaScript object.</li>
                <li>If the input is a JavaScript object it tries to build an XML string.</li>
            </ul>
        </dd>
        <dt class="optional">options <span class="property-type">object</span></dt>
        <dd>This optional property can be used to pass in any of the options supported by the underlying
            library used to convert to and from XML. See <a href="https://github.com/Leonidas-from-XIV/node-xml2js/blob/master/README.md#options" target="_blank">the xml2js docs</a>
            for more information.</dd>
    </dl>
    <h3>Details</h3>
    <p>When converting between XML and an object, any XML attributes are added as a property named <code>$</code> by default.
    Any text content is added as a property named <code>_</code>. These property names can be specified in the node configuration.</p>
    <p>For example, the following XML will be converted as shown:</p>
    <pre>&lt;p class="tag"&gt;Hello World&lt;/p&gt;</pre>
    <pre>{
  "p": {
    "$": {
      "class": "tag"
    },
    "_": "Hello World"
  }
}</pre>
</script>

</div><div><!-- --- [red-module:node-red/YAML] --- -->

<script type="text/x-red" data-template-name="yaml">
    <div class="form-row">
        <label for="node-input-property"><i class="fa fa-ellipsis-h"></i> <span data-i18n="node-red:common.label.property"></span></label>
        <input type="text" id="node-input-property" style="width:70%;"/>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('yaml',{
        category: 'function',
        color:"#DEBD5C",
        defaults: {
            property: {value:"payload",required:true},
            name: {value:""}
        },
        inputs:1,
        outputs:1,
        icon: "parser-yaml.png",
        label: function() {
            return this.name||"yaml";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (this.property === undefined) {
                $("#node-input-property").val("payload");
            }
            $("#node-input-property").typedInput({default:'msg',types:['msg']});
        }
    });
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="yaml">
    <p>Converts between a YAML formatted string and its JavaScript object representation, in either direction.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | string</span></dt>
        <dd>A JavaScript object or YAML string.</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | string</span></dt>
        <dd>
            <ul>
                <li>If the input is a YAML string it tries to parse it to a JavaScript object.</li>
                <li>If the input is a JavaScript object it creates a YAML string.</li>
            </ul>
        </dd>
    </dl>
</script>

</div><div><!-- --- [red-module:node-red/file] --- -->

<script type="text/x-red" data-template-name="file">
    <div class="form-row node-input-filename">
         <label for="node-input-filename"><i class="fa fa-file"></i> <span data-i18n="file.label.filename"></span></label>
         <input id="node-input-filename" type="text">
    </div>
    <div class="form-row">
        <label for="node-input-overwriteFile"><i class="fa fa-random"></i> <span data-i18n="file.label.action"></span></label>
        <select type="text" id="node-input-overwriteFile" style="width: 250px;">
            <option value="false" data-i18n="file.action.append"></option>
            <option value="true" data-i18n="file.action.overwrite"></option>
            <option value="delete" data-i18n="file.action.delete"></option>
        </select>
    </div>
    <div class="form-row form-row-file-write-options">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-appendNewline" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-appendNewline" style="width: 70%;"><span data-i18n="file.label.addnewline"></span></label>
    </div>
    <div class="form-row form-row-file-write-options">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-createDir" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-createDir" style="width: 70%;"><span data-i18n="file.label.createdir"></span></label>
    </div>
    <div class="form-row form-row-file-encoding">
        <label for="node-input-encoding"><i class="fa fa-flag"></i> <span data-i18n="file.label.encoding"></span></label>
        <select type="text" id="node-input-encoding" style="width: 250px;">
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-tips"><span data-i18n="file.tip"></span></div>
</script>

<script type="text/x-red" data-template-name="file in">
    <div class="form-row">
         <label for="node-input-filename"><i class="fa fa-file"></i> <span data-i18n="file.label.filename"></span></label>
         <input id="node-input-filename" type="text" data-i18n="[placeholder]file.label.filename">
    </div>
    <div class="form-row">
        <label for="node-input-format"><i class="fa fa-sign-out"></i> <span data-i18n="file.label.outputas"></span></label>
        <select id="node-input-format">
            <option value="utf8" data-i18n="file.output.utf8"></option>
            <option value="lines" data-i18n="file.output.lines"></option>
            <option value="" data-i18n="file.output.buffer"></option>
            <option value="stream" data-i18n="file.output.stream"></option>
        </select>
    </div>
    <div class="form-row">
        <label></label>
        <input type="checkbox" id="node-input-sendError" style="width:auto">
        <label style="width:auto; margin-bottom:0; vertical-align: middle;" for="node-input-sendError" data-i18n="file.label.sendError"></label>
    </div>
    <div class="form-row" id="encoding-spec">
        <label for="node-input-encoding"><i class="fa fa-flag"></i> <span data-i18n="file.label.encoding"></span></label>
        <select type="text" id="node-input-encoding" style="width: 250px;">
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-tips"><span data-i18n="file.tip"></span></div>
</script>

<script type="text/javascript">
(function(){
    var encodings = [
        [ "file.encoding.native",
          "utf8",
          "ucs2",
          "utf-16le",
          "ascii",
          "binary",
          "base64",
          "hex"
        ],
        [ "file.encoding.unicode",
          "utf-16be",
        ],
        [ "file.encoding.japanese",
          "Shift_JIS",
          "Windows-31j",
          "Windows932",
          "EUC-JP"
        ],
        [ "file.encoding.chinese",
          "GB2312",
          "GBK",
          "GB18030",
          "Windows936",
          "EUC-CN"
        ],
        [ "file.encoding.korean",
          "KS_C_5601",
          "Windows949",
          "EUC-KR"
        ],
        [ "file.encoding.taiwan",
          "Big5",
          "Big5-HKSCS",
          "Windows950"
        ],
        [ "file.encoding.windows",
          "cp874",
          "cp1250",
          "cp1251",
          "cp1252",
          "cp1253",
          "cp1254",
          "cp1255",
          "cp1256",
          "cp1257",
          "cp1258"
        ],
        [ "file.encoding.iso",
          "ISO-8859-1",
          "ISO-8859-2",
          "ISO-8859-3",
          "ISO-8859-4",
          "ISO-8859-5",
          "ISO-8859-6",
          "ISO-8859-7",
          "ISO-8859-8",
          "ISO-8859-9",
          "ISO-8859-10",
          "ISO-8859-11",
          "ISO-8859-12",
          "ISO-8859-13",
          "ISO-8859-14",
          "ISO-8859-15",
          "ISO-8859-16"
        ],
        [ "file.encoding.ibm",
          "cp437",
          "cp737",
          "cp775",
          "cp808",
          "cp850",
          "cp852",
          "cp855",
          "cp856",
          "cp857",
          "cp858",
          "cp860",
          "cp861",
          "cp866",
          "cp869",
          "cp922",
          "cp1046",
          "cp1124",
          "cp1125",
          "cp1129",
          "cp1133",
          "cp1161",
          "cp1162",
          "cp1163"
        ],
        [ "file.encoding.mac",
          "maccroatian",
          "maccyrillic",
          "macgreek",
          "maciceland",
          "macroman",
          "macromania",
          "macthai",
          "macturkish",
          "macukraine",
          "maccenteuro",
          "macintosh"
        ],
        [ "file.encoding.koi8",
          "koi8-r",
          "koi8-u",
          "koi8-ru",
          "koi8-t"
        ],
        [ "file.encoding.misc",
          "armscii8",
          "rk1048",
          "tcvn",
          "georgianacademy",
          "georgianps",
          "pt154",
          "viscii",
          "iso646cn",
          "iso646jp",
          "hproman8",
          "tis620"
        ]
    ];

    RED.nodes.registerType('file',{
        category: 'storage-output',
        defaults: {
            name: {value:""},
            filename: {value:""},
            appendNewline: {value:true},
            createDir: {value:false},
            overwriteFile: {value:"false"},
            encoding: {value:"none"}
        },
        color:"BurlyWood",
        inputs:1,
        outputs:1,
        icon: "file-out.png",
        label: function() {
            if (this.overwriteFile === "delete") {
                return this.name||this._("file.label.deletelabel",{file:this.filename});
            } else {
                return this.name||this.filename||this._("file.label.filelabel");
            }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var node = this;
            var encSel = $("#node-input-encoding");
            var label = node._("file.encoding.none");
            $("<option></option>", {
                value: "none",
                label: label
            }).text(label).appendTo(encSel);
            encodings.forEach(function(item) {
                if(Array.isArray(item)) {
                    var group = $("<optgroup></optgroup>", {
                        label: node._(item[0])
                    }).appendTo(encSel);
                    for (var i = 1; i < item.length; i++) {
                        var enc = item[i];
                        $("<option></option>", {
                            value: enc,
                            label: enc
                        }).text(enc).appendTo(group);
                    }
                }
                else {
                    $("<option></option>", {
                        value: item,
                        label: item
                    }).text(item).appendTo(encSel);
                }
            });
            encSel.val(node.encoding);
            $("#node-input-overwriteFile").on("change",function() {
                if (this.value === "delete") {
                    $(".form-row-file-write-options").hide();
                    $(".form-row-file-encoding").hide();
                } else {
                    $(".form-row-file-write-options").show();
                    $(".form-row-file-encoding").show();
                }
            });
        }
    });

    RED.nodes.registerType('file in',{
        category: 'storage-input',
        defaults: {
            name: {value:""},
            filename: {value:""},
            format: {value:"utf8"},
            chunk: {value:false},
            sendError: {value: false},
            encoding: {value: "none"}
        },
        color:"BurlyWood",
        inputs:1,
        outputs:1,
        outputLabels: function(i) {
            return (this._((this.format === "utf8") ? "file.label.utf8String" : "file.label.binaryBuffer"));
        },
        icon: "file-in.png",
        label: function() {
            return this.name||this.filename||this._("file.label.filelabel");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var node = this;
            var encSel = $("#node-input-encoding");
            var label = node._("file.encoding.none");
            $("<option></option>", {
                value: "none",
                label: label
            }).text(label).appendTo(encSel);
            encodings.forEach(function(item) {
                if(Array.isArray(item)) {
                    var group = $("<optgroup></optgroup>", {
                        label: node._(item[0])
                    }).appendTo(encSel);
                    for (var i = 1; i < item.length; i++) {
                        var enc = item[i];
                        $("<option></option>", {
                            value: enc,
                            label: enc
                        }).text(enc).appendTo(group);
                    }
                }
                else {
                    $("<option></option>", {
                        value: item,
                        label: item
                    }).text(item).appendTo(encSel);
                }
            });
            encSel.val(node.encoding);
            if (this.sendError === undefined) {
                $("#node-input-sendError").prop("checked",true);
            }
            $("#node-input-format").on("change",function() {
                var format = $("#node-input-format").val();
                if ((format === "utf8") || (format === "lines")) {
                    $("#encoding-spec").show();
                }
                else {
                    $("#encoding-spec").hide();
                }
            });
        }
    });
})();
</script>
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="file">
    <p>Writes <code>msg.payload</code> to a file, either adding to the end or replacing the existing content.
       Alternatively, it can delete the file.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt class="optional">filename <span class="property-type">string</span></dt>
        <dd>If not configured in the node, this optional property sets the name of the file to be updated.</dd>
    </dl>
    <h3>Output</h3>
    <p>On completion of write, input message is sent to output port.</p>
    <h3>Details</h3>
    <p>Each message payload will be added to the end of the file, optionally appending
    a newline (\n) character between each one.</p>
    <p>If <code>msg.filename</code> is used the file will be closed after every write.
    For best performance use a fixed filename.</p>
    <p>It can be configured to overwrite the entire file rather than append. For example,
    when writing binary data to a file, such as an image, this option should be used
    and the option to append a newline should be disabled.</p>
    <p>Encoding of data written to a file can be specified from list of encodings.</p>
    <p>Alternatively, this node can be configured to delete the file.</p>
</script>

<script type="text/x-red" data-help-name="file in">
    <p>Reads the contents of a file as either a string or binary buffer.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt class="optional">filename <span class="property-type">string</span></dt>
        <dd>if not set in the node configuration, this property sets the filename to read.</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">string | buffer</span></dt>
        <dd>The contents of the file as either a string or binary buffer.</dd>
        <dt class="optional">filename <span class="property-type">string</span></dt>
        <dd>If not configured in the node, this optional property sets the name of the file to be read.</dd>
        <dt class="optional">error <span class="property-type">object</span></dt>
        <dd><i>deprecated</i>: If enabled in the node, when the node hits an error
            reading the file, it will send a message with no <code>payload</code>
            and this <code>error</code> property set to the error details. This
            mode of behaviour is deprecated and not enabled by default for new
            instances of the node. See below for more information.</dd>
    </dl>
    <h3>Details</h3>
    <p>The filename should be an absolute path, otherwise it will be relative to
    the working directory of the Node-RED process.</p>
    <p>On Windows, path separators may need to be escaped, for example: <code>\\Users\\myUser</code>.</p>
    <p>Optionally, a text file can be split into lines, outputting one message per line, or a binary file
    split into smaller buffer chunks - the chunk size being operating system dependant, but typically 64k (Linux/Mac) or 41k (Windows).</p>
    <p>When split into multiple messages, each message will have a <code>parts</code>
    property set, forming a complete message sequence.</p>
    <p>Encoding of input data can be specified from list of encodings if output format is string.</p>
    <h4>Legacy error handling</h4>
    <p>Before Node-RED 0.17, if this node hit an error whilst reading the file, it would
    send a message with no <code>msg.payload</code> and <code>msg.error</code> set to the
    details of the error. This is a deprecated mode of behaviour for the node that new
    instances will not do. If required, this mode can be re-enabled within the node
    configuration.</p>
    <p>Errors should be caught and handled using a Catch node.</p>
</script>

</div><div><!-- --- [red-module:node-red-node-base64/base64] --- -->

<script type="text/x-red" data-template-name="base64">
    <div class="form-row">
        <label for="node-input-action"><i class="fa fa-dot-circle-o"></i> Action</label>
        <select style="width:70%" id="node-input-action">
            <option value="">Convert Buffer <-> Base64</option>
            <option value="str">Encode as Base64</option>
            <option value="b64">Convert Base64 to String</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-property"><i class="fa fa-ellipsis-h"></i> <span data-i18n="node-red:common.label.property"></span></label>
        <input type="text" id="node-input-property" style="width:70%;"/>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('base64',{
        category: 'function',
        color:"#DEBD5C",
        defaults: {
            name: {value:""},
            action: {value:""},
            property: {value:"payload",required:true}
        },
        inputs:1,
        outputs:1,
        icon: "parser-base64.png",
        label: function() {
            return this.name||"base64";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (this.property === undefined) {
                $("#node-input-property").val("payload");
            }
            $("#node-input-property").typedInput({default:'msg',types:['msg']});
        }
    });
</script>
<script type="text/x-red" data-help-name="base64">
    <p>A function that converts the chosen property (default <code>msg.payload</code>) to and from base64 format.</p>
    <p>If the input is a buffer it converts it to a Base64 encoded string.</p>
    <p>If the input is a Base64 string it converts it back to a binary buffer.</p>
    <p>You can also fix coding into base64, and base64 to buffer if required.</p>
    <p>Note: Using "Encode to Base64" will encode an already encoded string.</p>
</script>
</div><div><!-- --- [red-module:node-red-node-email/email] --- -->

<script type="text/x-red" data-template-name="e-mail">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-envelope"></i> <span data-i18n="email.label.to"></span></label>
        <input type="text" id="node-input-name" placeholder="email@address.com">
    </div>
    <!-- <div class="form-row">
        <label for="node-input-pin"><i class="fa fa-asterisk"></i> Service</label>
        <select type="text" id="node-input-pin" style="width: 150px;">
            <option value="-" disabled> </option>
            <option value="DynectEmail">DynectEmail</option>
            <option value="Gmail">Gmail</option>
            <option value="hot.ee">hot.ee</option>
            <option value="Hotmail">Hotmail</option>
            <option value="iCloud">iCloud</option>
            <option value="mail.ee">mail.ee</option>
            <option value="Mail.Ru">Mail.Ru</option>
            <option value="Mailgun">Mailgun</option>
            <option value="Mailjet">Mailjet</option>
            <option value="Mandrill">Mandrill</option>
            <option value="Postmark">Postmark</option>
            <option value="QQ">QQ</option>
            <option value="QQex">QQex</option>
            <option value="SendGrid">SendGrid</option>
            <option value="SendCloud">SendCloud</option>
            <option value="SES">SES</option>
            <option value="Yahoo">Yahoo</option>
            <option value="yandex">yandex</option>
            <option value="Zoho">Zoho</option>
         </select>
    </div> -->
    <div class="form-row">
        <label for="node-input-server"><i class="fa fa-globe"></i> <span data-i18n="email.label.server"></span></label>
        <input type="text" id="node-input-server" placeholder="smtp.gmail.com">
    </div>
    <div class="form-row">
        <label for="node-input-port"><i class="fa fa-random"></i> <span data-i18n="email.label.port"></span></label>
        <input type="text" id="node-input-port" placeholder="465" style="width:100px">
        <label style="width:40px"> </label>
        <input type="checkbox" id="node-input-secure" style="display:inline-block; width:20px; vertical-align:baseline;">
        <span data-i18n="email.label.useSecureConnection"></span>
    </div>
    <div class="form-row">
        <label for="node-input-userid"><i class="fa fa-user"></i> <span data-i18n="email.label.userid"></span></label>
        <input type="text" id="node-input-userid">
    </div>
    <div class="form-row">
        <label for="node-input-password"><i class="fa fa-lock"></i> <span data-i18n="email.label.password"></span></label>
        <input type="password" id="node-input-password">
    </div>
    <br/>
    <div class="form-row">
        <label for="node-input-useTLS"><i class="fa fa-lock"></i> <span data-i18n="email.label.useTLS"></label>
        <input type="checkbox" id="node-input-tls" style="display:inline-block; width:20px; vertical-align:baseline;">
    </div>
    <div class="form-row">
        <label for="node-input-dname"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-dname" data-i18n="[placeholder]node-red:common.label.name">
    </div>

    <div class="form-tips" id="node-tip"><span data-i18n="[html]email.tip.cred"></span></div>
</script>



<script type="text/javascript">
(function() {
    RED.nodes.registerType('e-mail',{
        category: 'social-output',
        color:"#c7e9c0",
        defaults: {
            server: {value:"smtp.gmail.com",required:true},
            port: {value:"465",required:true},
            secure: {value: true},
            tls: {value: true},
            name: {value:""},
            dname: {value:""}
        },
        credentials: {
            userid: {type:"text"},
            password: {type: "password"},
            global: { type:"boolean"}
        },
        inputs:1,
        outputs:0,
        icon: "envelope.png",
        align: "right",
        paletteLabel: function() {
            return this._("email.email");
        },
        label: function() {
            return this.dname||this.name||"email";
        },
        labelStyle: function() {
            return (this.dname)?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (this.credentials.global) {
                $('#node-tip').show();
            } else {
                $('#node-tip').hide();
            }
        }
    });
})();
</script>


<script type="text/x-red" data-template-name="e-mail in">
    <div class="form-row">
        <label for="node-input-fetch"><i class="fa fa-hourglass-half"></i> <span data-i18n="email.label.getmail"></span></label>
        <select type="text" id="node-input-fetch" style="width:130px;">
            <option value="auto" data-i18n="email.label.auto"></option>
            <option value="trigger" data-i18n="email.label.trigger"></option>
        </select>
        <span id="node-repeatTime">
            <span style="margin-left:20px;" data-i18n="email.label.repeat"></span>
            <input type="text" id="node-input-repeat" style="width:80px"> <span data-i18n="email.label.seconds">seconds</span>
        </span>
    </div>
    <div class="form-row">
        <label for="node-input-protocol"><i class="fa fa-envelope"></i> <span data-i18n="email.label.protocol"></span></label>
        <select type="text" id="node-input-protocol">
            <option value="IMAP">IMAP</option>
            <option value="POP3">POP3</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-useSSL"><i class="fa fa-lock"></i> <span data-i18n="email.label.useSSL"></span></label>
        <input type="checkbox" id="node-input-useSSL" style="width: auto;">
    </div>
    <div class="form-row">
        <label for="node-input-server"><i class="fa fa-globe"></i> <span data-i18n="email.label.server"></span></label>
        <input type="text" id="node-input-server" placeholder="imap.gmail.com">
    </div>
    <div class="form-row">
        <label for="node-input-port"><i class="fa fa-random"></i> <span data-i18n="email.label.port"></span></label>
        <input type="text" id="node-input-port" placeholder="993">
    </div>
    <div class="form-row">
        <label for="node-input-userid"><i class="fa fa-user"></i> <span data-i18n="email.label.userid"></span></label>
        <input type="text" id="node-input-userid">
    </div>
    <div class="form-row">
        <label for="node-input-password"><i class="fa fa-lock"></i> <span data-i18n="email.label.password"></span></label>
        <input type="password" id="node-input-password">
    </div>
    <div class="form-row node-input-box">
        <label for="node-input-box"><i class="fa fa-inbox"></i> <span data-i18n="email.label.folder"></span></label>
        <input type="text" id="node-input-box">
    </div>
    <div class="form-row node-input-disposition">
            <label for="node-input-disposition"><i class="fa fa-trash"></i> <span data-i18n="email.label.disposition"></span></label>
        <select type="text" id="node-input-disposition">
            <option value="None" selected="selected" data-i18n="email.label.none"></option>
            <option value="Read" data-i18n="email.label.read"></option>
            <option value="Delete" data-i18n="email.label.delete"></option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-criteria"><i class="fa fa-search"></i> <span data-i18n="email.label.criteria"></span></label>
        <select type="text" id="node-input-criteria">
            <option value="ALL" data-i18n="email.label.all"></option>
            <option value="ANSWERED" data-i18n="email.label.answered"></option>
            <option value="FLAGGED" data-i18n="email.label.flagged"></option>
            <option value="SEEN" data-i18n="email.label.seen"></option>
            <option value="UNANSWERED" data-i18n="email.label.unanswered"></option>
            <option value="UNFLAGGED" data-i18n="email.label.unflagged"></option>
            <option value="UNSEEN" selected="selected" data-i18n="email.label.unseen"></option>
            <option value="_msg_" data-i18n="email.label.criteriaFromMsg"></option>
            <!--
            <option value="DELETED" data-i18n="email.label.delete"></option>
            <option value="DRAFT" data-i18n="email.label.none"></option>
            <option value="NEW" data-i18n="email.label.delete"></option>
            <option value="UNDELETED" data-i18n="email.label.read"></option>
            <option value="UNDRAFT" data-i18n="email.label.delete"></option>
            <option value="RECENT" data-i18n="email.label.read"></option>
            <option value="OLD" data-i18n="email.label.delete"></option>
            -->
        </select>
    </div>
    <br/>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name">
    </div>
    <script>
        var checkPorts = function() {
            var currentPort = $("#node-input-port").val();
            if (currentPort === "143" || currentPort === "993" || currentPort === "110" || currentPort == "995") {
                if ($("#node-input-useSSL").prop("checked") === true) {
                    $("#node-input-port").val($("#node-input-protocol").val() === "IMAP"?"993":"995");
                } else {
                    $("#node-input-port").val($("#node-input-protocol").val() === "IMAP"?"143":"110");
                }
            }
        };

        $("#node-input-useSSL").change(function(x, y) {
          // console.log("useSSL: x="+ JSON.stringify(x) + ", y=" + y);
          // console.log("Value: " + $("#node-input-useSSL").prop("checked"));
          checkPorts();
        });

        $("#node-input-protocol").change(function() {
            var protocol = $("#node-input-protocol").val();
            if (protocol === "IMAP") {
                $(".node-input-box").show();
                $(".node-input-disposition").show();
                $(".node-input-criteria").show();
            } else {
                $(".node-input-box").hide();
                $(".node-input-disposition").hide();
                $(".node-input-criteria").hide();
            }
            checkPorts();
        });
    </script>




<script type="text/javascript">
(function() {
    RED.nodes.registerType('e-mail in',{
        category: 'social-input',
        color:"#c7e9c0",
        defaults: {
            name: {value:""},
            protocol: {value: "IMAP", required:true}, // Which protocol to use to connect to the mail server ("IMAP" or "POP3")
            server: {value:"imap.gmail.com",required:true},
            useSSL: {value: true},
            port: {value:"993",required:true},
            box: {value:"INBOX"}, // For IMAP, The mailbox to process
            disposition: { value: "Read" }, // For IMAP, the disposition of the read email
	        criteria: {value: "UNSEEN"},
            repeat: {value:"300",required:true},
            fetch: {value:"auto"},
            inputs: {value:0}
        },
        credentials: {
            userid: {type:"text"},
            password: {type: "password"},
            global: { type:"boolean"}
        },
        inputs: 0,
        outputs: 1,
        icon: "envelope.png",
        paletteLabel: function() {
            return this._("email.email");
        },
        label: function() {
            return this.name||this._("email.email");
        },
        labelStyle: function() {
            return (this.name)?"node_label_italic":"";
        },
        oneditprepare: function() {
            var that = this;
            if (this.credentials.global) {
                $('#node-tip').show();
            } else {
                $('#node-tip').hide();
            }
            if (typeof this.box === 'undefined') {
                $("#node-input-box").val("INBOX");
                this.box = "INBOX";
            }
            if (typeof this.criteria === 'undefined') {
                $("#node-input-criteria").val("UNSEEN");
                this.criteria = "UNSEEN";
            }
            if ($("#node-input-fetch").val() === null) { $("#node-input-fetch").val("auto"); }
            $("#node-input-fetch").change(function() {
                if ($("#node-input-fetch").val() === "trigger") {
                    $('#node-repeatTime').hide();
                    that.inputs = 1;
                }
                else  {
                    $('#node-repeatTime').show();
                    that.inputs = 0;
                }
            });
        }
    });
})();
</script>
<script type="text/x-red" data-help-name="e-mail">
    <p>Sends the <code>msg.payload</code> as an email, with a subject of <code>msg.topic</code>.</p>
    <p>The default message recipient can be configured in the node, if it is left
    blank it should be set using the <code>msg.to</code> property of the incoming message. If left blank
 you can also specify any or all of: <code>msg.cc</code>, <code>msg.bcc</code>, <code>msg.replyTo</code>, <code>msg.inReplyTo</code>, <code>msg.references</code> properties.</p>
    <p>You may optionally set <code>msg.from</code> in the payload which will override the <code>userid</code>
    default value.</p>
    <p>The payload can be html format.</p>
    <p>If the payload is a binary buffer then it will be converted to an attachment.
    The filename should be set using <code>msg.filename</code>. Optionally <code>msg.description</code> can be added for the body text.</p>
    <p>Alternatively you may provide <code>msg.attachments</code> which should contain an array of one or
    more attachments in <a href="https://www.npmjs.com/package/nodemailer#attachments" target="_new">nodemailer</a> format.</p>
    <p>If required by your recipient you may also pass in a <code>msg.envelope</code> object, typically containing extra from and to properties.</p>
    <p>If you have own signed certificates, Nodemailer can complain about that and refuse sending the message. In this case you can try switching off TLS.</p>
    <p>Note: uses SMTP with SSL to port 465.</p>
</script><script type="text/x-red" data-help-name="e-mail in">
    <p>Repeatedly gets emails from an IMAP server and forwards on as a msg if not already seen.</p>
    <p>The subject is loaded into <code>msg.topic</code> and <code>msg.payload</code> is the plain text body.
       If there is text/html then that is returned in <code>msg.html</code>. <code>msg.from</code> and <code>msg.date</code> are also set if you need them.</p>
    <p>Additionally <code>msg.header</code> contains the complete header object including
    <i>to</i>, <i>cc</i> and other potentially useful properties.</p>
    <p>It can optionally mark the message as Read (default), Delete it, or leave unmarked (None).</p>
    <p>Uses the imap module.</p>
    <p><b>Note:</b> this node <i>only</i> gets the most recent single email from the inbox, so set the repeat (polling) time appropriately.</p>
    <p>Note: uses IMAP with SSL to port 993.</p>
    <p>Any attachments supplied in the incoming email can be found in the <code>msg.attachments</code> property. This will be an array of objects where
    each object represents a specific attachments.  The format of the object is:</p>

<pre>
{
  contentType:        // The MIME content description
  fileName:           // A suggested file name associated with this attachment
  transferEncoding:   // How was the original email attachment encodded?
  contentDisposition: // Unknown
  generatedFileName:  // A suggested file name associated with this attachment
  contentId:          // A unique generated ID for this attachment
  checksum:           // A checksum against the data
  length:             // Size of data in bytes
  content:            // The actual content of the data contained in a Node.js Buffer object
                      // We can turn this into a base64 data string with content.toString('base64')
}
</pre>
<p>For POP3, the default port numbers are 110 for plain TCP and 995 for SSL.  For IMAP the port numbers are 143 for plain TCP and 993 for SSL.</p>
<p>The maximum refresh interval is 2147483 seconds (24.8 days).</p>

</script>
</div><div><!-- --- [red-module:node-red-node-feedparser/feedparse] --- -->

<script type="text/x-red" data-template-name="feedparse">
    <div class="form-row">
        <label for="node-input-url"><i class="fa fa-globe"></i> <span data-i18n="feedparse.label.feedurl"></span></label>
        <input type="text" id="node-input-url">
    </div>
    <div class="form-row">
        <label for="node-input-interval"><i class="fa fa-repeat"></i> <span data-i18n="feedparse.label.refresh"></span></label>
        <input type="text" id="node-input-interval" style="width:60px"> <span data-i18n="feedparse.label.minutes"></span>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('feedparse',{
        category: 'advanced-input',
        color:"#C0DEED",
        defaults: {
            name: {value:""},
            url: {value:"", required:true},
            interval: { value:15, required:true, validate:function(v) {return (!isNaN(parseInt(v)) && (parseInt(v) <= 35790))} }
        },
        inputs:0,
        outputs:1,
        icon: "feed.png",
        paletteLabel: function() {
            return this._("feedparse.feedparse");
        },
        label: function() {
            return this.name||this.url||this._("feedparse.feedparse");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        }
    });
</script>
<script type="text/x-red" data-help-name="feedparse">
    <p>Monitors an RSS/atom feed for new entries.</p>
    <p>The <code>msg.topic</code> contains the original article link. The <code>msg.payload</code>
    contains the description, and <code>msg.article</code> contains the complete article object,
    which has properties such as <code>.title</code>, <code>.summary</code>, <code>.date</code> and so on.</p>
    <p>The Refresh interval cannot be greater than 35790 minutes (approx 24.8 days).
</script>
</div><div><!-- --- [red-module:node-red-node-msgpack/msgpack] --- -->

<script type="text/x-red" data-template-name="msgpack">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('msgpack',{
        category: 'function',
        color:"#DEBD5C",
        defaults: {
            name: {value:""}
        },
        inputs:1,
        outputs:1,
        icon: "parser-msgpack.png",
        label: function() {
            return this.name||"msgpack";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        }
    });
</script>
<script type="text/x-red" data-help-name="msgpack">
    <p>A function that converts the <code>msg.payload</code> to and from <a href = "https://github.com/msgpack/msgpack-node"><i>msgpack</i></a> format.</p>
    <p>If the input is NOT a buffer it tries to convert it to a msgpack buffer.</p>
    <p>If the input is a msgpack buffer it tries to decode it back.</p>
    <p><b>Note</b>: this node does not currently encode raw <code>buffer</code> types.</p>
</script>
</div><div><!-- --- [red-module:node-red-node-random/random] --- -->

<script type="text/x-red" data-template-name="random">
    <div class="form-row">
        <label for="node-input-property"><i class="fa fa-ellipsis-h"></i> <span data-i18n="node-red:common.label.property"></span></label>
        <input type="text" id="node-input-property" style="width:70%;"/>
    </div>
    <div class="form-row">
        <label for="node-input-inte"><i class="fa fa-random"></i> Generate</label>
        <select type="text" id="node-input-inte" style="width:70%;">
            <option value="true">a whole number - integer</option>
            <option value="false">a real number - floating point</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-low"><i class="fa fa-arrow-down"></i> From</label>
        <input type="text" id="node-input-low" placeholder="lowest number" style="width:70%;">
    </div>
    <div class="form-row">
        <label for="node-input-high"><i class="fa fa-arrow-up"></i> To</label>
        <input type="text" id="node-input-high" placeholder="highest number" style="width:70%;">
    </div>
    <br/>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name" style="width:70%;">
    </div>
</script>


<script type="text/javascript">
    RED.nodes.registerType('random',{
        category: 'function',
        color:"#E2D96E",
        defaults: {
            name: {value:""},
            low: {value:"1"},
            high: {value:"10"},
            inte: {value:"true"},
            property: {value:"payload",required:true}
        },
        inputs:1,
        outputs:1,
        icon: "debug.png",
        label: function() {
            return this.name||"random";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (this.property === undefined) {
                $("#node-input-property").val("payload");
            }
            $("#node-input-property").typedInput({default:'msg',types:['msg']});
        }
    });
</script>
<script type="text/x-red" data-help-name="random">
    <p>Generates a random number between a low and high value.</p>
    <p>If you return an integer it can <i>include</i> both the low and high values.
    <code>min <= n <= max</code></p>
    <p>If you return a floating point value it will be from the low value, up to, but
    not including the high value. <code>min <= n < max</code></p>
</script>
</div><div><!-- --- [red-module:node-red-node-rbe/rbe] --- -->

<script type="text/x-red" data-template-name="rbe">
    <div class="form-row">
        <label for="node-input-func"><i class="fa fa-wrench"></i> <span data-i18n="rbe.label.func"></span></label>
        <select type="text" id="node-input-func" style="width:70%;">
            <option value="rbe" data-i18n="rbe.opts.rbe"></option>
            <option value="rbei" data-i18n="rbe.opts.rbei"></option>
            <option value="deadbandEq" data-i18n="rbe.opts.deadbandEq"></option>
            <option value="deadband" data-i18n="rbe.opts.deadband"></option>
            <option value="narrowbandEq" data-i18n="rbe.opts.narrowbandEq"></option>
            <option value="narrowband" data-i18n="rbe.opts.narrowband"></option>
        </select>
    </div>
    <div class="form-row" id="node-bandgap">
        <label for="node-input-gap">&nbsp;</label>
        <input type="text" id="node-input-gap" data-i18n="[placeholder]rbe.placeholder.bandgap" style="width:95px;">
        <select type="text" id="node-input-inout" style="width:54%;">
            <option value="out" data-i18n="rbe.opts.out"></option>
            <option value="in" data-i18n="rbe.opts.in"></option>
        </select>
    </div>
    <div class="form-row" id="node-startvalue">
        <label for="node-input-start"><i class="fa fa-thumb-tack"></i> <span data-i18n="rbe.label.start"></span></label>
        <input type="text" id="node-input-start" data-i18n="[placeholder]rbe.placeholder.start" style="width:70%;">
    </div>
    <div class="form-row">
        <label for="node-input-property"><i class="fa fa-ellipsis-h"></i> <span data-i18n="node-red:common.label.property"></span></label>
        <input type="text" id="node-input-property" style="width:70%;"/>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="rbe.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]rbe.label.name" style="width:70%;">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType("rbe", {
        color:"#E2D96E",
        category: 'function',
        defaults: {
            name: {value:""},
            func: {value:"rbe"},
            gap: {value:"",validate:RED.validators.regex(/^(\d*[.]*\d*|)(%|)$/)},
            start: {value:""},
            inout: {value:"out"},
            property: {value:"payload",required:true}
        },
        inputs:1,
        outputs:1,
        icon: "rbe.png",
        label: function() {
            var ll = (this.func||"").replace("Eq","").replace("rbei","rbe")||this._("rbe.rbe");
            return this.name||ll||this._("rbe.rbe");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (this.property === undefined) {
                $("#node-input-property").val("payload");
            }
            $("#node-input-property").typedInput({default:'msg',types:['msg']});
            //$( "#node-input-gap" ).spinner({min:0});
            if ($("#node-input-inout").val() === null) {
                $("#node-input-inout").val("out");
            }
            $("#node-input-func").on("change",function() {
                if (($("#node-input-func").val() === "rbe")||($("#node-input-func").val() === "rbei")) {
                    $("#node-bandgap").hide();
                } else {
                    $("#node-bandgap").show();
                }
                if ($("#node-input-func").val() === "narrowband") {
                    $("#node-startvalue").show();
                } else {
                    $("#node-startvalue").hide();
                }
            });
        }
    });
</script>
<script type="text/x-red" data-help-name="rbe">
    <p>Report by Exception node - only passes on data if the payload has changed.</p>
    <p>It can also block until the value changes by a specified amount - deadband modes.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload
            <span class="property-type">number | string | (object)</span>
        </dt>
        <dd>RBE mode will accept numbers, strings, and simple objects. Other modes must provide a parseable number.</dd>
        <dt class="optional">topic <span class="property-type">string</span>
        </dt>
        <dd>if specified the function will work on a per topic basis.</dd>
        <dt class="optional">reset<span class="property-type">any</span></dt>
        <dd>if set clears the stored value for the specified msg.topic, or
        all topics if msg.topic is not specified.</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload
            <span class="property-type">as per input</span>
        </dt>
        <dd>If triggered the output will be the same as the input.</dd>
    </dl>
    <h3>Details</h3>
    <p>In RBE mode this node will block until the <code>msg.payload</code> is
    different to the previous one. </p>
    <p>In Deadband modes the incoming payload must contain a parseable number and is
    output only if greater than + or - the band gap away from a previous value.</p>
    <p>Deadband also supports % - only sends if the input differs by more than x% of the original value.</p>
    <p>In Narrowband mode the incoming payload is blocked if it is more than + or - the band gap
    away from the previous value. Useful for ignoring outliers from a faulty sensor for example.</p>
    <p>Both Deadband and Narrowband allow comparison against either the previous valid output value, thus
    ignoring any values out of range; or the previous input value, which resets the set point, thus allowing
    gradual drift (deadband), or a step change (narrowband).</p>
    <p><b>Note:</b> This works on a per <code>msg.topic</code> basis. This means that a single rbe node can
    handle multiple different topics at the same time.</p>
</script>
</div><div><!-- --- [red-module:node-red-node-sentiment/sentiment] --- -->
<script type="text/x-red" data-template-name="sentiment">
    <div class="form-row">
        <label for="node-input-property"><i class="fa fa-ellipsis-h"></i> <span data-i18n="node-red:common.label.property"></span></label>
        <input type="text" id="node-input-property" style="width:70%;"/>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('sentiment',{
        category: 'analysis-function',
        color:"#E6E0F8",
        defaults: {
            name: {value:""},
            property: {value:"payload",required:true}
        },
        inputs:1,
        outputs:1,
        icon: "arrow-in.png",
        label: function() {
            return this.name||"sentiment";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (this.property === undefined) {
                $("#node-input-property").val("payload");
            }
            $("#node-input-property").typedInput({default:'msg',types:['msg']});
        }
    });
</script>
<script type="text/x-red" data-help-name="sentiment">
    <p>Analyses the chosen property, default <code>payload</code>, and adds a <code>sentiment</code> object.</p>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>sentiment <span class="property-type">object</span></dt>
        <dd>contains the resulting AFINN-111 sentiment.</dd>
        <dt>sentiment.score <span class="property-type">number</span></dt>
        <dd>the sentiment score.</dd>
    </dl>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>overrides <span class="property-type">object</span></dt>
        <dd>an object of word score overrides can be supplied - <code>{ word:score,... }</code>.</dd>
    </dl>
    <h3>Details</h3>
    <p>A score greater than zero is positive and less than zero is negative.</p>
    <p>The score typically ranges from -5 to +5, but can go higher and lower.</p>
    <p>See <a href="https://github.com/thisandagain/sentiment/blob/master/README.md" target="_blank">the Sentiment docs here.</a>.</p>
    <p><b>Note</b>: There is also a multi-language version available - <b>node-red-node-multilang-sentiment</b></p>
</script>
</div><div><!-- --- [red-module:node-red-node-suncalc/suncalc] --- -->

<script type="text/x-red" data-template-name="sunrise">
  <div class="form-row">
    <label for="node-input-lat"><i class="fa fa-globe"></i> Latitude</label>
    <input type="text" id="node-input-lat" placeholder="51.025">
  </div>
  <div class="form-row">
    <label for="node-input-lon"><i class="fa fa-globe"></i> Longitude</label>
    <input type="text" id="node-input-lon" placeholder="-1.4">
  </div>
  <div class="form-row">
    <label for="node-input-start"><i class="fa fa-clock-o"></i> Start</label>
    <select id="node-input-start" style='width:70%'>
      <option value="sunrise">Sunrise</option>
      <option value="sunriseEnd">Sunrise end</option>
      <option value="dawn">Dawn, morning civil twilight starts</option>
      <option value="goldenHourEnd">End of morning golden hour</option>
      <option value="nauticalDawn">Morning nautical twilight starts</option>
      <option value="nightEnd">Morning astronomical twilight starts</option>
    </select>
  </div>
  <div class="form-row">
    <label for="node-input-end"><i class="fa fa-clock-o"></i> End</label>
    <select id="node-input-end" style='width:70%'>
      <option value="sunset">Sunset, civil twilight starts</option>
      <option value="sunsetStart">Sunset start</option>
      <option value="goldenHour">Start of evening golden hour</option>
      <option value="dusk">Dusk, Evening astronomical twilight starts</option>
      <option value="nauticalDusk">Evening nautical twilight starts</option>
      <option value="night">Dark enough for astronomy</option>
    </select>
  </div>
  <div class="form-row">
    <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
    <input type="text" id="node-input-name" placeholder="Name">
  </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('sunrise',{
        category: 'advanced-input',
        color:"#ffcc66",
        defaults: {
            name: {value:""},
            lat: {value:"", required:true, validate:RED.validators.number()},
            lon: {value:"", required:true, validate:RED.validators.number()},
            start: {value:"sunrise", required:true},
            end: {value:"sunset", required:true}
        },
        inputs:0,
        outputs:2,
        outputLabels: ["once per minute","only on change"],
        icon: "sun.png",
        label: function() {
            return this.name||"Sun rise/set";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (($("#node-input-lat").val() === "") && ($("#node-input-lon").val() === "")) {
                if ("geolocation" in navigator) {
                    navigator.geolocation.getCurrentPosition(function(position) {
                        $("#node-input-lat").val(Number(position.coords.latitude.toFixed(5)));
                        $("#node-input-lon").val(Number(position.coords.longitude.toFixed(5)));
                    });
                }
            }
        }
    });
</script>
<script type="text/x-red" data-help-name="sunrise">
    <p>Uses the suncalc module to generate an output at sunrise and sunset based on a specified location.</p>
    <p>Several choices of definition of sunrise and sunset are available, see the <i><a href = "https://github.com/mourner/suncalc" target="_new">suncalc</a></i> module for details.</p>
    <p>The first output emits a <code>msg.payload</code> of <i>1</i> or <i>0</i> every minute depending if in between selected times or not.
    The second output emits only on the transition between night to day (<i>-> 1</i>) or day to night (<i>-> 0</i>).</p>
    <p>Also sets <code>msg.topic</code> to <i>sun</i> and <code>msg.moon</code> to the fraction of the moon between 0 and 1.</p>
</script>
</div><div><!-- --- [red-module:node-red-node-tail/tail] --- -->

<script type="text/x-red" data-template-name="tail">
    <div class="form-row">
         <label for="node-input-filename"><i class="fa fa-file"></i> <span data-i18n="tail.label.filename"></span></label>
         <input id="node-input-filename" type="text">
    </div>
    <div class="form-row">
        <label for="node-input-filetype"><i class="fa fa-file-text-o"></i> <span data-i18n="tail.label.type"></span></label>
        <select type="text" id="node-input-filetype">
            <option value="text" data-i18n="tail.action.text"></option>
            <option value="binary" data-i18n="tail.action.binary"></option>
        </select>
    </div>
    <div class="form-row" id="node-tail-split">
        <!-- <label>&nbsp;</label>
        <input type="checkbox" id="node-input-split" placeholder="Name" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-split" style="width: 70%;"><span data-i18n="tail.label.splitlines"></span></label> -->
        <label for="node-input-split"><i class="fa fa-tag"></i> <span data-i18n="tail.label.splitlines"></span></label>
        <input type="text" id="node-input-split" data-i18n="[placeholder]tail.label.regex">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="tail.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]tail.label.name">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('tail',{
        category: 'storage-input',
        defaults: {
            name: {value:""},
            filetype: {value:"text"},
            split: {value:"[\r]{0,1}\n"},
            filename: {value:"",required:true}
        },
        color:"BurlyWood",
        inputs:0,
        outputs:1,
        icon: "file.png",
        label: function() {
            return this.name||this.filename||this._("tail.tail");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            $("#node-input-filetype").on("change",function() {
                if (this.value === "text") { $("#node-tail-split").show(); }
                else { $("#node-tail-split").hide(); }
            });
        }
    });
</script>
<script type="text/x-red" data-help-name="tail">
    <p>Tails (watches for things to be added) to the configured file. (Linux/Mac ONLY)</p>
    <p>This will not work on Windows filesystems, as it relies on the <b>tail -F</b> command.</p>
    <h3>Outputs</h3>
    <ul>
        <li>Text (UTF-8) files will be returned as strings.</li>
        <li>Binary files will be returned as Buffer objects.</li>
    </ul>
</script>
</div><div><!-- --- [red-module:node-red-node-twitter/twitter] --- -->

<script type="text/x-red" data-template-name="twitter-credentials">
    <div class="form-row">
        <label for="node-config-input-screen_name"><i class="fa fa-twitter"></i> <span data-i18n="twitter.label.twitter-id"></span></label>
        <i class="fa fa-at"></i> <input type="text" id="node-config-input-screen_name">
    </div>
    <div class="form-row">
        <p style="margin-top: 30px;"><b>1.</b> <span data-i18n="twitter.label.create"></span> <a href="https://developer.twitter.com/en/apps" target="_blank" style="text-decoration:underline;">developer.twitter.com/en/apps</a></p>
    </div>
    <div class="form-row">
        <p style="margin-top: 30px;"><b>2.</b> <span data-i18n="twitter.label.copy-consumer"></span></p>
    </div>
    <div class="form-row">
        <label style="margin-left: 20px;" for="node-config-input-consumer_key"><span data-i18n="twitter.label.consumer_key"></span></label>
        <input type="password" id="node-config-input-consumer_key">
    </div>
    <div class="form-row">
        <label style="margin-left: 20px;" for="node-config-input-consumer_secret"><span data-i18n="twitter.label.consumer_secret"></span></label>
        <input type="password" id="node-config-input-consumer_secret">
    </div>

    <div class="form-row">
        <p style="margin-top: 30px;"><b>3.</b> <span data-i18n="twitter.label.copy-accessToken"></span></p>
    </div>
    <div class="form-row">
        <label style="margin-left: 20px;" for="node-config-input-access_token"><span data-i18n="twitter.label.access_key"></span></label>
        <input type="password" id="node-config-input-access_token">
    </div>
    <div class="form-row">
        <label style="margin-left: 20px;" for="node-config-input-access_token_secret"><span data-i18n="twitter.label.access_secret"></span></label>
        <input type="password" id="node-config-input-access_token_secret">
    </div>
</script>




<script type="text/javascript">
(function() {
    var twitterConfigNodeId = null;
    var twitterConfigNodeIntervalId = null;

    RED.nodes.registerType('twitter-credentials',{
        category: 'config',
        defaults: {
            screen_name: {value:""}
        },
        credentials: {
            consumer_key: { type: "password"},
            consumer_secret: { type: "password" },
            access_token: {type: "password"},
            access_token_secret: {type:"password"}
        },
        label: function() {
            if (this.screen_name) {
                return (this.screen_name[0]!=="@"?"@":"")+this.screen_name
            } else {
                return "Twitter: "+this.id
            }
        },
        exportable: false,
        oneditsave: function() {
            var trimFields = [
                "consumer_key",
                "consumer_secret",
                "access_token",
                "access_token_secret"
            ];
            // Just in case any whitespace has crept in with the copy-paste of the fields
            trimFields.forEach(function(field) {
                var v = $("#node-config-input-"+field).val();
                v = v.trim();
                $("#node-config-input-"+field).val(v);

            });
        }
    });
})();
</script>

<script type="text/x-red" data-template-name="twitter in">
    <div class="form-row">
        <label for="node-input-twitter"><i class="fa fa-user"></i> <span data-i18n="twitter.label.twitter-id"></span></label>
        <input type="text" id="node-input-twitter">
    </div>
    <div class="form-row">
        <label for="node-input-user"><i class="fa fa-search"></i> <span data-i18n="twitter.label.search"></span></label>
        <select type="text" id="node-input-user" style="display: inline-block; vertical-align: middle; width:60%;">
            <option value="false" data-i18n="twitter.search.public"></option>
            <option value="true" data-i18n="twitter.search.follow"></option>
            <option value="user" data-i18n="twitter.search.user"></option>
            <option value="dm" data-i18n="twitter.search.direct"></option>
        </select>
    </div>
    <div class="form-row" id="node-input-tags-row">
        <label for="node-input-tags"><i class="fa fa-tags"></i> <span id="node-input-tags-label" data-i18n="twitter.label.for"></span></label>
        <input type="text" id="node-input-tags" data-i18n="[placeholder]twitter.placeholder.for">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name">
    </div>
    <div class="form-tips"><span data-i18n="[html]twitter.tip"></span></div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('twitter in',{
        category: 'social-input',
        color:"#C0DEED",
        defaults: {
            twitter: {type:"twitter-credentials",required:true},
            tags: {value:""},
            user: {value:"false",required:true},
            name: {value:""},
            inputs: {value:0}
        },
        inputs: 0,
        outputs: 1,
        icon: "twitter.png",
        label: function() {
            if (this.name) {
                return this.name;
            }
            var uname = RED.nodes.node(this.twitter);
            if (this.user == "dm") {
                return (uname?uname.label()+" ":"")+this._("twitter.label.dmslabel");
            } else if (this.user == "event") {
                var user = RED.nodes.node(this.twitter);
                return (user?user.label()+" ":"")+this._("twitter.label.eventslabel");
            } else if (this.user == "user") {
                return this.tags+" "+this._("twitter.label.tweetslabel");
            }
            else if (this.user == "true") {
                return this._("twitter.label.followers") + (uname?(" "+uname.label()):"");
            }
            return "twitter";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var userlabel = this._("twitter.label.user");
            var userph = this._("twitter.placeholder.user");
            var forlabel = this._("twitter.label.for");
            var forph = this._("twitter.placeholder.for");
            $("#node-input-user").change(function() {
                var type = $("#node-input-user option:selected").val();
                if (type == "user") {
                    $("#node-input-tags-row").show();
                    $("#node-input-tags-label").html(userlabel);
                    $("#node-input-tags").attr("placeholder",userph);
                } else if ((type == "dm")||(type == "true")||(type == "event")) {
                    $("#node-input-tags-row").hide();
                } else {
                    $("#node-input-tags-row").show();
                    $("#node-input-tags-label").html(forlabel);
                    $("#node-input-tags").attr("placeholder",forph);
                }
            });
            $("#node-input-user").change();
        },
        oneditsave: function() {
            if ($('#node-input-tags').val() === '' && $("#node-input-user option:selected").val() === 'false') {
                this.inputs = 1;
            }
            else {
                //set back the default state of 0 inputs
                //this.inputs = 0;
            }
        }
    });
</script>


<script type="text/x-red" data-template-name="twitter out">
    <div class="form-row">
        <label for="node-input-twitter"><i class="fa fa-user"></i> <span data-i18n="twitter.label.twitter-id"></span></label>
        <input type="text" id="node-input-twitter">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('twitter out',{
        category: 'social-output',
        color:"#C0DEED",
        defaults: {
            twitter: {type:"twitter-credentials",required:true},
            name: {value:"Tweet"}
        },
        inputs:1,
        outputs:0,
        icon: "twitter.png",
        align: "right",
        label: function() {
            return this.name;
        }
    });
</script>
<script type="text/x-red" data-help-name="twitter-credentials">
    <p>Authentication for the Twitter API</p>
    <p>Earlier versions of this node provided one-click authentication. Twitter removed the ability
       to do that in June 2018. You must now register your own application with
       <a href="https://developer.twitter.com/">Twitter</a> and generate your own access tokens.</p>

</script><script type="text/x-red" data-help-name="twitter in">
    <p>Twitter input node. Can be used to search either:
    <ul><li>the public stream for tweets containing the configured search term</li>
        <li>tweets from accounts that the authenticated user follows</li>
        <li>tweets by specified users</li>
        <li>direct messages received by the authenticated user</li>
    </ul></p>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">string</span></dt>
        <dd>the text of the tweet</dd>
        <dt>topic <span class="property-type">string</span></dt>
        <dd>set to <code>tweets/<i>screen_name</i></code></dd>
        <dt>tweet <span class="property-type">object</span></dt>
        <dd>the full tweet object returned by the Twitter API</dd>
        <dt>location <span class="property-type">object</span></dt>
        <dd>location information associated with the tweet, if known</dd>
    </dl>
    <h3>Details</h3>
    <p>When searching for multiple terms, use a space for <i>and</i> and comma `,` for <i>or</i>.</p>
    <p>The full tweet object is documented <a href="https://developer.twitter.com/en/docs/tweets/data-dictionary/overview/tweet-object" target="_new">here</a>.</p>
    <p><b>Note:</b> this node is subject to the rate limiting restrictions of the Twitter
      API. It polls the API once a minute for updates. If you deploy frequently you may
      exceed the limit. The node will automatically delay polling until the end of the current
      rate limiting window.</p>
</script><script type="text/x-red" data-help-name="twitter out">
    <p>Send tweets and direct messages.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">string</span></dt>
        <dd>Sent as the body of the tweet. See below for how to send a Direct Message</dd>
        <dt class="optional">media <span class="property-type">buffer</span></dt>
        <dd>A Buffer of an image to attach to the tweet</dd>
        <dt class="optional">params <span class="property-type">object</span></dt>
        <dd>Additional parameters to pass to the Twitter status update API.</dd>
    </dl>
    <h3>Details</h3>
    <p>This nodes sends a tweet for the authenticated user. If <code>msg.media</code>
    is set and contains a Buffer, it is attached as an image.</p>
    <p>To send a Direct Message, the payload should be formatted as: <code>D {username} {message}</code>.</p>
    <p>Note that you cannot attach an image to a direct message.</p>
    <p>If <code>msg.params</code> exists and is an object of name:value pairs, they
       will be included in the request to the Twitter api. The available values are documented
       <a href="https://developer.twitter.com/en/docs/tweets/post-and-engage/api-reference/post-statuses-update#parameters" target="_new">here</a>.</p>
</script></div><div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-front ui-dialog-buttons ui-draggable ui-resizable" tabindex="-1" role="dialog" aria-describedby="node-dialog-library-lookup" aria-labelledby="ui-id-3" style="position: absolute; height: auto; width: 800px; top: 145px; left: 319px; display: none;"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span id="ui-id-3" class="ui-dialog-title">function类型库</span><button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only ui-dialog-titlebar-close" role="button" aria-disabled="false" title="close"><span class="ui-button-icon-primary ui-icon ui-icon-closethick"></span><span class="ui-button-text">close</span></button></div><div id="node-dialog-library-lookup" class="hide ui-dialog-content ui-widget-content" style="display: block; width: auto; min-height: 0px; max-height: none; height: 302px;"><form class="form-horizontal"><div class="form-row"><ul id="node-dialog-library-breadcrumbs" class="breadcrumb"><li class="active"><a href="http://xu7.co:8003/#" data-i18n="[append]library.breadcrumb">库</a></li></ul></div><div class="form-row"><div style="vertical-align: top; display: inline-block; height: 100%; width: 30%; padding-right: 20px;"><div id="node-select-library" style="border: 1px solid #999; width: 100%; height: 100%; overflow:scroll;"><ul></ul></div></div><div style="vertical-align: top; display: inline-block;width: 65%; height: 100%;"><div style="height: 372px; width: 95%;" class="node-text-editor ace_editor ace_hidpi ace-tomorrow" id="node-select-library-text"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" readonly="" style="opacity: 0; font-size: 1px;"></textarea><div class="ace_gutter" aria-hidden="true"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="height: 1e+06px;"></div></div><div class="ace_scroller"><div class="ace_content"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 4px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="height: 1e+06px; margin: 0px 4px;"></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors" style="opacity: 0;"><div class="ace_cursor"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px;"><div class="ace_scrollbar-inner" style="width: 20px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px;"><div class="ace_scrollbar-inner" style="height: 20px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div></div></div></form></div><div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-s" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-w" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-sw" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-ne" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-nw" style="z-index: 90;"></div><div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"><div class="ui-dialog-buttonset"><button type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">取消</span></button><button type="button" class="primary ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">读取</span></button></div></div></div><div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-front ui-dialog-buttons ui-draggable ui-resizable" tabindex="-1" role="dialog" aria-describedby="node-dialog-library-save-confirm" aria-labelledby="ui-id-4" style="position: absolute; height: auto; width: 530px; top: 255px; left: 454px; display: none;"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span id="ui-id-4" class="ui-dialog-title">保存到库...</span><button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only ui-dialog-titlebar-close" role="button" aria-disabled="false" title="close"><span class="ui-button-icon-primary ui-icon ui-icon-closethick"></span><span class="ui-button-text">close</span></button></div><div id="node-dialog-library-save-confirm" class="hide ui-dialog-content ui-widget-content" style="display: block; width: auto; min-height: 0px; max-height: none; height: 82px;"><form class="form-horizontal"><div style="text-align: center; padding-top: 30px;" id="node-dialog-library-save-content"></div></form></div><div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-s" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-w" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-sw" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-ne" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-nw" style="z-index: 90;"></div><div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"><div class="ui-dialog-buttonset"><button type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">取消</span></button><button type="button" class="primary ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">保存</span></button></div></div></div><div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-front ui-dialog-buttons ui-draggable ui-resizable" tabindex="-1" role="dialog" aria-describedby="node-dialog-library-save" aria-labelledby="ui-id-5" style="position: absolute; height: auto; width: 530px; top: 255px; left: 454px; display: none;"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span id="ui-id-5" class="ui-dialog-title">保存到库...</span><button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only ui-dialog-titlebar-close" role="button" aria-disabled="false" title="close"><span class="ui-button-icon-primary ui-icon ui-icon-closethick"></span><span class="ui-button-text">close</span></button></div><div id="node-dialog-library-save" class="hide ui-dialog-content ui-widget-content" style="display: block; width: auto; min-height: 0px; max-height: none; height: 82px;"><form class="form-horizontal"><div class="form-row"><label for="node-dialog-library-save-folder" data-i18n="[append]library.folder"><i class="fa fa-folder-open"></i> 文件夹</label><input type="text" id="node-dialog-library-save-folder" data-i18n="[placeholder]library.folderPlaceholder" placeholder="a/b"></div><div class="form-row"><label for="node-dialog-library-save-filename" data-i18n="[append]library.filename"><i class="fa fa-file"></i> 文件名</label><input type="text" id="node-dialog-library-save-filename" data-i18n="[placeholder]library.filenamePlaceholder" placeholder="文件"></div></form></div><div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-s" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-w" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-sw" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-ne" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-nw" style="z-index: 90;"></div><div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"><div class="ui-dialog-buttonset"><button type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">取消</span></button><button type="button" class="primary ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">保存</span></button></div></div></div></body></html>